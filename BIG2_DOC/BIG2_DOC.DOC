067010101010000134002002002002000
11
21
F0110000001
9[..........................................................]0010
€
`-DOCUMENTATION,CONCEPTETUTILISATION
`-DELALIBRAIRIEDEFONCTIONSBIG.
`-"BIGISGEM"version2.09du26/05/97

`!PourquoiBIG?

VousconnaissezlesprogrammesGNU?GNUsignifie"GnuisNotUnix",avec
r‚f‚rencer‚cursive.Demˆme,MINT,lesystŠmemultitƒche…l'originedu
multiTOSduFalconsignifie"MintIsNotTos".

Etbien,BIGsignifie"BigIsGem"!Cesroutinessontgaranties100%pur
GEM(aucund‚tournementdel'AESn'esteffectu‚),cequiassureune
compatibilit‚avectouteslesmachinesdelagammeettoutesles
r‚solutions(ycomprisleTTetleFalcon,leursr‚solutionsetle
Multitƒche).Ellessontlefruitdeplusieursann‚esdeprogrammation(et
d'utilisation)duGEM,etgrƒce…l'exp‚rienceaccumul‚e,jepensequ'elles
r‚pondentparfaitementauxbesoinsd'und‚veloppeurd‚sireuxdecr‚erdes
logicielsesth‚tiques(‡acompte)etd'utilisationsimple.
Lalibrairieestplac‚edansleDomainePublic.Vouspouvezdonc(etmˆme
jevousenremercied'avance)ladistribuerlibrementautourdevous,la
placerent‚l‚chargementsurunserveurouuneBBS,lafaireconnaŒtrepar
catalogue,etc,…conditionquelepackcompletsoitpropos‚,c'est-…-dire
aumoinslesfichierssuivants:

`$Lalibrairie :
 BIG2.H        Le fichier header … inclure aux d‚veloppements
 BIG2.LIB      Librairie BIG2 Pure C sans infos de debuggage
 BIG2DEBG.LIB  Librairie BIG2 Pure C avec infos de debuggage
`$Lad‚mo :
 BIG2DEMO.C       Le source de la d‚mo
 BIG2DEMO.H       Le fichier header du ressource de la d‚mo
 BIG2DEMO.HRD     Le fichier des noms d'objets du ressource
 BIG2DEMO.PRG     La d‚mo elle-mˆme
 BIG2DEMO.PRJ     Le projet Pure C de la d‚mo
 BIG2DEMO.RH      L'en-tˆte du ressource
 BIG2DEMO.RSC     Le ressource
 BIG2DEMO.RSH     Le ressource au format source C
 BIG2DEMO.PI3     Une image Degas
 BIGMODIF.TXT     Les derniŠres modifs, les derniŠres versions
`$Ladoc :
 BIG2_DOC.PRG     Le petit PRG / ACC pour lire la doc confortablement
 BIG2_DOC.DCM     Le fichier doc utilis‚e par le programme ci-dessus
 MAKE_DCM.TTP     Le programme pour compresser le fichier d'aide
 UMAK_DCM.TTP     Le programme pour d‚compresser le fichier d'aide

Acesfichiers,vouspouvezajouter‚ventuellement :
`$Lalibrairied'images :
 BIG_IMGS.LIB     La librairie de chargement d'images
 BIG_IMGS.H       Le fichier header pour le chargement d'images
 BIG_IMGS.TXT     La doc de la librairie d'images

L'utilisationdeBIGdansdeslogicielsdestin‚saucommerceestlibre.

!************************
`!Quefontcesroutines?

Ellespermettentdeg‚rerlesutilisationslespluscourantesdel'AESen
quelquesappelsdefonctions,quel'applicationtravailleavecunressource
externeouint‚gr‚,enprogrammeouenaccessoiredebureau.Elles
permettent‚galementder‚aliseraveclamˆmefacilit‚desformes
d'interfacesapparuesseulement…partirdesversions4.00et4.10de
l'AES,richeseninnovations,oudesformesnonpr‚vuesparleGEM(comme
€lesfenˆtres,quiont‚t‚entiŠrementsredessin‚es),cecimˆmesurles
ancienssystŠmes.Certainsbugset"manques"regrettablesdel'AESsont
corrig‚s.Onpeutr‚partircesfonctionsendeuxgroupes:cellesqui
travaillentsurlesformulairesetlesmenus,etcellesquitravaillentsur
lesfenˆtres.MaislafrontiŠreentrecesdeuxgroupesestflouepuisqu'il
estpossibledeplacerdesformulairesoudesmenusdanslesfenˆtres!

!************************
`!Letravailsurlesformulairesetlesmenus

BIGoffrelapossibilit‚ded‚finirdesobjetsd'unlooknouveau(maisqui
tend…ser‚pandre),desformulairesd‚pla‡ablessurl'‚cranouplac‚sdans
desfenˆtres,unegestiondeboutonspop-upoupop-listeetdeboutons
d'aideenligne,desmenushi‚rarchiques,desmenuspop-uplibrementplac‚s
surl'‚cran,etc.Lesraccourcisclavierdanslesmenusetlesformulaires
sontg‚r‚sautomatiquementparBIG.Lagestionducurseurdansleschamps
‚ditablesestagr‚ment‚ed'‚quivalentsclavieretilestpossibledecr‚er
deschampscapablesdecontenirplusdetextequelalargeurduchample
permet(letexted‚file).Ilest‚galementpossibledecr‚erdeschamps
‚ditablesenpetitscaractŠres,queleGEMnegŠrepascorrectement.Les
boŒtesd'alertepeuventˆtred‚plac‚escommelesformulaires.Deplus,il
estpossibledelierdesobjetsoudesoptionsdemenus…desfonctions,de
tellesortequ'ilsuffitdelescliquerpourappelerlafonction
correspondante.Nousentronspresquedansledomainedelaprogrammation
objet!BIGpeuttravailleraussibienavecunfichierRSCclassique
qu'avecunressourceint‚gr‚.Nousverronscommentlorsquenoustraiterons
desappelsdesfonctions.

!************************
`!Letravailsurlesfenˆtres

LesfenˆtresdeBIGontunaspectl‚gŠrementdiff‚rentdecellesduGEM.
Pluspr‚cis‚ment,ellesont‚t‚redessin‚esafindeleurajouterde
nouveauxboutons,commeparexempledesboutonsderedimensionnement…
chaquecoin.Toutefois,ilestpossibledenedonner…cesfenˆtresqueles
attributsGEMclassiques.D'autrepart,leurlookg‚n‚ralressemble
fortement…celuiduGEM,desortequel'utilisateurn'estpas"perdu".

DansBIG,plusieursfonctionssontconsacr‚esauxfenˆtresafinde
simplifierleurprogrammation.Lapossibilit‚deplacerdesformulaires
dansdesfenˆtresestentiŠrementpriseencharge.Ilest‚galement
possibledeplacerdesmenusd‚roulantsdanslesfenˆtres(avecousans
menushi‚rarchiques),oudes"toolbars",quisontdespetitsformulaires
situ‚senhautdelafenˆtre.Lesfenˆtrescontenantdesimagessontg‚r‚es
parBIG.Encequiconcernelesfenˆtresdetexte(oud'autretypede
donn‚es),leprogrammeurauraseulement…‚crirelaroutined'affichage
(quid‚pendfortementdelanaturedesdonn‚esetdelamaniŠredontelles
sontstock‚esenm‚moire).BIGsechargedureste.Achaquefenˆtrepeut
correspondreunepalettedecouleur,quiseraactiv‚eautomatiquement…
chaquefoisquecettefenˆtreseraamen‚eaupremierplan.Enfin,ilest
possibleded‚finirpourchaquefenˆtrelaformequeprendralecurseurde
lasourisquandilentreradanslazonedetravail,etd'indiquersila
fenˆtrepeutˆtremanipul‚e…partird'‚quivalentsclavier.Cettequasi
automatisationdutravailsurlesfenˆtresestsansdouteundespointsles
plusattrayantsdeBIG,cettepartiedel'AES‚tantprobablementlaplus
ingrate…programmer.Deplus,ellesdisposentdepossiblit‚s‚tendues,
commedepouvoirˆtremanipul‚esenarriŠre-planouˆtresortieparla
gauchedel'‚cran.

!************************
`!Lesoutilsn‚cessaires

BIGa‚t‚cr‚‚avecPURECversion1.1(du20/03/93).Lessourcesont‚t‚
€r‚‚crisdemaniŠre…pouvoirˆtrecompil‚s‚galementsurLattice5.60sans
aucunemodification.Ilsserontfacilementadapt‚s…desversionsplus
anciennesdePureCouauTURBOC,maisilsn‚cessiterontsansdouteune
adaptationplusample…d'autrescompilateursC(certainessontd‚j…
r‚alis‚es,etjereste…votredispositionpourtouteaide).

Encequiconcerneles‚diteursderessources,ilestindispensabled'en
utiliserunquipermetted'‚diterlesob_types,ob_flagsetob_state
‚tendusdesobjets.Danscedomaine,ilyaK-Ressource(quicommence…se
fairevieux),etINTERFACE(ouINTERFACE2),quiestsansaucundoutele
meilleuractuellement.Ilya‚galementORCS,distribu‚enshareware.
Malheureusement,ilsouffredecertainesparticularit‚s(oubugs ?)danssa
fa‡ondesauverlesfichiersRSC,notammentencequiconcerneleschamps
‚ditables.LesroutinesdeBIG"rattrapent"cesfantaisies,maisilest
toutefoispr‚f‚rabled'utiliserun‚diteurquiproduitdesRSCsstandards.

!************************
`!Lesexplications

Pourpr‚senterlespossibilit‚sdeBIG,nousallonscommencerparfaireun
tourdupropri‚tairegrƒceauprogrammed'exempleBIGdemo,puisnous
entreronsdanslesd‚tailsdansl'ordresuivant:lesnouveauxtypes
d'objets,leconceptdegestiondesfenˆtresetenfinlesfonctionsdeBIG
avecleursyntaxe,leursparamŠtresetdesrecommandationspourleur
programmation.Danscettedocumentation,nousnepr‚senteronsqueles
"fonctionsprogrammeur",c'est-…-direcellesqueled‚veloppeurpeut(ou
doit)appeler.Lesautres,les"fonctionsinternes"…BIG,neserontpas
mentionn‚esici.

Danstoutescesexplications,jem'efforceraid'ˆtreleplusexplicatif
possible.Toutefois,jesupposeraiquevousavezunminimumde
connaissancesenmatiŠredeprogrammationenlangageCetencequi
concerneleGEM.Monbutn'estpasderemplacerlesouvragesrelatifs…ces
questions.Sidespointsrestentobscurs,jevousconseilledeconsulter
unedocumentationcorrespondantauproblŠme,oudemecontacter
personnellement.

!************************
`!L'aideBigDoc

BIG2_DOC.PRGestunpetitutilitaire(r‚alis‚sousBIG2,biens–r)qui
permetdeconsulterladocumentationdeBIG2dansunefenˆtre,chapitrepar
chapitre.

Ilpeutˆtrerenomm‚en"BIG2_DOC.ACC"pourˆtreutilis‚enaccessoirede
bureau.Lefichier"BIG2_DOC.DCM"doittoujoursl'accompagner(danslemˆme
chemind'accŠs),c'estletextedeladoc.

LestitresdumenudelafenˆtrepermettentdechoisirlethŠmesurlequel
ond‚siredesexplications.Lesdiff‚rentesoptionsservent…s‚lectionner
letexterecherch‚.

Lesoptions"Pr‚c‚dent"et"Suivant"permettentdepasserauparagraphe
justeavantouaprŠsleparagraphecourant,afindeliresimplementladoc
dansl'ordre.L'option"Petitefonte"permetd'activerlapolicede
caractŠresdepetitetaille.

"Imprime..."afficheunepetitformulairepourchoisirlenombredelignes
parpaged'impression.

L'option"Sauverconfig"sauvedansunfichierBIG2_DOC.PRFlatailledes
caractŠres,leparagraphecourant,lenombredelignesparpage
d'impressionainsiquelescoordonn‚esdelafenˆtre.
€
!************************
`!Lefichierd'aide

Vouspouvezsivouslesouhaitezaugmenterlefichierd'aideavecdesnotes
personnellesaumoyenden'importequel‚diteurdetexte.Maisvousne
pouvezpasajouterdeparagraphe.Voicicommentfaire.

Toutd'abord,ilfautcr‚erunfichiertexteenAscii(commelefichier
BIG2_DOC.TXTdontilseraquestionplusloin).Cefichierestconstruitde
lamaniŠresuivante :

Leschapitressonts‚par‚sparuneligne"!******************".Enfait,il
suffitquelalignecommenceparlecaractŠre'!',leresteestignor‚.Il
estrecomand‚delaisserunelignevide…lafindechaquechapitre.Le
toutdernierchapitreN'ESTPASsuivid'unelignedes‚paration.

Leslignesnedoiventpasavoirplusde 78caractŠresdelong,etchaque
chapitrenepeutavoirplusde32765caractŠres(cequiesttoutdemˆme
pasmal !).

Lesattributsdetexte(gras,italique,etc)sontindiqu‚sdelamaniŠre
suivante.LecaractŠre'\`'(apostropheinverse)signaleunchangementde
style.LecaractŠrequisuitimm‚diatementce'\`'repr‚senteleoules
attribut(s)…activerjusqu'auprochainchangementoujusqu'auboutdela
ligne.Ils'agitdumasquedebitdelafonctionVDI`$vst_effects()`
augment‚de32 !

Jem'explique.LavaleurducaractŠrequisuitle'\`'repr‚senteles
attributsdetexteunefoisqu'onluienlŠvelavaleur32.Lecode 32
correspondant…l'espace,onvoitquetouteslescombinaisonsd'attributs
sontaccessibles…partirdestouchesduclavier.Voiciunrappeldumasque
debitsutilis‚parlafonctionvst_effects(),aveclesvaleurs
corrspondantesend‚cimal :
`$  Bit 0(1) :`!Gras
`$  Bit 1(2) :`"Clair
`$  Bit 2(4) :Italique
`$  Bit 3(8) :`(Soulign‚
`$  Bit 4(16) :`0Contour

Parexemple,pouractiverlesattributsGrasetSoulign‚,dontlasomme
est 9,ilfauttaper'\`'suividucaractŠre')',dontlecodeAsciiest41,
c'est-…-dire32 + 9.Exemple :`)Grassoulign‚`.Leretour…lanormale
(aucunattribut)estactiv‚parlecaractŠre'\`'suivitdel'espace('').

PourfaireafficherlecaractŠre'\`'lui-mˆme,ilfautlefairepr‚c‚derdu
caractŠre'\'(backslash).

Le"sansattribut"estsyst‚matiquementremis…lafindechaqueligne.

UnefoisquecefichierAsciiestcr‚‚,ilfautletransmettreenparamŠtre
auprogrammeMAKE_DCM.TTP.Cetutilitairecompresseind‚pendammentchaque
chapitre(selonl'algorithmeLZW)etcr‚eunfichierdemˆmenom,avec
l'extension "DCM".Lefichieroriginalresteinchang‚.Leprogramme
BIG2_DOC.PRG(ouACC)cherchecommefichiertextelefichiernomm‚
"BIG2_DOC.DCM".

L'utilitaireUMAK_DCM.TTPs'utilisedelamˆmemaniŠre,maisr‚alise
l'op‚rationinverse :illitunfichierDCM,led‚compresse,restaureles
s‚parationsdechapitresetleresauveavecl'extensionTXT,entexte
Ascii.Ainsi,vouspourreztransformerlefichiercompress‚BIG2_DOC.DCMen
BIG2_DOC.TXT,ajouterdesnotespersonnelles,l'imprimer,etc.

€!************************
`!L'impression

L'option"Imprime"envoielechapitrecourant…l'imprimante.Afinque
cetteimpressionser‚alisecorrectement,ilestn‚cessairequ'undriver
d'imprimanteait‚t‚charg‚.Cesfichiers-driversontl'extension"IMP",le
programmechargepard‚fautlefichier"BIG2_DOC.IMP"(s'ilexiste).

Cesfichierssontconstitu‚suniquementdecaractŠresAsciietsontcon‡us
delamaniŠresuivante.
Leslignescommen‡antparlecaractŠre'*'sontignor‚es.Ilestpossible
deplacercecaractŠre'*'aumilieud'uneligne,auquelcasc'estlafin
delalignequiestignor‚e.

Touslescodessontindiqu‚senhexad‚cimal,s‚par‚sparunevirgule.

Les8premiŠreslignessontobligatoiresetrepr‚sententdansl'ordreles
commandessuivantes :
Ligne1:Commencepar'*',titredudriver,nomdel'imprimante.
Ligne2:Resetdel'imprimante.
Ligne3:Activation‚critureengras.
Ligne4:D‚sactivation‚critureengras.
Ligne5:Activation‚critureenitalique.
Ligne6:D‚sactivation‚critureenitalique.
Ligne7:Activation‚critureensoulign‚.
Ligne8:D‚sactivation‚critureensoulign‚.

Leslignessuivantesrepr‚sententlescaractŠres…remplacerparunes‚rie
decodes.Lepremiercodedelalignerepr‚sentelecaractŠre…remplacer.
Lescodessuivantsrepr‚sententlesvaleurs…envoy‚senremplacement,au
maximum10.

Parexemple,laligne`$"82, 1B, 52, 1, 7B, 1B, 52, 0"`signifiequele
caractŠredecodeAsciihexad‚cimal"82"(c'est-…-direle'‚')est…
remplacerparlas‚quence"1B,52,1,7B,52,0".

Lafindecettes‚riedecodeestsignal‚eparuneligneindiquant
simplementun'0'.

Lorsdel'impression,lesattributs"Clair"et"Contour"sontignor‚s.Un
sautdepageestsyst‚matiquementenvoy‚…lafindel'impression.

!************************
`!Historique

CommentBIGest-iln‚ ?Aud‚part,cen'‚taitquequelquesfonctionsdans
mesd‚veloppements.Peu…peu,ellesontgrandi,envolumeetenqualit‚.A
chaquenouveauprogramme,jelesrecopiaisetj'ajoutaisdesoptions,des
pointeurs,desautomatismes.Lorsquedescopainsm'ontdemand‚s'ils
pouvaientlesutiliser,jemesuisrenducomptequej'‚taisleseul…
pouvoirlefaire,carilyavaittoujoursunequantit‚depetitsd‚tails
propres…chaqueapplication,quidevaientˆtremodifi‚s…chaquefois.
Maisj'‚taisleseul…m'yretrouverdanscettejungle!

Alorsj'aiprismoncourage…deuxmainsetj'aitoutr‚‚critdemaniŠre
quecelapuisseˆtreutilis‚danstouteslessituations,danstoutesles
applications,avecunminimumdecontraintes,unminimumdevariables
globales,leplusdelogiquepossibleetunecompatibilit‚de100%avec
touteslesmachinesdelagamme,mˆmecellesqui‚taient…venir(Etla
premiŠreversionbetadeBIGquej'aitest‚surFalconafonctionn‚...
… 95 %).

End‚veloppantcesroutines,jemesuisprisaujeuetj'aicommenc‚…
€ajouterdesquantit‚sdechosesquejen'avaisjamaissong‚…inclure…mes
programmes:menushi‚rarchiquesetenfenˆtre,formedelasouris
variable,gestionautomatiquedelapalette,formulairesd‚pla‡ables,3D,
scroll-menus,pop-listes,etc.Jetenais…cr‚erquelquechosedecomplet,
reprenanttoutcequiexistaitd‚j…dansd'autreslibrairies,dansle
nouveauGEM,ettoutcequej'avaispuvoirdeplaisantdanscertaines
applications,enbannissanttoutefoistoutcequipourraitrendrela
communicationlogiciel-utilisateurcompliqu‚e.

Ilfallaitbienquejem'arrˆte,etlapremiŠreversion"publique"deBIGa
‚t‚distribu‚eenjuillet1993.Depuis,desdizainesd'utilisateursn'ont
cess‚demepousser…ajouterdenouvellesfonctionnalit‚s,ilsm'ontaid‚
…deguggeret…simplifier,etc.

Puisd'autresid‚esmesontvenues,commeparexemplelesfenˆtres
redessin‚esdelaversion 2quiont‚t‚longtemps"engestation"avantque
jenem'yattaque,fautedetemps.

BIGestperp‚tuellementencoursd'am‚lioration,d'ajoutsetdedebbugage.
Ilarrivequ'ilyait 2ou 3changements(mineurs,eng‚n‚ral)danslamˆme
semaine !Contactez-moipourˆtres–rd'avoirladerniŠreversion.

!************************
`!Salutlescopains

Jetiens…remercierlescopainsetquim'ontaid‚(ouquim'ontpouss‚)
dansled‚veloppementdeBIGparleursconseils,leurtravailet/ouleurs
nombreusesid‚es.Dansled‚sordre:

`$Pierre-LouisLamballais`,delasoci‚t‚PARXSoftWare,auteurdug‚nialTube
GEM,quim'aapprisbeaucoupdechoses…proposdelafa‡ondetravailler
sousGEM.LagestiondesfenˆtresdeBIG,entreautres,estfortementbas‚e
sursesexcellentesid‚es.
`$AlexandreLemaresquier`,dedelasoci‚t‚Brainstorm,quim'asignal‚
plusieurscapricesduGEMetm'afaitprofiterdesonexp‚rience.C'est
‚galementsursessuggestionsqueles‚ditables‚tendusexistent.
`$Jo‰lHouplon`,quim'alitt‚ralementharcel‚aumoindrebugetpourl'ajout
decertainesfonctions.
`$MarcAbramson`,quim'aaid‚dansledebuggageetafaitpasmalde
publicit‚…BIG.Ilafaitfaireauxversions1.80etsuivantesdeBIGun
grandpasenavantsurtoutencequiconcernelacompatibilit‚avectoutes
lesmachines.C'est‚galementluiquiaajout‚lesB_PICTsetlesbulles
d'aide...entreautres !
`$MathiasAgopian`,quiestl'auteurdesroutinesdebullesd'aide.
`$PatrickMerminod`,quianonseulementtrouv‚ungrandnombredebugset
impr‚cisions,maisquim'aenplusdonn‚lasolution…chaquefoispour
m'‚viterdechercher.
`$DavidRen‚`,quim'aaid‚…trouverlessolutionsdecertainsproblŠmeset
quim'apr‚t‚sonFalcondurantleslonguessemaineso—j'aiattendule
mien.
`$ThierryRodolofo`,quim'aaid‚…int‚grerlagestiondeSpeedoGDOS…la
d‚mo.
`$LionelBruleetPatrickPenos`,quiontr‚alis‚l'adaptationdeBIGafinque
lessourcessoientcompatibles…lafoisavecleLatticeCetavecle
Pure C.
Tousceuxquim'ontencourag‚…poursuivre:`$BrunoChristen,DidierB‚cu,
`$FelixMarciano,Jean-MarcGigan,Fr‚d‚ricAlo‚,Fr‚d‚ricCollet,Jean-Luc
`$Caradeau,EricCassegrain,PhilippeWettstein...
Ettousceuxquim'ontsugg‚r‚desam‚liorationsoudesoptionsquise
trouventd‚sormaisdansBIG:`$DenisCasanova,GillesBarges,Jean-Fran‡ois
`$Obert,AlainVigne`,j'enoubliesansdoute...

!************************
€`!Pourmecontacter

Vouspouvezmecontacterpourmedemanderdevousfaireparvenirles
sourcescompletsdesroutinesBIG.Jenevousdemandequedemefaire
parvenirunedisquetteetuneenveloppesuffisammentaffranchie.

Pr‚cisez-lemoisivoussouhaitezutilisezBIGavecunautrecompilateur
quelePureCouleLatticeC,jevousadresserailabonneversion(sielle
existe!).

Contactez-moiaussisivousavezdesquestions,sivousaveztrouv‚des
bugs,sivousavezdessuggestions…mefairepour‚tendrelespossibilit‚s
deBIG,sivousvoulezmef‚liciter(j'espŠre)etmˆmesivousvoulez
m'engueuler(pourquoipas).

Etsurtout,sivousmedemandezlessourcesetquevouslesam‚liorez,
faŒtes-m'enprofiter!

Danstouslescas,celamepermettradevousteniraucourantde
l'‚volutiondeBIG,etdevousfaireparvenirsivousled‚sirezdes
versionsplusr‚centes.

Voicimescoordonn‚es:
`(ClaudeATTARD
`(5,ruedelaPoste
`(64400OloronSainteMarie
`((France)

L'utilisationdeBIGdansdesd‚veloppementsdestin‚s…l'‚ditionest
libre.Toutefois,j'accepteraiavecgrandplaisirunpetitquelquechoseen
proportionavecleprixdeventedulogiciel.Celaparaitcorrect,non?

Underniermot :sivousn'aimezpasBIG(outoutautrelogiciel,
d'ailleurs),dŒtes"jen'aimepas"(vouspouvezmˆmeajouter"parce
que..."),maisnedŒtespas"c'estdelam...".D'abordparceque‡an'en
estpas,etensuiteparcequesionveuxvoirrespectersonpropretravail,
ilfautcommencerparrespecterceluidesautres.

Amid‚veloppeur,jetesouhaiteautantdeplaisir…utiliserBIGquej'en
aieu…led‚velopper.Cen'estpaspeudire!

!************************
`!Visiteguid‚e:BIGdemo

Jevousrecommandedelirecettepartiedeladocumentationensuivantsur
l'‚cranlesexplications.
Danscettevisiteguid‚e,lestouchesduclavierserontpr‚sent‚esentre
signes"inf‚rieur"et"sup‚rieur",comme<ceci>.Lestextesdesboutons,
options,formulaires,etc,serontpr‚sent‚sentreapostrophes,comme
'cela'.

LancezBIGdemo.Ceprogrammener‚aliseriendeparticulier.Ilestjuste
l…pourmontrerlespossibilit‚sdesfonctionsdeBIGetcommentellessont
utilis‚es.N'h‚sitezpas…‚tudiersonsourceattentivement,toutesles
fonctionsmajeuresdeBIGysontpr‚sentes.Lad‚motournedanstoutesles
r‚solutions,maisellen'estpasadapt‚eauxbassesr‚solutions.Lesic“nes
serontd‚form‚es,etcertaineschosesseront‚tranges,commeparexemplele
menuetcertainsformulairesquisonttroplarges(etquipourraient
entraŒnerdesplantages).J'aisimplementvoulumontrerqueBIGpermetde
d‚velopperdanstouteslesr‚solutions,sanscompliquerlad‚mo.

Unbureaus'affiche,avecdeuxtextesenpetitscaractŠres,gras,italique
etsoulign‚s,uneic“neetunmenudetroisoptions.Siunfichierd'image
€monochromenomm‚imp‚rativement"BIG2DEMO.IMG"(mˆmesivousˆtesdansune
r‚solutioncouleur)setrouvedanslemˆmechemind'accŠsqueleprogramme,
cetteimageestcharg‚eetaffich‚ecommeimagedefondsurlebureau !
L'ic“neetlaboŒtedestextespeuventˆtred‚plac‚es.L'ic“neest
s‚lectionn‚eparunclicsimple,etd‚s‚lectionn‚eparunclic"dansle
vide".

!************************
`!Lepremierformulaire

Cliquezl'option'Infos'dumenu'BIGdemo'.Unformulairesepr‚sente,
affichantlenum‚rodeversiondeBIG.Vouspouvezd‚placerceformulaire
surl'‚cranencliquantleboutonbarr‚ducoinsup‚rieurdroiteten
gardantleboutondelasourisenfonc‚.Lemodeded‚placementdece
formulaireestla"boŒtefant“me",c'est-…-direqueleformulairedisparaŒt
letempsdud‚placementpourlaisserlaplace…unrectangle…ses
dimensions.

Cliquezlebouton'CONTACT'oupressezlatouche<Help>.Unautre
formulairesesuperposeaupremier.Ilindiquemescoordonn‚essivous
d‚sirezmecontacterourecevoirlessourcescompletsdeBIG.Quittezce
secondformulaireencliquantn'importeo—…l'int‚rieurouenpressant
<Return>.

DeretoursurlaboŒted'informations,cliquezlebouton'MERCI'.Un
troisiŠmeformulaireapparaŒt,pr‚sentantunmotderemerciementaux
copainsquim'ontaid‚…r‚aliserBIGparleursconseils,leurtravail,
leurssuggestionsouleursencouragements.Commepr‚c‚demment,quittezce
formulaireencliquantn'importeo—…l'int‚rieurouenpressant<Return>.

Quittezaussileformulaired'infos.Pourappelercetteoption,vousauriez
‚galementpupresserlestouches<Control+B>,pourl'appelerparson
raccourciclavier.Si,…l'aided'un‚diteurderessource,vousremplacez
le'^B'del'optiondemenupar(parexemple)'^F',vousdevrezmaintenant
pressezlestouches<Control+F>pourappelercetteoption.Grƒce…BIG,
iln'estpasn‚cessairederecompilerleprogrammepourquelenouvel
‚quivalentclavierprenneeffet!

!************************
`!Unformulairepluscomplet

Passonsausecondmenu,not‚'Formulaires'.Cliquezl'option'Formulaire
libre'(oupressez<Alternate+Control+L>).Leformulairequise
pr‚senteestnettementplusfourniquelepremier.D‚placez-lesurl'‚cran.
Ilsed‚place"entempsr‚el",c'est-…-direquec'estleformulairecomplet
etplusseulementuneboŒtefant“mequisuitlesmouvementsdelasouris.
LetitredeceformulaireestunechaŒnegraphiqueaveclesattributsGras
etSoulign‚.L'ensembleaunaspect"3D",commesilesobjets‚taienten
relief(sivousdisposezd'aumoins16couleurs).

Sousletitrefigurentdeuxgroupesderadioboutonsnot‚s'Cadre1'et
'Cadre2'.Ilssepr‚sententsouslaformedepetitsboutonsrondsavecun
textesoit…droite,soit…gauche.UndescaractŠresdechaquetexteest
soulign‚(etrougesivousˆtesencouleur).Pressezlatouche<Alternate>
etcecaractŠre.Leboutonr‚agitcommesivousl'aviezcliqu‚.

Passonsauboutonombr‚not‚'Pop-Up'.Quandvouslecliquez,unmenupop-
upavecdeuxcolonnesd'optionss'ouvre,plac‚souslebouton(…moinsque
vousn'ayezd‚plac‚leformulairedetellesortequ'iln'yaitpasassezde
place…l'‚cran;danscecas,lepop-upestd‚cal‚).Lemenupop-up
s'utiliseexactementcommeunmenud‚roulant.Ilpeutcontenirplusieurs
colonnesd'options.Sivousˆtesencouleurs(aumoins16),lefonddes
optionspasseenjaunelorsquelasourisvientdessus.Choisissez-enune.
€Sontexteestcopi‚dansleboutond'appel.Re-cliquezcebouton:cette
fois,lepop-upestpositionn‚demaniŠre…cequelapositiondel'option
choisieetcelleduboutoncorrespondent(mˆmeremarque:s'iln'yapas
assezdeplace,lepop-upestd‚cal‚),etcetteoptionest"check‚e".
Passons…l'ic“ne.Unnouveaumenupop-ups'affiche,maiscelui-ciest
constitu‚d'ic“nes.Sivousenchoisissezune,sondessinestreport‚dans
lebouton.

Ilexistedeuxautresfa‡onsdechangerlas‚lectiond'unboutonpop-up.
FaŒtesun<Shift+clic>surlebouton,ouunclicsurlapetiteic“ne
"optionsuivante"(laflŠchecirculaire)(s'ils'agitdupop-updetextes).
L'optionsuivantl'actuelleests‚lectionn‚e(dumoins,lapremiŠre
active).Arriv‚"aubout",‡arecommencedepuisled‚but.Siletexte(ou
l'image)duboutonnecorrespond…aucunedesoptionsdupop-up,c'estla
premiŠrequiestchoisiedecettefa‡on.

Lesdeuxboutonss‚lectablessepr‚sententsouslaformed'unpetitcarr‚
avecletextedubouton…droiteou…gauche.Sileboutonests‚lectionn‚,
unecroixesttrac‚edanslecarr‚.L…aussi,uncaractŠreestsoulign‚(et
rouge),poursignalerlapr‚senced'unraccourciclavier.

Lebouton'Alerte'faitafficherunealertedetypeBIG,c'est-…-dire
qu'ellepeut‚galementˆtred‚plac‚e…l'‚cran.Toutefois,danscecas,
ellesed‚placesousformedeboŒtefant“me.Eneffet,led‚placementen
tempsr‚eln‚cessitedesauvertoutl'‚crandansunbuffer.Or,BIGne
comporte(pourlimiterl'occupationm‚moire)qu'unseulbufferdecetype
etilestd‚j…occup‚pourleformulaireprincipal.Donc,l'alerteest
d‚plac‚eenboŒtefant“me.Nousreviendronsend‚tailsurcela.L'interˆt
decebouton'Alerte'estqu'ilestli‚…lafonctionquiaffichel'alerte
parun"pointeursurfonction".Ilsuffitdelecliquerpourquecette
fonctionsoitex‚cut‚e,sansqu'ilsoitn‚cessaired'effectuertouteune
s‚riedetests!Ils'agitl…d'unconceptprochedelaprogrammationobjet
quiestundesatoutsdeBIG.Nousenreparlerons...

Lepremierdesdeuxchamps‚ditablescomporteunepetiteflŠchedechaque
cot‚.Tapezdutextedanscechamp,etcontinuez…taperenarrivantau
boutduchamp.Letexted‚file,vouspermettantdepoursuivrelasaisie!
Vouspouvezentrer50caractŠresdanscechamp.Enfait,BIGautorisela
cr‚ationd'‚ditables‚tendusayantjusqu'…255caractŠres.Sivous
continuez…taperenarrivant…lafin,lederniercaractŠreestremplac‚
parceluiquiesttap‚.Sivoussaisissezdutexteaumilieuduchamp,il
estsaisienmodeinsertion,…moinsquelataillemaximumdutextesoit
atteinte.Danscecas,lasaisiesefaitenmoderemplacement.

Encliquantn'importeo—danslechamp,lecurseurestpositionn‚…cet
endroit-l….Sioncliquetroploin…droite(aprŠsletexted‚j…saisi),il
estpositionn‚…lafin,etsioncliquetrop…gauche,aud‚but.Les
touchesflŠch‚esgaucheetdroiteutilis‚esseulesd‚placentlecurseur.
Arriv‚aubout,letexted‚file.Encollaborationaveclatouche<Control>,
lesflŠchesamŠnentlecurseuraud‚butdumotpr‚c‚dentousuivant(pasde
d‚filementdanscecas).Aveclatouche<Shift>,lecurseurestamen‚tout
…gaucheoutout…droiteduchamp‚ditable.Silecurseurestd‚j…surla
premiŠreouderniŠrepositionduchamp,letexteestd‚cal‚jusqu'au
premierouauderniercaractŠredutextecomplet.Enfin,encliquantsur
lespetitesflŠches,etenmaintenantleboutonenfonc‚,letexted‚file,
mˆmesilecurseur‚taitjusquel…surunautrechamp‚ditable.

Lesecondchamp‚ditableestplusclassique,maisilestencaractŠresde
petitetaille,queleGEMestincapabledeg‚rercorrectement.Cet‚ditable
offrelesmˆmesenrichissementsencequiconcerneled‚placementdu
curseur,saufbiens–rled‚filementdutexte,puisquecen'estpasun
champ"‚tendu".

€Lescombinaisons<Shift+FlŠchehaute>et<Clr>amŠnentlecurseursurle
premierchampduformulaire.Lescombinaisons<Shift+FlŠchebasse>et
<Shift+Clr>l'amŠnesurledernierchamp(dansl'ordredenum‚rotation
desobjetsdansleressource).
Lestouches<FlŠchebasse>et<Tab>amŠnentlecurseursurlechampsuivant
duformulaire.Lestouches<FlŠchehaute>et<Shift+Tab>l'amŠnesurle
champpr‚c‚dent(dansl'ordredenum‚rotationdesobjetsdansle
ressource).

Placezlecurseursurlesecondchamp‚ditable,tapezquelquescaractŠres,
etpressezlacombinaison<Control+C>.Amenezensuitelecurseursur
l'autre‚ditableetpressezlacombinaison<Control+V>.Letextedu
premierchampa‚t‚copi‚parlapremiŠreop‚ration,etcoll‚parla
seconde.Tapezuntexteassezlongdanscechamp‚ditable‚tendu(une
trentainedecaractŠresparexemple),copiez-lepar<Control+C>et
collez-ledansl'autrepar<Control+V>.Letexte‚tanttroplong,lafin
enesttronqu‚e.Ilyaunautreraccourciclavierquiconcerneles
‚ditables,c'est<Control+X>.Letexteest‚galementcopi‚pourpouvoir
ˆtrerecoll‚ailleurs,maisilesteffac‚duchampd'origine.Ils'agit
d'uneop‚rationde"Couper".DansunprogrammesousBIG,tousleschamps
‚ditablesdulogicielssontainsili‚sparlesop‚rationsdeCopier/
Couper/Coller,mˆmes'ilsnesontpasdanslemˆmeformulaire.

Lebouton'Confirme'estcommed'habitudeactiv‚parlestouches<Return>
ou<Enter>.Lebouton'Annule'estactiv‚parlatouche<Undo>,etle
bouton'Aide'parlatouche<Help>.Les‚quivalentsclavierdecestrois
boutonsfontpartiedesroutinesBIG.Ilsuffitdechangerlesattributsde
cesboutonsdansleressourcepourmodifierces‚quivalences.Lesdeux
premierscomportent‚galementun‚quivalentclavierparcaractŠresoulign‚
(etrouge),pourceuxquipr‚fŠrentcettem‚thode.

Lebouton'Aide'appelleuneautreboŒtequivientsesuperposer…la
premiŠredemaniŠre…ˆtrecentr‚e.Commedansleformulaired'information,
cetappelfaitpartiedelagestiondeBIG,ilest"automatis‚",sans
aucuneinterventionduprogrammeprincipal.

ChangezquelquesparamŠtresduformulaire,puisconfirmez.Rappelezle
formulaire.Vosmodificationsont‚t‚enregistr‚es.Changez-lesencore,
maiscettefois,annulez,puisrappelezencoreleformulaire.BIGa
restaur‚lesr‚glagespr‚c‚dents.Automatiquement(oupresque),BIGse
chargedelasauvegardeetdelarestaurationde"l'‚tat"d'unformulaire.

Essayez…pr‚sentdes‚lectionnerundesradio-boutonsouunbouton
s‚lectable(carr‚)eneffectuantundouble-clic.€amarche,etenplusle
boutonpard‚faut("Confirme",enl'occurence)estactiv‚.

DerniŠreexp‚riencesurceformulaire :toutengardantenfonc‚elatouche
<Control>,promenezlecurseurdelasourissurlesobjetsduformulaire.
Certainsafficheune"bulled'aide"(ainsinomm‚ecarellesressemblentaux
bullesdesbandesdessin‚es),comportantuncourttexteexplicatif.Ces
bullessontentiŠrement…lachargedeBIG.Ilsuffit,commenousle
verronsplusloin,demarquerl'objetdemaniŠreparticuliŠreetdeplacer
letextedansunechaŒnelibreduressource.Celapermetdeconfectionner
rapidementuneaideenlignesimplifi‚e.

!************************
`!UneboŒted'alerte

Cliquezl'option'BIGAlerte'.LaboŒted'alertequis'afficheest
d‚pla‡ableentempsr‚el(puisquecettefoislebufferdesauvegardede
l'‚cranestinoccup‚),commeleformulairedetout…l'heure.Mis…partce
d‚tailetdesic“nesdiff‚rentesetplusnombreusesqueleshabituelles,
ellefonctionnecommeunealerteGEM.
€
!************************
`!Unpremierformulaireenfenˆtre

Laissonsdecot‚l'option'Quitter'(lavisitenefaitquecommencer!)et
passonsaumenu'Fenˆtres'.LapremiŠreoption,'Petitformulaire'affiche
unformulairedansunefenˆtre.Cecipr‚senteunimmenseavantage:la
gestionduprogrammen'estpasbloqu‚e.Lesmenusfonctionnenttoujours,
parexemple.Faitesl'exp‚riencederappelerleformulaired'information.
Toutfonctionnenormalement...…und‚tailprŠs:pourappelerce
formulaire,vousavezd–lefaireparl'optiondemenu,carleraccourci
claviernefonctionneplus.Eneffet,cepetitformulaireenfenˆtre
comportedeschamps‚ditables.Danscecas,cequisepassesurleclavier
leurestadress‚.Ilyauneexception,commedanstouteslesrŠgles:les
‚quivalentsclavierdesboutonss‚lectablesavecuncaractŠresoulign‚
fonctionnentnormalement,ainsiquelesop‚rationsdeCopier/Couper/
Coller.Siceformulairecomportaitdesradios-boutonsavecraccourci
clavier,ilsfonctionneraient‚galement.Simplement,larecherchede
l'‚quivalentclaviernesefaitpasdanslemenulorsquenoussommesen
pr‚senced'unformulaireenfenˆtrecomportantun(ouplusieurs)champ(s)
‚ditable(s).

D'autrepart,cettefenˆtrepossŠdeunaspectl‚gŠrementdiff‚rentdecelui
auquelnoussommeshabitu‚.Notamment,unbouton‚trangesetrouveenhaut
…droitedelafenˆtre,ressemblant…desguillemetsfermants.Lorsque
plusieursfenˆtressontouvertesenmˆmetemps,ceboutonpermetdepasser
…uneautre,mˆmesicelle-cisetrouveentiŠrementsouslesautres,
innaccessible.Nousreviendronsunpeuplusloinend‚tailsurles
nouveauxboutonsdefenˆtre,int‚ressons-nouspourl'instantauformulaire
contenudanscelle-ci.

Deuxdesquatrechamps‚ditablesdeceformulairesontdeschamps‚tendus
quiautorisentlasaisiede30caractŠres,passeulementdes10quisont
apparents.CertainssontenpetitscaractŠres,d'autresengrands.
Leschamps‚ditablesdeceformulairecomportentdesfiltresdesaisie.Les
deuxpremiers('champ1'et'champ2')autorisentlasaisiedetousles
caractŠres.'Champ3'nepermetquedeschiffreset'champ4'seulementles
espaces,chiffresetcaractŠres(majusculesouminuscules).

Ceformulairepermetdechangerlatramedubureauetsacouleur.Ilest
munidedeuxboutonspop-upquipr‚sententcettefoisdesobjetsdetype
boŒte(etnondutexteoudesimagescommepr‚c‚demment).Choisissezune
trameetunecouleuretpressezlatouche<Return>oucliquezlebouton
'Applique'.Lebureauestmodifi‚etlafenˆtreresteouverte.Choisissez
uneautretrame(ouuneautrecouleur)etcliquezcettefoislebouton
'Confirme'.Lebureauestencoremodifi‚,maiscettefoislafenˆtreest
ferm‚e.

L'existencedesformulairesenfenˆtreimpliquel'apparitiondedeux
nouveauxboutons:'Applique'et'R.A.Z.'.Ilscorrespondentauxhabituels
'Confirme'et'Annule',maisnefermentpaslafenˆtre.Leformulairereste
pr‚sent.CelaestextrˆmementpratiquepourmodifierdesparamŠtressans
devoirrappeler…chaquefoisleformulairesionnetrouvepastoutde
suitelebonr‚glage.Lavisualisationdel'effetestimm‚diat,maisle
formulairedeparam‚tragerestedisponiblepouruneautremodification.Si
lafenˆtreestferm‚eparunclicdansleboutondefermeture(coin
sup‚rieurgauche),celacorrespondaubouton'Annule'.

Commepr‚c‚demment,BIGsechargeautomatiquementdelagestiondeces
boutons,enenregistrantetenrestaurantsin‚cessaire"l'‚tat"du
formulaire.

Lebouton'INFOS',quiappelleunformulaired'aideenligne,fonctionnede
€lamˆmemaniŠrequesessemblablesquenousavonsd‚j…rencontr‚.Des
bullesd'aidesont‚galementaffichables,enmaintenantlatouche<Control>
enfonc‚eetenpromenantlasourissurleformulaire.

!************************
`!UnefenˆtretrŠssp‚ciale

Passons…l'optionsuivante,'Grandformulaire'.Unnouveauformulaireen
fenˆtreestpr‚sent‚,maisilesttropgrandpourtenirsurl'‚cran(Nous
supposonsquevousn'utilisezpasdegrand‚cran,nidegrand‚cran
virtuel,commeBigScreenouScreenBlasterparexemple).Lafenˆtreestdonc
pourvued'ascenseurspourpouvoird‚placerlecontenu.Vouspouvez
‚galementlefaired‚filerenutilisantleclavier:lesquatretouches
fl‚ch‚essont‚quivalentes…unclicdanslaflŠchecorrespondantedela
fenˆtre,etles<Shift+flŠche>sont‚quivalentes…unclicdanslapartie
gris‚ecorrespondantedesascenseurs.Latouche<Esc>correspondaubouton
depleineouverture,etlacombinaison<Shift+Esc>auboutondefermeture
delafenˆtre.Cettepossibilit‚demanipulerlesfenˆtresauclavierfait
partiedesroutinesBIG,maisn'estpasobligatoirementaffect‚e…une
fenˆtre.Ilfautlepr‚ciser…lacr‚ationdelafenˆtre,afinquecette
gestionsefasse.Ilyaundernier‚quivalentclavierpourlesfenˆtres:
lacombinaison<Control+Tab>amŠneaupremierplanlafenˆtresuivante
(s'ilyenaune),qui‚taitjusqu'alorsenarriŠre-plan(essayez,sivous
n'avezpasreferm‚lafenˆtredupetitformulaire).Cettepossibilit‚est
toujoursactive,mˆmesilagestiondelafenˆtreparleclaviern'apas
‚t‚demand‚e,etmˆmesileformulaireenfenˆtrecomportedeschamps
‚ditables.

Lagestiondelafenˆtre(d‚placements,d‚filements,redimensionnement,
etc)estautomatiquementg‚r‚eparBIG.

Penchons-noussurlesparticularit‚sdecettefenˆtre.Ellecomporteun
boutonderedimensionnementdanschacundesesangles,etpasseulement
dansl'inf‚rieurdroitcommed'habitude.Essayez-les,vousverrez.Le
boutondefermeturesetrouvecommed'habitudeenhaut…gauche,l‚gŠrement
d‚plac‚.

Enhaut…droite,setrouvent4boutons.Leplus…gauchesert…ic“nifier
lafenˆtre,c'est-…-dire…la"d‚sactiver"provisoirementenluidonnant
unepetitetaille,sanspourautantlafermer.Nousenreparlerons.

Lesuivant,quenousavonsd‚j…rencontr‚,sert…changerdefenˆtre.
Cliquez-lesivousn'avezpasferm‚lafenˆtredupetitformulaire(ou
rouvrez-la).Un<control-clic>surlabarreded‚placementproduitlemˆme
effet.

LetroisiŠmesert…amenerlafenˆtre…sataillemaximale,eng‚n‚rale
celledel'‚cran,celleduformulairedanslecaspr‚sent.Lemˆmer‚sultat
peutˆtreobtenueneffectuantundouble-clicsurlabarreded‚placement.

Ledernierboutonestencoreun"Sizer",pourredimensionnerlafenˆtre.

Remarquezaupassagequelorsquelafenˆtreestredimensionn‚eoud‚plac‚e,
lasourischangedeforme.Cen'estcertespastrŠsutile,maisc'est
joli !

Enbasdelafenˆtre,dechaquec“t‚,setrouvedeuxautresSizers.Les
ascenseurs,verticalethorizontal,ontleursslidersaggr‚ment‚sd'une
petiteflŠchedouble,uniquementd‚corative.Lorsquevouslesd‚placez,la
sourischangeencoredeforme.

LemaniementdesfenˆtresBIGestsimilaire…celuidesfenˆtresGEM.Mais
ellespossŠdent(outrelesnouveauxboutons)desfonctionnalit‚s‚tendues.
€Ouvrezsimultan‚mentlesfenˆtresdupetitetdugrandformulaire,et
placezcelledupetitenpremierplan.Cliquezalorssurlabarrede
d‚placementdelafenˆtre"grandformulaire".Vouspouvezlad‚placezcomme
sielle‚taitdevant !Vouspouvez‚galementlaredimensionner,d‚placer
sessliders,cliquersesflŠchesouascenseurs,l'ic“nifier,etc.Tousles
boutonssontactifs,commesilafenˆtre‚taitenpremierplan.Lesdeux
seulesrestrictionsconcernentledouble-clicetlecontrol-clicsurla
barreded‚placement(respectivementpleineouverture /retouretcyclage
defenˆtre).Ilsnesontactifsquesurlafenˆtredepremierplan.

Pourd‚placerouredimensionnerunefenˆtre(qu'ellesoitaupremierplan
ounon),ilestpossiblecommed'habitudedemaintenirleboutondela
sourisenfonc‚etdelerelacherauxnouvellescoordonn‚es.Maisonpeut
aussieffectuerunclicnormalsurlabarreded‚placementouleSizer.La
boŒtefant“meapparaŒtalors,etunnouveauclic"pose"lafenˆtre…ses
nouvellescoordonn‚es.Chacun,selonsespr‚f‚rences,utiliseral'uneou
l'autrem‚thode.

Ilyatoutefoisunepetitediff‚rencedecomportementselonquel'onse
trouvedansunenvironnementmultitƒcheoumonotƒche.Enmultitƒche,pour
d‚placerouredimensionnerunefenˆtred'arriŠre-plan,ilfaut
obligatoirementutiliserlam‚thodedesdeuxclics :unpourcommencer
l'op‚ration,unautrepourlaterminer.Pourlafenˆtredepremierplan,on
alechoix.Nousreviendronssurlesraisonsdeceladanslechapitre
consacr‚autravailenenvironnementmulti-applications.

Pouramenereffectivementcettefenˆtreaupremierplan,vousdevrez
cliquerdanssazonedetravailoufaireun<Shift +Clic>surundes
‚l‚mentsdebordure.

Lorsquevousd‚placezouredimensionnezunefenˆtreBIG,une"marque
fant“me"sed‚placeenmˆmetempsquelasouris,montrantenpermanenceles
coordonn‚esmodifi‚es.Lerectangleleplusext‚rieurmontreles
coordonn‚estotalesdelafenˆtre.Lerectangleint‚rieur,quiestde
surcroitbarr‚,montrelescoordonn‚esdelazonedetravail.Ainsi,les
nouvellescoordonn‚esdelafenˆtrepeutˆtrechoisiesavecpr‚cision.

Enfin,lesfenˆtresBIGpeuventˆtresortiesdel'‚cran,nonseulementvers
lebasetladroitecommed'habitude,maisaussiparlagauche.

AprŠscerapidetourd'horizondesfenˆtres,surlesquellesnous
reviendronsdenombreusesfois,int‚ressons-nousaugrandformulaire...

!************************
`!Unautreformulaireenfenˆtre

Ceformulairenecomportepasdechamps‚ditables.Eneffet,puisquecette
fenˆtrepossŠdedesascenseursetunboutonderedimensionnement,lechamp
‚ditablepourraitsetrouver"endehors"delafenˆtre.Danscecas,le
curseurnedevraitpasˆtredessin‚,lasaisiedutextetemporairement
impossible,etc.Lagestionduformulaireenseraitconsid‚rablement
compliqu‚e,etlatailleduprogrammegrossiraitencons‚quence.

J'aidoncopt‚pouruncompromis :Ilestpossibledeplacerdeschamps
‚ditablesdansunformulaireenfenˆtre,maisBIGconsidŠrequ'ilest
`!toujours`danslapartievisible.End'autrestermes :Sivousplacezdes
‚ditablesdansunformulairedefenˆtre,cettefenˆtrenedoitpas
comporterd'ascenseursetnedoitpasˆtreredimensionnable.C'est
interdit !Encontre-partie,larecherchedes‚quivalentsclavier
s'effectueaussidanslemenu.Pressezlestouches<Control+B>,le
formulaired'informationsepr‚sente.

Leformulaired'exemplecomportetroisgroupesderadios-boutonsavecleurs
€raccourcisclavier,ainsiquedeuxboutonss‚lectables,‚galementavec
raccourcisclavier.Ilcomprend‚galementquatresboutonspop-up,trois
sousformedetexteetunsousformed'ic“nes.Certainspermettentde
changerlestextesetl'ic“nedubureau.Commedansle"Formulairelibre",
undouble-clicsurunradio-boutonouunboutons‚lectableactive‚galement
leboutonpard‚fautduformulaire.

Examinonsend‚taillecomportementdesdeuxplusgrands.Celuiquiest
not‚'Pop-Up1'faitappraŒtreunmenupop-upconstitu‚d'uneseulecolonne
d'option,maisellessonttropnombreusespourpouvoirtoutesˆtre
affich‚es.AutomatiquementBIGcr‚eun"scroll-menu".C'estunpop-upmuni
deflŠchesded‚filementenhautenenbas.DŠsquelecurseurdelasouris
estamen‚surunedecesflŠches,lesoptionssemettent…d‚filerdans
cettedirection,jusqu'aubout,sansqu'ilsoitn‚cessairedecliquer.

Lepop-upseplacesousleboutond'appels'ilyalaplacepourafficher
aumoinsquatreoptionsetlesdeuxflˆches.Sinon,ilpartduhautdu
bureau.L'optionquicorrespondautextedubouton(s'ilyenaune)est
"check‚e",etelleestaffich‚eenpremiŠrepositiondanslescroll-menu(…
moinsqu'ellesoitdanslesderniŠresdelaliste,danscecasellepeut
ˆtred‚cal‚e).

Lesecondboutonpop-upestnot‚'Pop-List".Cliquez-le.Lepop-upqui
apparaŒtalors(lemˆmequepr‚c‚demment,enfait !)comportehuitoptions
seulement,maisilestagr‚ment‚d'unascenceurcompletsitu‚…sadroite.
Cliquezsurunedesflˆcheshauteoubassepourd‚placerlecontenudumenu
d'uneoptiondanscettedirection.Sivouscliquezsurunepartiegris‚ede
l'ascenceur,led‚calageestdehuitoptions.Enfin,encliquantleslider
etengardantenfonc‚leboutondelasouris,vouspouvezfaired‚filerle
contenudumenuentempsr‚el.Commepr‚c‚demment,l'optioncorrespondant
autexteduboutonestcheck‚eetelleestplac‚eenpremiŠrepositionsi
possible.Lepop-listeestplac‚sousleboutond'appels'ilyaassezde
place,sinonau-dessus.Sileformulairepop-upassoci‚…cebouton
comportemoinsdeneufoptions,c'estunpop-up"normal"quiestaffich‚.

Pourlesbesoinsdelad‚mo,lesboutons'Pop-Up1'et'Pop-Up2'
permettentdechangerlestextesfigurantdanslaboŒtedubureau,etle
pop-upgraphiquepermetdechangerl'ic“ne.

Lebouton'INFOS'appelleunformulaired'aideenligne.Nousretrouvons
encorenosquatreboutons'Applique','Confirme','R.A.Z.'et'Annule',
ainsiquedesbullesd'aide,toujoursactiv‚esconjointement…latouche
<Control>.

Ilyaencoreunepossibilit‚pourmanipulerlesfenˆtresformulaire.
Ouvrezlesdeuxfenˆtresdupetitetdugrandformulaire,etcliquezsurun
objetduformulairedelafenˆtrequisetrouveenarriŠre-plan.La
r‚actionestlamˆmequesilafenˆtreavait‚t‚enpremierplan !Ala
demande,BIGpeutmanipulerlesformulaireenfenˆtrequ'ilssetrouve
"dessus"ou"dessous".Pourfairepassercettefenˆtredevantlesautres,
ilfautsoitcliquersurl'objet-racine(lefondduformulaire),soitfaire
un<Shift-Clic>n'importeo—dedans.Decefait,lapossibilit‚defaireun
<Shift-Clic>surunpop-uppouractiverl'optionsuivantenefonctionneque
surlafenˆtredepremierplan,sinonelleestactiv‚e.

!************************
`!Unmenuhi‚rarchique

Onappelle"menushi‚rarchiques"les"sous-menus"quipeuventapparaŒtre…
droiteou…gauchedumenunormallorsquelasourispassesurcertaines
optionsdecemenu.BIGpermetder‚alisercelademaniŠreautomatique,en
prenantenchargelagestiondecemenuhi‚rarchique,ainsiquedes
‚quivalentsclavierquipourraients'ytrouver.Sileformulaireservantde
€menuhi‚rarchiqueestplushautquelebureau,ilestautomatiquement
transform‚enscroll-menu(cen'estpaslecasdanslad‚mo).

Amenezlecurseurdelasourissurl'option'Fenˆtrenormale',quicomporte
unepetiteflŠche.CetteflŠcheestl…pourrappeler…l'utilisateurque
cetteoptionpossŠdeunmenuhi‚rarchique,etelleindiquedequelcot‚
(versladroiteoulagauche)lesous-menuvased‚rouler.AprŠsunpetit
d‚laid'environunedemiseconde,lemenuhi‚rarchiques'ouvre.Sivous
sortezdel'optionducot‚oppos‚ausous-menu,ousivousd‚placezle
curseurplus"haut"quelui,ildisparaŒt.

Lemenuhi‚rarchiquecomportetroisoptions'Texte...','Image...'et
'Histogramme'.Amenezlasourisdanslesous-menu.Ils'utilisecommele
menunormal.IldisparaŒtsivouscliquezuneoption,ousivouscliquezen
dehors,ousilecurseurdelasourispasse…uneautreoptiondumenu
principal,ou,commeila‚t‚dit,s'ilpasse"au-dessus"dusous-menu.
Ceciestn‚cessaireafind'‚viterqu'unautremenunesed‚roule"par
dessus"notremenuhi‚rarchique.Decefait,ILESTINTERDITdeplacerun
menuhi‚rarchiquecommepremiŠreoptiond'unm‚nud‚roulant(voirle
chapitre`$"Lesmenushi‚rarchiques"`pourlesd‚tails).Laroutinede
recherchedes‚quivalentsclavierdanslemenucherche‚galementdansles
sous-menusdemaniŠre…activerl'optioncorrespondantes'ilyena.

!************************
`!Lafenˆtredetexte

Cliquezl'option'Texte...'oupressez<Control+T>.Uns‚lecteurd'objet
apparaŒtafinquevouspuissiezchoisiruntexte…afficherdansla
fenˆtre.Ils'agitdu"s‚lecteurBIG2" !Pressezlatouche<Help>pour
savoircommentl'utiliser.Attention,lad‚mon'estenmesuredeg‚rer
qu'ununtexteenAsciiavecun'CR/LF'…lafindechaqueligne,etdont
leslignesontunelongueurmaximumde80caractŠres.N'essayezpasde
chargerautrechose,vouspourriezavoirdemauvaisessurprises,aucune
v‚rificationn'estfaŒte !

Lafenˆtrequis'ouvrepermetdevisualiserletexte.Ellecomportetous
lesattributsstandardd'unefenˆtreBIG(ascenseurs,Sizersmultiples,
etc),sauflabarred'information.Ellecomporteenplusune"Toolbar",qui
estunformulairedepetitetaillequiseplaceenhautdelafenˆtreet
peutservirdeboŒte…outils.Desbullesd'aidesontli‚es…certains
objetsdecettetoolbar.

RegardezlesflŠchesdecettefenˆtre.Ellessonttoutesgroup‚esenbas…
droite !CelaestoptionneldansBIG,maispermetd'am‚liorerl'ergonomie.
Eneffet,l'utilisateurn'aplus…d‚placercontinuellementlasouris…
traversl'‚cranpourcliquersurlesdiff‚rentesflŠches.Cettepossibilit‚
n'existepaspourlesfenˆtresformulaires(maiscelles-cisontrarement
muniesd'ascenseursetdeflŠchesdanslapratique).

Cettefenˆtre,commecelledugrandformulaire,peutˆtremanipul‚e…
partirduclavier.Maiscommeelleestdetype"normal"(pasformulaire,ni
image),ilyadeuxmanipulationssuppl‚mentaires :Latouche<Clr>amŠne
l'affichageaud‚butdutexte,<Shift +Clr>l'amŠne…lafin.Deplus,…
chaquefoisquelecurseurdelasourisentredanslazonedetravaildela
fenˆtre,ilprendlaformeducurseur-texte(lesparenthŠsesdos-…-dos),et
reprendlaformedeflŠchedŠsqu'ilensort.Cettecaract‚ristique,comme
lagestionparleclavier,estautomatis‚eparBIGetdoitˆtrer‚clam‚e…
lacr‚ationdelafenˆtre.Cen'estpasunefonctionvitale,maisc'est
agr‚ableencoursd'utilisationd'unlogiciel.

Touteslesfonctionsdebasedecettefenˆtresontprisesenchargepar
BIG !Laseulechosequiestlaiss‚e…lachargedud‚veloppeur,c'estla
routined'affichageelle-mˆme,quid‚pendfortementdelamaniŠredontle
€fichiertexteeststock‚enm‚moire,etdecequ'ilcontient.Laroutine
d'affichagedeBIG2DEMO.CesttrŠssimplifi‚e(etmˆmesimpliste !),mais
elleestsuffisantedanscettesituation.BIGs'occupedetoutlereste :
gestiondesredraws,d‚placementparpageouparligne,r‚affichage
lorsqu'unsliderestd‚plac‚,pleineouvertureettaillepr‚c‚dente,
redimensionnement,d‚placement,etc.TouslesmessagesduGEMsonttrait‚s
sansqueleprogrammeprincipal(c'est-…-direlapartie"horsBIG"quele
programmeurdoit‚crire)n'ait…s'enoccuper!Rienquepourcela,BIGest
ungrandpasenavant.

Latoolbarpermetd'agirsurl'affichagedutexte.Lestroisradio-boutons
'Gauche','Centre'et'Droite'permettentdejouersurlecalagedutexte
danslafenˆtre.Lebouton'Inverse'basculel'affichageentrenoirsur
blancetblancsurnoir.Lesraccourcisclavierdecesboutonssontactifs
commedansunformulaireordinaire.

Legrandboutonpop-uppermetdechoisirlapolicedecaractŠresivous
avezinstall‚SpeedoGDOSsurvotresystŠme(sinon,seulelafontesystŠme
estdisponible).Enfin,l'autrepop-uppermetdechoisirlatailledes
caractŠres(cequipeutavoirdeseffetsdisgracieuxaveclafonte
systŠme).LespolicesSpeedo‚tantproportionnellespourlaplupart,cela
peutdonnerdesr‚sultatsimparfaitsdanslesensdelalargeur,surtout
danslesgrossestailles,ainsiqu'avecled‚filementhorizontaldela
fenˆtre.Jen'aipasvoulucompliquerlad‚moenr‚alisantquelquechosede
parfait,maismontrercommentquelqueslignesdeprogrammepouvaientoffrir
grƒce…BIGdenombreusespossibilit‚s.

Reparquezquelesobjetsdelatoolbarpeuventˆtremanipul‚smˆmelorsque
lafenˆtreestenarriŠre-plan,commenousl'avionsfaitaveclesdeux
fenˆtresdeformulaires.

!************************
`!Lafenˆtred'image

Lasecondeoptiondumenuhi‚rarchiqueafficheunefenˆtrecontenantune
image.Les‚lecteurvousproposedechoisiruneimageDegasnoncompress‚e
(extension'PI?').Netentezpasdechargerunautretyped'image,niune
imageavecunnombredeplansdecouleursdiff‚rentdel'actuel,carla
d‚monev‚rifierien.

Parcontre,BIGgŠrelapalettedecouleurs.Lapalettedel'imagecharg‚e
devientlapaletteactive.DŠsquevouscliquezsuruneautrefenˆtre(mˆme
sielleappartient…unautreprogrammeouaccessoire),ouquevousfermez
celle-ci,lapalettepard‚fautredevientactive.

Cettefenˆtreest‚galementmanipulableauclavier.Lasourisprendla
formed'unemain…l'indextendudanslazonedetravail.Pourg‚rer
l'affichaged'uneimageavecBIG,vousn'aurezmˆmepasbesoin(commepour
letexte)d'‚crirelaroutined'affichage!Eneffet,lagestiondes
rasters(blocs-images)eststandardis‚edansleVDIparlebiaisdes
structuresMFDB("MemoryFormDefinitionBlock"enversionoriginale).
L'image,quelsquesoientsataille,sonformat,sar‚solution,etc,estde
toutemaniŠrestock‚edansunezonem‚moirequiluiestr‚serv‚eau
chargement.Ilsuffitd'indiquer…BIGl'adressedecettezonem‚moirepour
qu'ils'occupedureste!C'estpasbeau?

!************************
`!Unefenˆtregraphique

L'option'Histogramme'faitapparaŒtreunefenˆtreaffichanthuit
histogrammesdetaillesdiff‚rentes,calcul‚esal‚atoirement…chaqueappel
delafonction.EllepossŠde‚galementuneligned'informations,tousles
nouveauxtypesdeboutonsdefenˆtres,maispasd'ascenseurs,niflŠches,
€nisliders.

Siunefenˆtreestd‚j…ouverte,mais…l'arriŠre-planaumomento—onlui
demandedes'ouvrir,elleestamen‚eaupremierplanparBIG.

!************************
`!Unefenˆtreavecunmenud‚roulant

L'option'Fenˆtremenu'(ou<Shift+Control+M>)ouvreunefenˆtrequi
contientunmenud‚roulant!Cettepossibilit‚deplacerdesmenusdansles
fenˆtrespermetder‚aliserdeslogicielsd'uneutilisationtrŠs
ergonomique.Parexemple,dansunprogrammededessin,chaquefenˆtrepeut
conteniruneimage,etunmenupermettantdechoisirlesparamŠtresde
couleurs,l'outildetravail,etc,correspondant…cetteimage.Unetoolbar
pourrait‚galementˆtreutilis‚e,maislenombred'outilsrisqueraitd'en
augmenterlatailleaud‚trimentdelasurfacedetravail.

Uneautreutilisationint‚ressantedesmenusenfenˆtresontles
accessoiresdebureau.Unaccessoirenepeutplacerunebarredemenuen
hautdel'‚cran(ilyadesexceptions,jesais...),etc'estregrettable.
Maisilpeutouvrirunefenˆtre.Ilsuffitdeplacerunmenudanscette
fenˆtre,etletourestjou‚!

Naturellement,BIGs'occupedetout.Lemenuestli‚…lafenˆtreetla
suitdanssesd‚placements.Silafenˆtredevienttroppetitepourquel'on
puisseacc‚derauxmenuslesplus…droite,lesdeuxpetitesflŠchesde
gauchepermettentdelesd‚caler.Cliquezsurellespouressayer.Lesmenus
nesed‚roulentpasautomatiquement,dumoinspasdesuite.Cliquezsurun
destitres'BIGdemo','Options'ou'Alertes'.Cettefois,lemenu
correspondantsed‚roule,etl'ensembledelabarredemenufonctionne
commed'habitude.Vouspouvezpasser…l'autremenu,s‚lectionnerune
option,etc.Lemenuprincipalest"bloqu‚"pendantcetemps.Choisissez
uneoptionoucliquez…cot‚pourfermerlesmenus.Toutredevientnormal.
Lemenu'Alertes'offremˆmeunmenuhi‚rarchique!

BIGs'occupeaussides‚quivalentsclavier.Siunefenˆtre-menusetrouve
aupremierplan(fenˆtreactive),ilcherchedanssonmenusiuneoption
correspondauraccourciclavier.Ilvautmieuxqu'iln'yaitpasde
raccourcisclavieridentiquesdanslemenuprincipaletdansceluidela
fenˆtre,maissic'estlecas,lafenˆtreapriorit‚.DŠsqu'une
correspondanceesttrouv‚e,larecherches'interrompt.Larecherche
s'effectueaussidanslesmenushi‚rarchiquess'ilyena.

Lemenuestcr‚‚dansl'‚diteurderessourcecommeunmenunormal.Vous
pouvezenleverlesoptionsr‚serv‚espourlesaccessoiresdebureau,oules
utiliser.Eneffet,riennevousempˆchedeplacerdanslepremiermenu
autantd'optionsquevousled‚sirez,etdelesutilisernormalement.Ceci
est‚videmmentinterditdanslecasdumenuprincipal,puisque6
emplacementssontr‚serv‚sauxaccessoiresdebureau.Maisdanslecasd'un
menudestin‚…unefenˆtre,vouspouvezfairecequivouschante(cen'est
paslecasdanscetted‚mo).BIGsechargede"fenˆtriser"automatiquement
cemenu.

Continuonslavisiteparcemenudefenˆtre.L'option'Infos'estlamˆme
quecelledumenuprincipal.Elleaffichelemˆmeformulaire.L'option
'Alerte'afficheunealerteBIG,d‚pla‡able.Enoutre,l'optionest
alternativement"check‚e"et"d‚-check‚e"…chaquefoisqu'elleest
appel‚e.

L'option'Chargerimage'permetdechargeruneimageDegasnoncompress‚e
(mˆmesremarquesquetout…l'heure)etdel'afficherdanslafenˆtre(l…
aussi,lapalettedecouleursestg‚r‚e).FaŒtes-le.
FaŒtesl'exp‚riencedechargeruneimageavecunepalettedecouleursdans
€lafenˆtre"image",uneautreavecunepalettediff‚rentedanslafenˆtre
"menu",etouvrezuneautrefenˆtre,"texte"parexemple.Passezd'une
fenˆtre…l'autreenobservantlapalettecourante.

L…encore,BIGs'occupedetout :manipulationsdelafenˆtre…partirdu
clavier,formedelasourisdanslazonedetravail(unecroixfine),
ascenseurs,r‚affichage,palette,redimensionnementsentoussens,etc.Si
c'estdutexteetnonuneimagequiavait‚t‚plac‚danscettefenˆtre,
nousaurionsd–simplement‚crirelaroutined'affichage.

Enfin,l'option'Ic“nes'estmunied'unmenuhi‚rarchique.Contrairement…
leurshomologuesdumenuprincipal,ilspeuventˆtreplac‚s,danslecas
d'unmenudefenˆtre,enpremiŠreoptiond'unmenu.Silemenuhi‚rarchique
estplushautquelebureau,BIGletransformeautomatiquementen
scroll_menu.Cesous-menupermetd'afficheruneboŒted'alerte(toujoursla
mˆme),avecles9motifsd'ic“nesd'alertepropos‚sparBIG,plusle"sans
ic“ne".Onpeut‚galementlesafficherparlesraccourcisclavier.
Certainesdesesoptionstravaillentparpointeursurfonction,d'autres
non.Nousyreviendrons.

!************************
`!Unpop-uplibre

Nousn'avonspasfini.Cliquezavecleboutondroitdelasouris.Unmenu
pop-upapparaŒt,centr‚surlapositionduclic(oud‚cal‚sionestau
borddel'‚cran) !Cepop-uplibreestoptionnel.BIGgŠreleboutondroit
delasouris,vouslesignalelorsqu'ilestcliqu‚,etpeutenprimesi
vousled‚sirezg‚rerautomatiquementunmenupop-upcommecelui-ci.Dans
l'exemple,cemenupop-upreprendlesdiff‚rentesoptionsdumenu
principal.Uneseulerestriction:iln'estpaspossibledeplacerdes
menushi‚rarchiquesli‚s…desoptionsdemenupop-up.Parcontre,BIGle
transformeenscroll-menus'ilesttrophaut.

!************************
`!Gestiondutimer

Uneautreactionestr‚alis‚eparBIG,quin'estpasapparentedansla
d‚mo.Achaquefoisque"rien"nes'estpass‚,ni‚v‚nementclavier,ni
clic,nimanipulationdefenˆtre,etc,BIG"rendlamain"auprogramme
principal.Celaseproduitentempsnormalplusieursfoisparseconde.Il
estalorspossibled'enprofiterpourfairequelquechoseenpseudotƒche
defond,parexempled‚cr‚menteruncompteurpourunesauvegarde
automatique,surveillerlaprises‚rie,envoyerdutexte…l'imprimante,
etc.MaissousMultiTOS,ilfautˆtretrŠsprudentaveccegenrede
fonction...

!************************
`!Ic“nificationdefenˆtres

Ilestparfoisg‚nantquel'‚cransoitencombr‚defenˆtres,carcelanuit
auconfortdetravail.Enfermercertainesn'estpastoujourslabonne
solution,carleurr‚ouvertureprendparfoisuncertaintemps,parexemple
sileprogrammedoitenrechargerlecontenu…partird'unfichier.La
solutionlaplus‚l‚ganteetlapluscommodeest"l'ic“nificationde
fenˆtre".L'AESpr‚voitcettepossibilit‚depuissaversion4.10seulement.
Unnouveauboutondefenˆtrea‚t‚cr‚‚,le"SMALLER".Lorsqu'oncliquece
bouton,lafenˆtreestamen‚e…unetaillede72x72pixels,ettousses
autresattributssontprovisoirementannul‚s,saufletitreetlabarrede
d‚placement.Enoutre,letitreest‚critenpetitscaractŠres.

LesfenˆtresBIGpeuventaussiposs‚derunboutonSmaller(c'estlepremier
des4,enhaut…droitedesfenˆtres).Ilrepr‚senteunepetiteflŠche
triangulaireallantversunepetitefenˆtrecarr‚e.Cettepossibilit‚de
€BIGestactivesurtouteslesversionsdusystŠmed'exploitation.

Pour"d‚sic“nifier"lafenˆtre,ilfauteffectuerundouble-clicsurelle.
Unautremessageestalorsenvoy‚,etl'applicationpeutdemanderauGEMde
restaurerlafenˆtreavecsesanciennescoordonn‚esetsesanciens
attributs.

DerniŠrepossibilit‚:un<Control+clic>surleSMALLERentraŒneun
"ALL_ICONIFY".TOUTESlesfenˆtressontalorsic“nifi‚esenuneseule
ic“ne.L'op‚rationinverseestr‚alis‚eencasdedouble-clicsurcette
fenˆtreic“nifi‚e.

Danslecasd'uneic“nificationdetouteslesfenˆtres,BIGeffectueune
ic“nificationdelafenˆtrequia‚t‚"Controlcliqu‚e",etfermeles
autresfenˆtresdecetteapplicationquisontouvertes…cemoment.Si
l'utilisateurouvreensuited'autresfenˆtresetrefaitune"all
iconification",uneautre"allic“ne"estcr‚‚e.Lorsd'undouble-clicsur
unefenˆtreic“nifi‚e,la(oules)fenˆtre(s)est(sont)restaur‚e(s)comme
auparavent.

R‚alisezl'op‚rationsurlesfenˆtresdelad‚mo.Vousconstaterezqueles
fenˆtresic“nifi‚espeuventˆtredessin‚esavecuncontenudiff‚rent,qui
n'estactifquelorsquelafenˆtreestic“nifi‚e.Lad‚moafficheune
petiteimage,diff‚rentes'ils'agitd'unefenˆtreformulaireoud'unautre
type.Commecelaad‚j…‚t‚dit,ilestpossibleder‚aliser
l'ic“nificationd'unefenˆtresitu‚eenarriŠre-plan.

!************************
`!Bullesd'aide

Ouvrezoufaitespasseraupremierplanlafenˆtredugrandformulaire.
Toutenmaintenantenfonc‚elatouche<Control>,promenezlasourissurles
diff‚rentsobjetsduformulaire.Desbullessemblables…cellesdesbandes
dessin‚ess'affichent,pr‚sentantuntextedequelqueslignes…proposde
l'objetd‚sign‚parlasouris !

Onlesappelledes"bullesd'aide"…causedeleurformeetdeleur
fonction.D'autresbullessontpropos‚esdanslepetitformulaireen
fenˆtre,danslaToolBardelafenˆtreTexteetdansleformulairelibre.
Sympa,non ?Leuraffichageetleurgestionsontautomatis‚sgrƒce…BIG.

!************************
`!Findelavisite

Cliquezl'option'Quitter'.BIGsechargedefermerlesfenˆtresetde
lib‚rerlesdiff‚renteszonesm‚moirequ'ilavaitr‚serv‚,leressource,
etc.

Jetons…pr‚sentunpremiercoupd'oeilrapideausourceBIG2DEMO.C:il
est‚tonnamentcourtparrapport…lamassedefonctionsqu'offrele
programme.Certes,ceprogrammeestjusteuned‚mo,ilner‚aliseriende
concret,maisilpossŠdeuneinterfacetrŠscomplŠte(jamaisunvrai
programmenepossŠderatousces‚l‚ments…lafois),avecdenombreuses
chosesin‚ditesoupresque.

Nousavons(rapidement)faitletourdecequeBIGpeutfairepourle
programmeur:s'occuperd'unequantit‚dechosesquisontainsifaŒtesune
bonnefoispourtoutes.Dansunprogramme"sousBIG",unegrandepartiede
laprogrammationdel'interfacesetrouvedanslesroutinesBIG.Le
d‚veloppeurn'aplusqu'…traiterquelquespointsparticuliersoudescas
sp‚cifiques…sonapplication.Quant…lastructuredecetteinterface,
ellesetrouveengrandepartiedansleressourcelui-mˆme,commenous
allonslevoirtrŠsvite.
€
Cequinesevoitpasdanslad‚mo,c'estquegrƒceauxpointeurssur
fonction,latailledusource(etletempsdeprogrammation !)diminuedans
degrandesproportions,dufaitquecertainesfonctionssontdirectementet
automatiquementappel‚es.

FaŒtesencoredeuxexp‚riences:renommezlefichierBIG2DEMO.PRGen
BIG2DEMO.ACC,copiez-le(ainsiqueleRSC)surlapartitiondeboot,et
faŒtesunresetdusystŠme.Lad‚mofonctionned‚sormais(demaniŠre
simplifi‚e)enaccessoiredebureau!Seullebureauadisparu.Lemenu
principalestd‚sormaisplac‚dansunefenˆtre,maistoutlereste
fonctionnecommeauparavant:diff‚rentesfenˆtres,raccourcisclavier,
ic“nification,formulaires,etc.

DerniŠreexp‚rience,placezBIG2DEMO.PRGdansledossierAUTO,eteffectuez
…nouveauunreset.Durantleboot,unmessagevoussignalequece
programmenepeutˆtrelanc‚ainsi.Eneffet,iln'estpaspossible
d'ex‚cuterdecettemaniŠreunprogrammesousGEM,etlesapplications
r‚alis‚esavecBIGsontpard‚finitionsousGEM.Aulieudeplanter,comme
celasepassed'ordinaire,BIGvouspr‚vient.

!************************
`!Lesnouveauxtypesd'objets

Commen‡onsparregarderlesnouveauxtypesd'objetsimpl‚ment‚sparBIG.
Pourlesd‚finir,nousutilisonsleconceptdes`$"types‚tendus"`.De
quois'agit-il?Lestypesd'objetsd‚finisenstandardparleGEMvontdu
num‚ro20aunum‚ro33.Cetype(ob_type)‚tantcod‚surunmot(2octets),
ilrestepasmaldeplacedisponible.Pourd‚terminerletyped'unobjet,
l'AEStesteuniquementl'octetdefaiblepoids.Nouspouvonsdoncutiliser
l'autreoctet…notreguisepourystockerjusqu'…255valeursquenous
appelons"type‚tendu"(Enr‚alit‚,lesparticularit‚sdunouveauGEM4
r‚serventlesvaleursde128…255.Ilnousrestedonclesvaleurs1…127,
cequinoussuffitamplement).Cesobjetspeuventensuiteˆtredessin‚spar
leGEM.Ilsprendrontalorsl'aspectindiqu‚parletypenormal(l'octetde
faiblepoids).MaisdansBIG,certainsdecesobjets…type‚tendusont
transform‚senG_USERDEF,cequisignifiequ'ilsserontdessin‚sparune
routineduprogrammeetnonpasparuneroutineGEM.Bienentendu,ces
routinesdedessinsont‚galementint‚gr‚es…BIG.

BIGutiliseaussilesob_stateetlesob_flags‚tendus.Eneffet,
l'ob_stateetl'ob_flagsdesobjetsn'estpasentiŠrementutilis‚par
l'AES.Seulslesbits0…5deob_stateetlesbits0…11deob_flagssont
r‚serv‚s.L'AESnetestemˆmepaslesautresbitsentempsnormal.Nous
allonslesutiliserpourcertainsdenosparamŠtres.
Voicicesnouveauxtypesd'objetsetlesnomsutilis‚sdansBIG(delamˆme
fa‡onquetouslesnomsd'objetsGEMcommencentpar'G_',lesnomsd'objets
BIGcommencentpar'B_'):

`(B_COCHE`Boutoncoch‚.C'estunboutons‚lectablequiprendl'aspectd'un
petitcarr‚avecletextedubouton…gaucheou…droite.Lorsqu'ilest
s‚lectionn‚,lecarr‚estbarr‚dediagonales.UncaractŠredutextepeut
ˆtresoulign‚(enlefaisantpr‚c‚derde'['lorsdelacr‚ationdans
l'‚diteurderessources),afindepouvoiractiverleboutonparla
combinaison<Alternate+caractŠre>.R‚serv‚auxboutonssimplement
s‚lectables.

`(B_RADIO`Boutonrond.C'estunboutons‚lectablequiprendl'aspectd'un
petitcercleavecletextedubouton…gaucheou…droite.Lorsqu'ilest
s‚lectionn‚,lecerclecontientunpetitrondplein,sinoncecercle
int‚rieurestvide.UncaractŠredutextepeutˆtresoulign‚(enlefaisant
pr‚c‚derde'['lorsdelacr‚ationdansl'‚diteurderessources),afin
d'activerleboutonparlacombinaison<Alternate+caractŠre>.R‚serv‚aux
€radio-boutons.

`(B_EDIT`Champ‚ditable‚tendu,permettantlasaisiedeplusdecaractŠres
quelalargeurduchamp.Cesobjetsdoiventimp‚rativementcomporterde
chaquecot‚duchamplui-mˆmedespetitesflŠchesverslagaucheetla
droite(Ascii4et3).Unespacedoitrespectivementsuivreetpr‚c‚derces
flŠches.

`(B_FRAME`Rectangleservant…encadrerd'autresobjetspourlesregrouper
visuellement,parexempleungroupederadio-boutons.Letexteassoci‚
apparaŒtenhaut…gaucheducadre,…chevalsurletrait.Ilestpossible
dedonnerdesattributsgraphiques…cetexte.

`(B_MOVE`Boutonservant…d‚placerleformulairesurl'‚cran.Ilal'aspect
d'untriangle,commesilecoinduformulaire‚taitcorn‚.Ilest
traditionnellementplac‚dansl'anglesup‚rieurdroitduformulaire.

`(B_DEFAULT`C'estletraditionnelboutonpard‚faut,avecsonaspectnormal.

`(B_UNDO`C'estunbouton…l'aspectnormal,maisquipourraˆtreactiv‚par
unepressionsurlatouche<Undo>(g‚n‚ralement,c'estlebouton
'Annuler').Enoutre,undesescaractŠrespeutˆtresoulign‚,enle
faisantpr‚c‚derde'['.

`(B_UNDER`C'estunG_BUTTONouunB_DEFAULTdontuncaractŠreestsoulign‚
pourqu'un‚quivalentclavierluisoitaffect‚.LecaractŠreasouligner
estpr‚c‚d‚de'['.

`(B_HELP`BoutondonnantaccŠs…uneaideenligne,sansquitterlagestiondu
formulaireencours.Ilseraactiv‚parunepressionsurlatouche<Help>.
Il…l'aspectd'uneG_BOXTEXT'SHADOW'et'OUTLINE',avecletexteen
petitscaractŠres.

`(B_POPUP` Bouton"Shadowed"normal,maisquidonneaccŠs…lagestiond'un
menupop-upassoci‚,sansquitterlagestionduformulaireencours.S'il
estplushautquelebureau,lepop-upseraautomatiquementtransform‚en
scroll-menu.Leboutonpeutavoiruneic“ne"optionsuivante"optionnelle.
Pourcela,ildoitcomportercetype‚tendu.

`(B_LIST`CommeB_POPUP,maisc'estunpop-listequiestaffich‚:unpop-up
dehuitoptionsavecascenceur.Silepop-upcomportemoinsdeneuf
options,ilestaffich‚enpop-upnormal.Leboutonestagr‚ment‚d'une
ic“ne"optionsuivante".Letype‚tenduestobligatoire.

`(B_PICT` Permetdeplaceruneimagequelconque(d‚criteparunMFDB)dansun
formulaire.L'objetdebaseestuneG_BOXdepr‚f‚rence.

`(B_GRASTR`ChaŒnedetexteavecattributsgraphiques.Letextepeutˆtre
cal‚…gaucheou…droitedesdimensionsdel'objet.

`(B_SMSTR`ChaŒnedetexte‚criteenpetitscaractŠres,maispaslestout
petitsillisiblesdesic“nes,latailleau-dessus,lafonte8x8.Deplus,
letextepeutˆtrecal‚…gaucheou…droitedansl'objetetavoirdes
attributsgraphiques.

`(B_HIERM`Optiondemenuappelantunmenuhi‚rarchique,c'est-…-direunmenu
pop-up…cot‚dumenuprincipal.Peutˆtreplac‚dansunmenudefenˆtre.
Sileformulairedemenuhi‚rarchiqueesttrophaut,BIGletransforme
automatiquementenscroll-menu.

`(B_NICELINE`OptiondemenuDISABLEDfaitedetiretsdes‚paration.BIG
dessineuneligne.Iln'yapasdetype‚tendu,BIGtraitecetobjet
automatiquement.L'existencedecetobjetn'estpasseulementd–e…des
€raisonsesth‚tiques.Elleestindispensable…causedelapr‚sence
‚ventuelledel'utilitaire"LetThemFly",quir‚aliselemˆmeeffet
visuel,maisenentraŒnantunplantagesousBIGdanscertainesconditions !

`(B_FNCP`N'importequeltyped'objetouoptiondemenuquiserali‚…une
fonction('FNCP'signifie"FuNCtionPointer").Ilsuffitdecliquercet
objetoucetteoptiondemenu(oudel'invoquerparsonraccourciclavier)
pourquelafonctionsoitautomatiquementex‚cut‚e.

Dernierpointavantd'entrerdanslesd‚tails :l'aspectdecesobjetspeut
ˆtremodifi‚…volont‚parleprogrammeur(couleurdestextes,descadres,
desic“nes,etc).Nousyreviendronsdanslechapitredesfonctionsde
formulaire.

!************************
`!Lesattributs

Voiciuntableaur‚capitulatifdecesobjets,avecleurtype‚tendu,leurs
attributs,etc,telsqu'ilsdoiventˆtrecr‚‚sdansl'‚diteurderessource.

Nom  |Type|Type|ob_flags  |ob_state |ob_state|Attributs
objet|normal|‚tendu|normal|‚tendu|normal|interdits
----------+----------+--------+-----------+-----------+---------+----------
B_COCHE |G_BUTTON|B_SELEC|SELECTABLE |--|--|RBUTTON
||(18)   |         |  |         |SHADOWED
----------+----------+--------+-----------+-----------+---------+----------
B_RADIO |G_BUTTON |B_SELEC|SELECTABLE |-- | --   |SHADOWED
          |        |(18)|RBUTTON||         |
----------+----------+--------+-----------+-----------+---------+----------
B_EDIT |G_FTEXT|B_EDIT |EDITABLE |Nbre de | --   |SELECTABLE
        |G_FBOXTEXT|(25)   |          |caract. |         |EXIT
----------+----------+--------+-----------+-----------+---------+----------
B_FRAME  |G_BUTTON|B_FRAME|  -- |Attributs | --   |SELECTABLE
          |        | (20)  |           | graph.|         |EXIT
----------+----------+--------+-----------+-----------+---------+----------
B_MOVE |G_IBOX|B_MOVE|TOUCHEXIT |-- |OUTLINED |SELECTABLE
          |       |(17)   |           |          |CROSSED  |EXIT
----------+----------+--------+-----------+-----------+---------+----------
B_DEFAULT |G_BUTTON|B_UNDER |SELECTABLE |-- |  --   |--
          |     |(30)|DEFAULT||         |
          |       |(option)|EXIT     |           |         |
----------+----------+--------+-----------+-----------+---------+----------
B_UNDO   |G_BUTTON|B_UNDO |SELECTABLE |-- |  --   |DEFAULT
          |        | (31) |EXIT|||
----------+----------+--------+-----------+-----------+---------+----------
B_UNDER  |G_BUTTON |B_UNDER |SELECTABLE |  --     | --   | --
          |        | (30)   |EXIT|||
----------+----------+--------+-----------+-----------+---------+----------
B_HELP   |G_BOXTEXT |B_HELP |SELECTABLE |nø form.  |  --   |DEFAULT
       |(petitt.)|(21)   |         |associ‚   |         |EXIT
----------+----------+--------+-----------+-----------+---------+----------
B_POPUP  |G_BUTTON |B_POPUP |SELECTABLE |nø form.  |  --   |DEFAULT
         |G_IMAGE  |(22)|SHADOWED|associ‚|         |
          |B_BOX|(option)|         |           |         |
----------+----------+--------+-----------+-----------+---------+----------
B_LIST   |G_BUTTON |B_LIST |SELECTABLE |nø form.  |  --   |DEFAULT
          |      |(23)   |SHADOWED   |associ‚||
----------+----------+--------+-----------+-----------+---------+----------
B_PICT    |G_BOX   |B_PICT|--|Imgmono:|--   |--
          |         |(24)|         | coul/mode |         |
----------+----------+--------+-----------+-----------+---------+----------
B_GRASTR |G_BUTTON |B_GRASTR|  --    |Attributs  |  --   |SELECTABLE
          |       | (19)   |          |graphiques |         |EXIT
€----------+----------+--------+-----------+-----------+---------+----------
B_SMSTR|G_STRING|B_SMSTR|--|Attributs|--|
||(26)||graphiques||
----------+----------+--------+-----------+-----------+---------+----------
B_HIERM  |G_STRING|B_HIERM |  --    |nø form.  |  --   |--
        |(Menu) | (41)   |          |associ‚||
----------+----------+--------+-----------+-----------+---------+----------
B_NICELINE|G_STRING|--|--|--     |DISABLED |--
         |(Menu)|        |         |       |         |
----------+----------+--------+-----------+-----------+---------+----------
B_FNCP   |Tous     |B_FNCP |  --    |Rien … la |--    | --
          |       | (51)   |          |cr‚ation||
---------------------------------------------------------------------------

Notezquelesconventionspr‚sent‚esci-dessussontprochesdesstandards
existantdansd'autresbibliothŠquesGEM‚tendu,tellequeFLY_DIALet
INTERFACE(quineproposentpasdesystŠmedepointeurssurfonctionni
d'attributsgraphiques,nidemenushi‚rarchiques,etc).Toutefois,ilpeut
yavoirdesdiff‚rencesentrele"look"d'untyped'objetdessin‚par
INTERFACEetlemˆmedessin‚parBIG.Enparticulier,lesB_COCHEsetles
B_RADIOs.J'aivolontairementdonn‚unaspectdiff‚rent…cesdeuxboutons,
afinqu'ilsneressemblentpastrop…leurhomologuesdumondeMac.Mon
opinionpersonnelleestquelesd‚veloppeursdoivents'efforcerde
conserver…l'Atarisa"personnalit‚"etnepastenterdeluifaire
ressembler…d'autresmachines.

!************************
`!Dessine-moiunbouton

Voyons…pr‚sentlesd‚tails.Letypenormalcorrespondautypedel'objet
lorsdesacr‚ationdansl'‚diteurderessource.Cesontlesroutinesde
BIGquivontsechargerdelatransformationdel'objetenG_USERDEF(si
n‚cessaire)enfonctiondesautresindicationsdecetableau.Lenom
indiqu‚commetype‚tenduestceluidonn‚parles'#define'deBIG.H.La
valeurcorrespondanteestdonn‚eavec.Lesattributsde"ob_flagsnormal"
repr‚sententlesbitsquidoiventobligatoirementˆtrepositionn‚sdans
l'ob_flagsdel'objet.Demˆmepour"ob_statenormal".Lacolonne
"attributsinterdits"repr‚sententlesparamŠtresquinedoiventJAMAIS
ˆtreactiv‚s.Enfait,ilestconseill‚den'activerqueceuxquisont
indiqu‚sdanslesautrescolonnes,…l'exception‚ventuellementdes
ob_states'SELECTED'et'DISABLED'.

Les"ob_state‚tendus"sontutilis‚sparlesB_FRAMEs,lesB_GRASTRs,
B_POPUPs,lesB_LISTs,lesB_HELPs,lesB_HIERMs,lesB_EDITsetles
B_FNCPs.Pourcertainsd'entreeux(B_POPUPs,B_LISTs,B_HELPs,B_HIERMs),
iln'estpasn‚cessaireded‚finirl'ob_state‚tenduaumomentdela
cr‚ationduressource,unefonctiondeBIG(form_attach())pourras'en
chargerult‚rieurement.

Les"ob_flags‚tendus"sont‚galementutilis‚sparBIGetn'apparaissent
pasdanscetableau.Nousenparleronsaufuret…mesuredanslasuitede
cettedocumentation.

Commeilad‚j…‚t‚dit,les10bitslesplusfortsdeob_statesont
d'utilisationlibre.BIGn'utiliseenfaitquel'octethaut,c'est-…-dire
les8bitslesplusforts.EncequiconcernelesB_POPUPs,lesB_LISTs,
lesB_HELPsetlesB_HIERMs,nousl'utilisonsdansBIGpouryplacerle
num‚ro(danslefichierressource)duformulaireassoci‚…cebouton
(Attention,lanum‚rotationcommence…z‚ro).Parexemple,sileformulaire
nø12doitˆtreappel‚lorsdelas‚lectiond'unboutonB_HELP,nous
positionnonsdansl'ob_statedeceboutonlesbits10et11.Ennetenant
comptequedel'octetsup‚rieur,celacorrespond…lavaleur12.Les
routinesdeBIGappellerontautomatiquementceformulaireets'occuperont
€desagestion.

Leprincipeestlemˆmepourlesboutonspop_upetlesoptionsdemenu
hi‚rarchique.Nouscr‚onsdansl'‚diteurderessourceunbouton(ouune
optiondemenu)ayantlesattributsci-dessus,etl'octethautde
l'ob_statecontientlenum‚roduformulairepop-upassoci‚…cebouton.Un
mˆmeformulairepeutˆtreassoci‚…plusieursboutons.

EncequiconcernelesB_FNCPs,c'estencoreplussimple,puisquenous
n'avonsrien…faire…lacr‚ationdufichierressource(saufpr‚ciserle
type‚tendu,biens–r)!Leprincipeestdeplacerdansl'octethautde
l'ob_state‚tendul'indexcorrespondantdutableaudefonctions(ilnepeut
doncyavoir"que"256pointeurssurfonctionparapplication).Maiscela
estfaitautomatiquementparBIG.Eneffet,lesroutinesd'initialisation
comptentlenombred'objetsayantB_FNCPcommetype‚tendu,puisr‚servent
unezonem‚moiredetaillead‚quatequiseramanipul‚ecommeuntableaude
pointeurssurfonction.Auprogrammeurdefairepointerchaque‚l‚mentde
cetableausurunefonctionduprogramme(Nousverronscommenten‚tudiant
lesourcedelad‚mo,chapitre"LesourcedeBIGdemo").IlyadeuxrŠgles
…respecter.LapremiŠreestquelespointeursdoiventˆtreaffect‚saux
‚l‚mentsdutableaudanslemˆmeordrequelesobjetsapparaŒssentdansle
ressource.

Voyonsunexemple.Leressourcecomportetroisarbres:"Menu",
"Pr‚f‚rences"et"Choix"(danscetordre).Dans"Menu",deuxobjets
(num‚rot‚s15et23)sontdesB_FNCPs.Dans"Pr‚f‚rences",deuxautres
(num‚ros5et8),etenfin3objetsdansleformulaire"Choix"(num‚ros8,
11et13).C'estdansl'ordrecroissant(15,puis23de"Menu";5,puis8
de"Pr‚f‚rences";8,11puis13de"Choix")queles‚l‚mentsdetableaux
leurssontr‚serv‚s.Lorsquel'objet11de"Choix"seracliqu‚,c'estla
fonctiondontlepointeurestdansle5ø‚l‚mentdutableauquisera
ex‚cut‚e(Puisquec'estle6øobjetdansl'ordre,lanum‚rotation
commen‡ant…0).

LaseconderŠgleestquelafonctiondoitˆtredutype'voidfonction
(void)',c'est-…-direqu'ellenepeutrecevoiraucunparamŠtreetnedoit
enretourneraucun(Ilyauneastucepourpasseroutre…cettecontrainte,
voyezlechapitre"ParamŠtresetpointeurssurfonctions").Cette
possibilit‚defairepointerdesobjetsGEMsurdesfonctionsestundes
plusgrandsint‚rˆtsdeBIG.Lessourcesdesprogrammesdiminuent
‚norm‚mentgrƒce…cela,puisqu'iln'estplusn‚cessaired'effectuerune
s‚riedetestsjusqu'alorsincontournables:Queltyped'‚v‚nements'est-t-
ilproduit?Sic'estunclicmenu,quelleoption?Sic'estunboutonde
formulaire,quelboutondequelformulaire?etc...

LesobjetsB_FRAMEsetB_GRASTRsutilisentl'ob_state‚tendupour
d‚terminerlesattributsgraphiquesdelachaŒnedelamˆmefa‡onquela
fonction'vst_effect()'delaVDI.L'octetsup‚rieurdel'ob_statecontient
l'attribut.
`$bit0:Gras
`$bit1:Clair
`$bit2:Italique
`$bit3:Soulign‚
`$bit4:Contour

Silebit3estmispourunobjetB_GRASTR,letraitdesoulignementnese
limitepas…lalargeurdutexte,mais…lalargeurdel'objet(ob_width).

Enfin,l'ob_state‚tenduestutilis‚aveclesB_EDITspourindiquerle
nombredecaractŠresqu'ilestpossibledesaisirdanslechamp‚ditable.

LesB_SELECs(B_COCHEsetB_RADIOs)sontdessin‚spard‚fautaveclebouton
(carr‚ourondselonlecas)…gaucheetlestextedubouton…sadroite.
€Silebit 13del'ob_flags‚tenduestmis(d‚finisouslenom"BS_RIGHT",
commeB_SelectRIGHT),c'estl'inverse:bouton…droiteettexte…gauche.

Cesdeuxtypesdeboutonssontutilis‚spourlapossibilit‚d'activerle
boutonpard‚fautd'unformulairelorsd'undouble-clic.Pourcela,ilfaut
quelebit 11del'ob_flags‚tendudubouton(bitnomm‚DcD‚faultComme
Double-ClicD‚fault)soitpositionn‚.Cettefonctionnalit‚estutilisable
aussibienpourlesformulairesnormauxquepourceuxenfenˆtre,mais
‚videmmentparpourlesTool-Bars,puisqu'iln'yapasdeboutonpar
d‚faut !

!************************
`!Lesmenuspop-up

Lesformulairesd'aideetdepop-updoiventr‚pondre…certainsimp‚ratifs.
Lesaidessontdesimplesformulairessansdialogueavecl'utilisateur.Ils
necontiennentenprincipequedutexteexplicatifetdescadresde
pr‚sentation(LesB_FRAMEsetlesB_GRASTRspeuventˆtreemploy‚s).Il
doiventcomporteraumoinsunobjetdesortie:SELECTABLE,DEFAULT,EXIT.
Lesautrestypesdeboutons(RBUTTON,B_POPUP,etc)sontg‚r‚s
automatiquementdansunformulaired'aide,maislaroutined'aideelle-mˆme
devraˆtrer‚‚critesil'ond‚sireparexemplequel'affichagedel'aide
d‚pended'unPop-Up.Amoinsquel'onutilisedespointeurssurfonction.
Lesformulairespop-upontl'aspectd'unmenud‚roulant.L'objetracineest
uneG_BOXSHADOWEDdontlecontourestlarged'unpixelversl'ext‚rieur.
Ilyatroistypesdepop-ups:lepop-uptexte,lepopupimageetlepop-
upboŒte.

Lesoptionsd'unpop-uptextesontdesG_STRINGsTOUCHEXIT(cecietcequi
suitest‚galementvalablepourlesformulairesdestin‚s…devenirdespop-
listes).LesdeuxpremierscaractŠressontdesespaces(commedansunmenu
normal)pourlaisserlaplace…lacheck-mark.Sicertainesoptionsdoivent
ˆtreinactives,laG_STRINGcorrespondantedoitˆtreDISABLED.Ilest
fortementconseill‚quelesnum‚rosdecesG_STRINGssoienttri‚sdehaut
enbas.L'objet"appelant"d'unpop-uptexteestunG_BUTTONSHADOWED
SELECTABLE.S'ilpossŠdeenplusletype‚tenduB_POPUP(22),unepetite
ic“ne"optionsuivante"seradessin‚e…droitedubouton(ainsiques'il
s'agitd'unB_LIST).Celaestimpossibleavecunpop-upimageouboŒte.

Lesoptionsd'unpop-upimagesontdesG_IMAGEs.Ellesdoiventtoutesavoir
lesmˆmesdimensions(ob_widthetob_height),‚galementlesmˆmesque
cellesdel'objetG_IMAGEquiaappel‚lemenupop-up.Cetobjet"appelant"
doitˆtreSHADOWEDetSELECTABLE.Commel'attributSHADOWEDn'apas
d'influencesurl'aspectvisueld'uneG_IMAGE,ilestconseill‚(commedans
lad‚mo),delaplacerdansuneG_BOXSHADOWED,puisquec'est
traditionnellementl'ombragequisignalelapr‚senced'unpop-up.Unpop-up
imagenepeutavoirdetype‚tendu(cesontsesattributsquile
d‚finissent)niˆtreunpop-liste,donc,pasdebouton"optionsuivante".

Lesoptionsd'unpop-upboŒtesontdesG_BOXs.Leursdimensionsn'ontpas
d'importanceparticuliŠre.L'objet"appelant"estuneG_BOXSHADOWEDet
SELECTABLE.Unpop-upboŒtenepeutavoirdetype‚tendu(cesontses
attributsquiled‚finissent)niˆtreunpop-liste,donc,pasdebouton
"optionsuivante".

L'utilisationd'unpop-upestexactementlamˆmequecelled'unmenu
d‚roulantclassique(…ceciprŠsques'ilestplushautquelebureau,BIG
letransformeenscroll-menu).Lepop-uptentedeseplacerdemaniŠre…ce
queletexteduboutonB_POPUPetceluidelaG_STRINGdemˆmetexte(oula
G_IMAGEouG_BOXdemˆmemotif)soitsuperpos‚s.Sicelan'estpaspossible
carlepop-upsortiraitdel'‚cran,ilestd‚cal‚d'autant.

Siletexted'aucuneG_STRING(oulemotifd'aucuneG_IMAGEouG_BOX)ne
€correspond,lecoinsup‚rieurgauchedupop-upestcal‚surlecoin
inf‚rieurgaucheduB_POPUP.LaG_STRINGcorrespondanteest"check‚e".Pour
fermerlepop-upsansfairedechoix,ilsuffitdecliquer…c“t‚.Siune
s‚lectiona‚t‚faite,letextedelaG_STRINGcliqu‚eestreport‚dansle
boutonB_POPUPquiaappel‚lepop-up(sanslesespacesded‚butetde
fin),oulemotifdelaG_IMAGEestreport‚danslaG_IMAGEB_POPUP,oules
caract‚ristiquesdelaG_BOXdanslaG_BOXd'appel.

Ilestdoncimp‚ratifqu'aud‚part,letexteduboutonsoitaumoinsaussi
longqueceluidelapluslongueG_STRING,danslecasd'unpop-uptexte,
ouquetouteslesG_IMAGEssoientdemˆmedimensionsdanslecasd'unpop-
upimage.Ilestpossibleder‚aliserunpop-upavecplusieurscolonnesde
G_STRINGsoudeG_IMAGEs.MaisellesdoiventrecouvrirentiŠrementl'objet
racine,commedansunmenud‚roulant.

Silepop-upa‚t‚chang‚enscroll-menu,ilseraplac‚parBIGsousle
boutond'appel,…conditionqu'ilyaitlaplacepouraumoinsquatre
optionsetlesdeuxflŠchesdescroll.Sicen'estpaslecas,lepop-up
partiradetoutenhautdubureau.

D'autrepart,lespop-listessontplac‚espard‚fautsouslebouton
d'appel.S'iln'yapasassezdeplace,ellessontplac‚esau-dessus.

Pendantquelasourissed‚placesurlesoptionsd'unpop-up,plusieurscas
peuventsepr‚senter.Toutd'abord,s'ils'agitd'unpop-upboŒte,l'option
point‚eestsimplement"encadr‚e"d'untrait.Danscecas,c'estpr‚f‚rable
…unes‚lectionquiinverseraitlacouleuroulatrameetg‚neraitlabonne
visualisationdel'option.Sic'estunpop-upimage,l'optionpoint‚eest
s‚lectionn‚e,doncinvers‚e.Danslecasd'unpop-up(oupop-list)de
texte,l'optionests‚lectionn‚e(invers‚e)silesystŠmecomportemoinsde
16couleursousilaboŒte-racineduformulairepop_upasonbit
"BackGround"…z‚ro(voirlechapitresurlerelief).Sinon(s'ilyaau
moins16couleursetsilebitBackGrounddelaboŒte-racineest…1),
l'optionpoint‚eestaffich‚esurfondjaune,cequidonneuneimpression
derelief.

AprŠsl'appel…unpop-upou…unpop-list,lavariableglobale"cliq_in"
vautTRUEsiuneoption…‚t‚effectivementchoisieetFALSEsinon.

Jerappellequelafonction`$form_attach()`permetdelierlesboutonspop_up
…leursformulairesrespectifsaud‚butdel'ex‚cutionduprogramme,cequi
estpluspratiquequedelefairedurantlacr‚ationduressource.Surtout
quesil'ondoitparlasuiteajouterunformulaire,lesnum‚rosde
certainsrisquentd'ˆtred‚cal‚s.

!************************
`!Lesboutonss‚lectables

LesboutonsB_COCHEetB_RADIOpartagentlemˆmetype‚tendu(B_SELEC).Ils
sontenr‚alit‚delamˆmecat‚gorie:SELECTABLE.Leurseulediff‚rence
estquelesB_RADIOssontdesradio-boutons,d'o—leuraspectdiff‚rent
pourmieuxlesdistinguer.CesboutonspeuventcomporteruncaractŠre
soulign‚.Durantlagestionduformulaire,leraccourciclavier
<Alternate + caractŠre>sera‚quivalent…unclicsurcebouton.Lorsdela
cr‚ationduressource,lecaractŠre…soulignerdoitˆtrepr‚c‚d‚d'un
crochetouvert('[').Laroutinededessinduboutonsechargeradureste.
Attention,siplusieursboutonsd'unmˆmeformulaireontlemˆmecaractŠre
soulign‚,c'estlepremier(dansl'ordredenum‚rotationdesobjets)qui
seraretenupourleraccourciclavier.Ilestpossiblequecesboutons
quittentlagestionduformulaire(EXIT),ouqu'ilssoientinactifs
(DISABLED).Danscecas,leclicsourisetleraccourciclaviersontsans
effet.

€Lorsdelacr‚ationd'undecesobjetsdansl'‚diteurderessource,la
largeurduG_BUTTONnecorrespondpasforc‚ment…lalargeurquisera
occup‚"physiquement"parl'objetdessin‚dansleformulaire,puisquele
carr‚oulecercleestajout‚…c“t‚dutexte.Voiciunconseil:commencez
parcr‚erlebouton…latailleminimum,c'est-…-direlalargeurdutexte.
Activezl'optiondegrilledel'‚diteurderessource(Lagrillehorizontale
anormalementunpasde8pixels,largeurd'uncaractŠreenfontesystŠme).
Augmentezalorslalargeurdeceboutondetrois"unit‚s"s'iln'yapasde
caractŠresoulign‚,etdedeuxs'ilyenaun.Ainsi,lalargeurdubouton
dansl'‚diteurderessourceestlerefletdelalargeurqu'ilauraunefois
dessin‚parlesfonctionsBIG.

Silebit 13del'ob_flags(BS_RIGHT)est…z‚ro,leboutonsera…gauche
etletexte…droite.S'ilest… 1,seseral'inverse.

Silebit 11del'ob_flags(DcDefault)estmis,undouble-clicsurle
boutonactivera‚galementleboutonpard‚fautduformulaire(s'ilyena).

LesB_POPUPsn'ontpasforc‚mentdetype‚tendu.Letypeoptionnel22
permetd'avoirautomatiquementunepetiteic“ne"optionsuivante"enforme
deflŠchecirculaire…droitedubouton(interditpourlespop-upsimageou
boŒte).Parcontre,ilestobligatoiredeluidonnerl'attributSHADOWED,
c'estluienfaitunpop-up.LesboutonsB_LISTonttoujoursl'ic“ne
"optionsuivante",etsontdoncr‚serv‚sauxpop-upstexte.

Letype‚tendudesboutonsB_HELPn'ontpasnonplusd'influencesurleur
aspect.Leurdessinestlaiss‚ausoindesroutinesGEMnormales.Cetype
‚tendusert…lesdistinguerdansleformulairelorsd'unepressionsurla
toucheHelp.SiplusieursobjetspossŠdentcetype‚tendu,c'estlepremier
quiseraretenu.Ilpeutˆtreutiled'enavoirplusieursdanslemˆme
formulaire.Lepremierformulaired'aidepourraˆtreappel‚parlatouche
Help,lesautresuniquementparclicsouris.Celaal'avantagedelaisser
lagestionduformulaired'aideauxroutinesBIG,parlesystŠmede
l'ob_state‚tenduexpliqu‚plushaut(c'estcequiestfaitdanslad‚mo
pourleformulaired'informations).

LesB_UNDOsontuntype‚tenduquisert…lafois…lesrep‚rerlorsd'une
pressionsurlatouche<Undo>et…leurdonnerlapossibilit‚d'avoiren
plusun‚quivalentclavierparcaractŠresoulign‚.

LesB_DEFAULTsn'ontpasdetype‚tendu,l'attributDEFAULTestsuffisant
pourlesrep‚rerlorsd'unepressionsur<Return>.Toutefois,ilspeuvent
avoirenplusletype‚tenduB_UNDERpourdisposerd'un‚quivalentclavier
parcaractŠresoulign‚.

Commenousl'avonsrapidementvudanslavisiteguid‚edeBIGdemo,les
formulairesenfenˆtrepossŠdent4boutonsdebase:'Applique',
'Confirme','R.A.Z.'et'Annule'(vouspouvez‚videmmentleslibeller
autrement).Selonlespr‚f‚rencesduprogrammeur,ceserasoitlapaire
'Applique'et'R.A.Z.',soitlapaire'Confirme'et'Annule'quisera
activ‚eparlestouches<Return>et<Undo>.Lebit 13del'ob_flags
(WFCLOSE)doitˆtrepositionn‚pourentraŒnerlafermetureautomatiquede
lafenˆtre.

Parexemple,danslesformulairesenfenˆtredeBIGdemo,'Applique'et
'R.A.Z.'sontactivables…partirduclavier.'Confirme'et'Annule'
n‚cessiteunclicsouris,maisfermentautomatiquementlafenˆtre.FaŒtes
l'exp‚rienced'oterlesattributsB_DEFAULTetB_UNDOdesdeuxpremiers
pourlesaffecterauxdeuxautres,etlafenˆtrepourraˆtreferm‚eparle
clavier.Onpeutenvisagerdansunprogrammedelaisserlechoix…
l'utilisateurdequellepairedeboutonspeutˆtreactiv‚eparleclavier,
enmodifiantlesattributscorrespondantsdansleressourceenm‚moire,
toutenchoisissantuneconfigurationpard‚faut…lacr‚ationdu
€ressource.

!************************
`!Les‚ditables‚tendus

LesobjetsB_EDITsontdeschamps‚ditables"‚tendus",quiautorisentla
saisiedeplusdecaractŠresquelalargeurapparenteduchampnelelaisse
supposer.Parexemple,l'‚ditablelui-mˆmepeutˆtrelargede15caractŠres
(largeurdelachaŒnete_pvalid),maisletextepeutavoirunelongueur
plusimportante,jusqu'…255caractŠres.

LenombredecaractŠresautoris‚sestindiqu‚dansl'octethautde
l'ob_state(iln'estpaspossibledemodifiercenombreencours
d'ex‚cutionduprogramme,carlam‚moiren‚cessaireestr‚serv‚e…
l'initialisation).
Ilestimp‚ratifdeplacerlesflŠchesdepartetd'autreduchamp,dela
maniŠresuivante(lesflŠchessontrepr‚sent‚esiciparlescaractŠres'<'
et'>'aulieudescaractŠresAscii4et3):
Texte:<_______________>
Lechampestpr‚c‚d‚d'uneflŠche…gaucheetd'unespace,ilestsuivi
d'unespaceetd'uneflŠche…droite.CesflŠchespermettentdefaire
d‚filerletexte…lasouris.Laroutinedeplacementducurseur…
l'emplacementduclic(lorsqu'oncliquedanslechamp)tientcomptedans
sescalculsdelapr‚sencedecesflŠchess'ils'agitd'unobjetB_EDIT.Si
vousommettezlesflŠchesetleursespaces,lecurseurserapositionn‚deux
caractŠres…gauchedelapositioncliqu‚e.

D'autrepart,lorsdelasaisiedescaractŠres,BIGconsidŠrequelachaŒne
te_pvalid(lefiltredesaisie)estactifpourlapartieapparentedu
texte.Ilfautdoncr‚serverlesB_EDITaux‚ditablesconstitu‚sde
caractŠresdemˆmetype.ParexemplelachaŒnete_pvalidsera"XXXXXXXXXXX"
ou"9999999999".Sielleestconstitu‚edeplusieursfiltresdiff‚rents,on
aurademauvaisessurprises…lasaisie.

!************************
`!D‚placerleformulaire

LesboutonsB_MOVEpermettentded‚placerleformulairesurl'‚cran.Ce
d‚placementpeutsefaire"entempsr‚el",c'est-…-direquec'estuneimage
duformulairelui-mˆmequel'ond‚placejusqu'…lanouvelleposition,ou
simplementparune"boŒtefant“me"…sesdimensions.Toutefois,s'iln'ya
pasassezdem‚moiredisponiblepourtravaillerentempsr‚el(l'‚cran
entierdoitˆtresauv‚dansunbuffer),lesystŠmedelaboŒtefant“meest
automatiquementutilis‚,mˆmesiled‚placemententempsr‚elestdemand‚
lorsdel'appeldelafonction.Ilestpossibledeforcerl'utilisationde
laboŒtefant“meaulieudutempsr‚elmˆmes'ilyaassezdem‚moire.

Lorsqu'oncliquecebouton,etquel'ongardeleboutonenfonc‚,onpeut
d‚placerleformulaire.Quandlasourisestrelƒch‚e,leformulaireest
"pos‚"aunouvelemplacement.Lesd‚placementsduformulaire(oudela
"boŒtefant“me")sefontdansleslimitesdubureau,moinstroispixelssur
chaquebord,afindecompenserl'attributOUTLINEDqu'ontlaplupartde
tempslesobjets-racinedesformulaires.

!************************
`!Dutextegraphique

LesB_FRAMEssontdesG_BUTTONs.Seulleurtype‚tendulesdistingue.Le
c“t‚sup‚rieurducadreseratrac‚…unedemihauteurdecaractŠreplusbas
quel'emplacementduboutonlorsdesacr‚ationdansl'‚diteurde
ressource.Letextesera…chevalsurcetteligne,…unelargeurde
caractŠredubordgauche.L'ob_state‚tendusert…d‚terminerlesattributs
graphiquesdecetexte.
€
LesB_GRASTRspeuventˆtredesG_STRINGsoudesG_BUTTONs.LetypeG_BUTTON
estconseill‚,carilpermetdemieuxvisualiser(dansl'‚diteurde
ressource)lalargeurdel'objet(quiestutilis‚esiletextedoitˆtre
soulign‚).Silebit 13del'ob_flags(BS_RIGHT,d‚j…rencontr‚avecles
boutonss‚lectables)est…z‚ro,letexteseracal‚…gauchedesdimensions
del'objet.Silebitestmis,letexteseracal‚…droite.

LesB_SMSTRs(CommeSMallSTRing)sontvoisinsdesB_GRASTRdansleur
aspect.Ils'agitd'untextequiseraaffich‚aumoyendelafonte8x8,
dontmoinshautedemoiti‚quelafonte"normale"(enhauter‚solution),
maisaussilarge,cequilaconservetrŠslisible,aucontrairedelafonte
6x6,vraimenttroppetite.Silebit 13del'ob_flags(BS_RIGHT,d‚j…
rencontr‚aveclesboutonss‚lectables)est…z‚ro,letexteseracal‚…
gauchedesdimensionsdel'objet.Silebitestmis,letexteseracal‚…
droite.SilebitBackGroundestmis,letextesera‚critenmode
transparent,sinonenmodeopaque.

!************************
`!Lerelief

BIGpermetdedonnerauxformulairesunaspect"3D".La"m‚thodeBIG"est
compatibleaveclessp‚cificationsdel'AES,quiutiliselesbits9et10
del'ob_flagsdesobjets.BIGn'utiliseetnetestequelebit10,nomm‚
"BKGR"(comme"BacKGRound",fond),quisert…accorderl'aspectdel'objet
(notammentsatrameetsacouleur)avecceuxdel'objetsitu‚souslui.

Pourr‚aliserunformulaire3DavecBIG,deuxcassont…distinguer:sion
esten16couleursouplus,etsionesten2ou4couleurs.Dansle
premiercas,leplusbeleffetestobtenulorsquel'objet-racineaune
trame…100%etlacouleurnum‚ro8,quiestd‚finiecommegrisclairpar
d‚faut.Danslesecondcas,lemieuxestderenonceraurelief.Ilya
toutefoisunepossibilit‚delesimuler,maisl'effetn'estguŠre
esth‚tique:ilfautdonnerunetrame…l'objet-racine(latrame…50%est
recommand‚e)quitte…lachangerpourdu100%griss'ilyaassezde
couleurs.Ensuite,danslesdeuxsituations,celad‚penddutyped'objet
BIG(jetezuncoupd'oeilauxformulairesdelad‚mopourmieuxcomprendre
lesexplicationsquisuivent):

LetextedesobjetsdetypeB_SELECT(lesB_RADIOsetlesB_COCHEs)est
toujours‚critenmodetransparent,doncilsseronttoujoursenaccordavec
latrameetlacouleurplac‚esdessous.D'autrepart,lesdessinsdupetit
rondoudupetitcarr‚donnentaumoyend'uneombrel'illusionqu'ilssont
"sortis"quandilsnesontpass‚lectionn‚s,etqu'ilssont"enfonc‚s"
quandilssonts‚lectionn‚s.Iln'yadoncrien…fairedeparticulierpour
placercesobjetsdansunformulaire3D.

LesB_GRASTRsdoiventavoirlebitBackGroundpositionn‚.Danscecas,le
texteesttransparent,etletraitdesoulignementnoirestdoubl‚d'une
ligneblanched‚cal‚e,pourdonneruneimpressionderelief.Surunfond
tram‚,ilestd‚conseill‚dedonn‚…cestextesl'attributItalique,c'est
peulisible.Silebitn'estpasmit,letexteestaffich‚enmodeopaque.

Demˆme,lesB_FRAMEssontnormalementdesrectanglesblancs,mais
deviennentuncadretransparents'ilyaBackGround.Letrac‚dececadre
est‚galementdoubl‚delignesblanchesd‚cal‚es.Letextedevient
transparent(mˆmeremarque…proposdel'Italique).

LesB_UNDERsetlesB_UNDOsdeviennenttransparentsen3D.Lesboutons
B_DEFAULTn'‚tantpasdesG_USERDEFs,ilssontdessin‚snormalement,c'est-
…-direblancopaque.L'astuceestdeleurdonnerletypeB_UNDERmˆmesion
nesouhaitepasleuraffecterderaccourciclavier,etdepositionnerleur
bitBackGround.
€
LesB_POPUPs(ayantletype‚tendu22)etlesB_LISTsdeviennent
transparentsgrƒceaubitBackGroundetsontagr‚ment‚sdelignesblanches
surlesc“t‚sgaucheethauts'ilsnesontpass‚lectionn‚s,surlesc“t‚s
droitetbass'illesont.

Lesmenuspop-upseux-mˆmes(ainsiquelesmenuspop-uplibres,lesmenus
B_LIST)ontuneparticularit‚s'ilyaaumoins16couleurs.Silebit
BackGroundestmispourl'objet-racine,l'optionpoint‚eestaffich‚een
textenoirsurfondjaune.Pourr‚aliserceteffetassezesth‚tique,la
palettedecouleuractive…cemomentestl‚gŠrementmodifi‚e,puis
restaur‚e…lafindel'appel.Celaestparfoisind‚sirable,surtoutsiune
imagesetrouve…cemoment…l'‚cran.Onpeutalorsd‚sactiverlebit
BackGround.L'optionpoint‚eparlasourisestalorssimplement
s‚lectionn‚edefa‡onordinaire,c'est-…-direinvers‚e.

Enfin,lesobjets‚ditables(mˆmes'ilsnesontpasB_EDITs)ayantunbit
BackGroundsonttransform‚senG_FBOXTEXTs(sicen'‚taientpaslecas),
‚ventuellementsanscadre,transparents.Maisleurdessinrestent…la
chargeduGEM.Ilnesuffitpasdeleurdonnerl'attributtransparent,car
s'ils'agitdeG_FTEXTssansBOX,leGEMgŠrel'‚ditiondutextedemaniŠre
incorrecte.

Lam‚thodedelatrame100%etdelacouleurnø8nemarchepasenmoins
de16couleurs,carcettecouleurestalorsnoire.Onpeuttesteraud‚but
duprogrammelenombredecouleurs.S'iln'yenapas16,ilfauttramer
touslesobjetsconcern‚s,oulesmettreenblanc(plusde3D).Sinon,on
lesmetsengris.

Dernierpoint.UnboutonDISABLEDauntexteaffich‚engris‚,c'est-…-dire
entrame50%.Surunfonddetramedemˆmepourcentageetdemˆmecouleur,
lespixelsdutexteetceuxdufondpeuventsoitco‹nciderexactement,soit
ˆtreexactementaltern‚s.Danslepremiercas,letextedisparaŒtradela
vue,etdanslesecondilparaŒtranormalement‚crit.Ilvautmieuxˆtreau
courantdecesillusionsd'optique!

!************************
`!Lesimagesenformulaire

Lesobjetsdetypes‚tenduB_PICTpermettentdeplaceruneimagequelconque
dansunformulaire.

Voicilescaract‚ristiquesdecetobjet :
Alacr‚ation,onpeuth‚oriquementutilisern'importequeltyped'objet
GEM,maisletypeG_BOXmesembleleplusindiqu‚carilpermetdebien
visualiserlescoordonn‚esdelafutureimagedansl'‚diteurderessources.
Voicilastructurequicontientlesinformationsrelatives…cetobjet :
`$    typedefstructt_image_dial{
`$      MFDBmfdb_image;
`$      GRECTcur_pos;
`$    }t_image_dial;
'mfdb_image'estunesous-structuredetypeVDIMFDBquid‚critentiŠrement
l'image…utilis‚e(adresse,taille,etc).
'cur_pos'estunesous-structureAESGRECTpermettantder‚aliserungenre
declippingdel'image,c'est-…-diren'enutiliserqu'unepartiepourla
placerdansleformulaire.'cur_pos'd‚critlescoordonn‚esdecettepartie
parrapport…l'imageentiŠre.

Alacr‚ationduressource,cr‚ezvosB_PICTsetdonnez-leurlesdimensions
quel'imageoccupera(sil'imageestplusgrande,uned‚coupeesteffectu‚e
automatiquement).Ensuite,danslecorpsduprogrammeetaprŠsl'appel…la
fonction`$initial()`,effectuezlechargementdel'image(oudesimagess'il
yenaplusieurs)enproc‚dantainsi('adr'estl'adresseduformulaireo—
€setrouvel'objet,'objet'estlenum‚rodecetobjetet'taille'estla
tailleenoctet…r‚server) :

-R‚servezl'espacem‚moirepar
`$    t_image_dial*img;
`$img=(t_image_dial*)adr[objet].ob_spec.userblk->ub_parm;
`$img.mfdb_image.fd_addr=(long)malloc(taille);
-Remplissezlesautres‚l‚mentsdesstructuresMFDBetGRECTavecles
valeursad‚quates.
-N'oubliezpasdechargervotreimage(aprŠsd‚compressionsi
n‚cessaire)…l'adresseimg.mfdb_image.fd_addr !

C'esttout.Iln'estmˆmepasn‚cessairedelib‚rerleszonesm‚moire
r‚serv‚es,lafonction`$end()`s'enchargeenfind'ex‚cutionduprogramme.

Parcontre,vousdevezvousoccuperdelapalettedecouleursdevotre
imagesicelle-ciencomporte.Sileformulaireestenfenˆtre,r‚servez
l'espacem‚moirepourcettepaletteetplacezcetteadressedansl'‚l‚ment
win[index].w_paldelaBigWincorrespondante(voyezleschapitressurles
fenˆtresBIG).BIGsechargeradel'activerlorsquelafenˆtrepasseraau
premierplanetdelad‚sactiverdanslesautrescas.Sileformulaire
n'estpasenfenˆtre,vousdevrezvousoccuper"…lamain"delapalette.

Enfin,derniŠrepossibilit‚ :sil'imageestunmotifmonochrome(unseul
plandecouleur),ilestpossibled'affecterunecouleur…sespixels.
L'indexdecettecouleurestplac‚danslesquatrepremiersbitsdel'octet
hautdel'ob_state.Lespoints"blancs"del'imageserontaffich‚s...en
blanc !Lesquatrebitssuivantsrepr‚sententlemodedecopiedel'image,
selonlarŠgledelafonctionVDI`$vrt_cpyfm()`,c'est-…-dire :
  1 : Remplacement
  2 :Tranparent
  3 :Xor
  4 :Inversetransparent
BIGnev‚rifierien…cesujet,veillez…bienplacerunecouleuretun
moded'affichagedansl'ob_state‚tendu.

Sil'imagepossŠdeplusieursplansdecouleurs,elleestaffich‚eavecla
fonction`$vro_cpyfm()`etl'ob_state‚tenduestignor‚.

!************************
`!Lesmenushi‚rarchiques

LesB_HIERMssontimp‚rativementr‚serv‚sauxG_STRINGsdesoptionsde
menu.L'ob_state‚tenducontientlenum‚roduformulairepop-upquiestli‚
…cetteoption.Lagestiondumenuhi‚rarchiquem‚ritequ'ons'yarrˆteun
peupourdesexplications.

Und‚laid'environunedemisecondeestrespect‚,puis,silecurseurdela
sourisesttoujourssurcetteoptiondumenu,lesous-menuestaffich‚
(‚ventuellementtransform‚enscroll-menus'ilesttrophaut).LeproblŠme
suivantseposealors:Silasourisestamen‚esurunautretitredemenu,
lemenucorrespondantestautomatiquementd‚roul‚parleGEM!Evidemment,
cemenurisquedeseplacer"pardessus"lemenuhi‚rarchique.Ilnesert…
riendetenterdesupprimerlagestiondumenuprincipalpar
wind_update(BEG_UPDATE)oumenu_bar(0),caralorslemenucontenantnotre
B_HIERMdisparaŒt!

Laseulesolutionsembleˆtrelasuivante(contactez-moisivousavezune
autreid‚e):lemenuhi‚rarchiqueestreferm‚dŠsquelecurseurdela
sourispasse"au-dessus",c'est-…-direqu'ilaunepositionenyinf‚rieure
auhautdusous-menu.Ilestdoncinterditdeplacerunmenuhi‚rarchique
commepremiŠreoptiond'unmenu,carce"au-dessus"correspondrait…
l'entr‚edanslabarredemenu,etnousretrouverionslemˆmeproblŠme:un
€nouveaumenupourraitˆtred‚roul‚surlemenuhi‚rarchique.

D'autrepart,bienquel'optiondumenusoitunUserdef,leGEMprendla
fƒcheuseinitiativedelaconsid‚rerd‚s‚lectionn‚edŠsquelecurseurde
lasourislaquittepourpassersurlemenuhi‚rarchique.Lafonction
charg‚ededessinercetteoptionennormaloueninvers‚effectuetouteune
s‚riedetestsetd‚cideenfonctionducontexte(sous-menuaffich‚ounon)
etdelapositiondelasouris(surcetteoption,suruneautre,sortie
cot‚sous-menu,sortieautrecot‚,plac‚eau-dessus,etc)commentelledoit
ˆtredessin‚e,etforce‚ventuellementlebitSELECTED.

Toutescesconsid‚rationsnes'appliquentqu'auxmenushi‚rarchiquesdu
menuprincipal.Danslecasdesmenusenfenˆtre,lasituationestplus
simple.Eneffet,cen'estpasleGEMquigŠrecettebarredemenu,c'est
unefonctiondeBIG.Silecurseurdelasourispassesurunautretitrede
menualorsqu'unmenuhi‚rarchiqueestd‚roul‚,cettefonctionprendla
peinedelerefermeravantd'afficherlenouveaumenu.Decefait,ilest
possibledeplacerunmenuhi‚rarchiqueassoci‚…lapremiŠreoptiond'un
menudefenˆtre.

L'optiondemenuB_HIERMdoitˆtrecompl‚t‚epardesespacessurtoutesa
largeur.Eneffet,BIGplaceenavant-derniercaractŠreunepetiteflŠche
dirig‚everslecot‚o—vased‚roulerlemenuhi‚rarchique(Ascii3ou4).
Danslecasdumenuprincipal,lafonctiond'initialisationsechargede
l'op‚rationunebonnefoispourtoutesaud‚butdel'ex‚cutiondu
programme.

SivotreapplicationpossŠdeplusieursbarresdemenu,vousdevrezappeler
vous-mˆmelafonction`$create_hierm()`(…voirdanslechapitredes
fonctionsdegestiondesformulaires)…chaquechangementdemenu(sile
nouveaumenunepossŠdepasdeB_HIERM,c'estinutile).Danslecasdes
menusdefenˆtre,BIGsechargedel'op‚ration…chaquefoisqu'unmenu
doitˆtred‚roul‚,puisquelafenˆtreapuˆtred‚plac‚edepuisledernier
calcul.Deplus,silesous-menurisquedesortirdel'‚cranparlebas,il
estd‚cal‚d'autantverslehaut,ouchang‚enscroll-menus'ilest
vraimenttrophaut.Celanesefaitquepourlesmenusenfenˆtre.Pourle
menuprincipaliln'yapasded‚calage,seulementunemiseenscrollsile
menuhi‚rarchiquesortdubureauparlebas.

!************************
`!LesformulairesToolbar

Cetypedeformulaireestcr‚‚commen'importequelautre.Toutefois,ilne
doitcomporteraucunobjetEXITouTOUCHEXIT,nidechamp‚ditable.BIG
n'effectueaucuntestdecontr“ledanscesens.Lesautrestypesd'objets
sontautoris‚setg‚r‚scommepartoutailleurs(raccourcisclavier,pop-ups
etpop-listes,radio-boutons,etc).Nousverronsplusloincommentutiliser
lestoolbars.Maisn'oublionspasquecesformulairesdoiventˆtreleplus
petitpossibleenhauteurafindenepastropr‚duirelasurfacedetravail
delafenˆtre.Leurobjet-racinesera‚largiparBIGaudoubledela
largeurdubureau.iln'estpaspr‚vudepouvoirlesd‚calercommec'estle
casdesmenusenfenˆtre,maisriennevousempˆched'yplacerdesboutons
flŠch‚setdeg‚rervous-mˆmeced‚calage"…lamain".Eviteztoutefoisde
placerlesoptionslespluscourammentutilis‚esversladroite,carelles
sontinaccessibleslorsquelafenˆtreest‚troite.

!************************
`!Lesraccourcisclavier

Danslesoptionsdemenu,l'inscriptiondesraccourcisclavierdoit
r‚pondre…certainsimp‚ratifs.Les‚quivalentsclavieravecdes
combinaisonsfaisantappel…plusieurstouchessp‚ciales,comme<Shift+
Control>parexemplesontpossible,maisilnefautpasenabuserpourdes
€raisonsd'ergonomieduprogramme.D'ailleurs,larecommandationg‚n‚raleen
cequiconcernecepointestdeplacerdanslesmenusdesraccourcis
utilisantuniquementlatouche<Control>,latouche<Alternate>‚tant
r‚serv‚eaux‚quivalentsclavierdanslesformulaires.D'autrepart,les
raccourcissanstouchesp‚ciale(directementlecaractŠre)nesontpas
autoris‚s,pourlepascr‚erdeconflitavecdesoptionsdugenre
"Texte 1".

BIGnetientpascomptedesespacesderemplissagequipeuventsuivre
l'inscriptionduraccourciclavier.LederniercaractŠre"r‚el"del'option
demenuestdonclecaractŠrequidoitˆtrepress‚,lescaractŠresquile
pr‚cŠdentdoiventˆtre'^'pourlatouche<Control>,lecaractŠreAscii7
(unlosangedansunrectangle)pourlatouche<Alternate>,lecaractŠre
Ascii1(laflŠcheverslehaut)pourlatouche<Shift>.

Laroutinederecherchedesraccourcisclaviernefaitpasladiff‚rence
entrelesmajusculesetlesminuscules(nidanslesmenus,nidansles
formulaires).Ellenediff‚renciepasnonpluslatouche<Shiftdroit>de
latouche<Shiftgauche>.

Etantdonn‚quelarecherches'effectuedansleressourceenm‚moireeten
fonctionducodeAsciiducaractŠretap‚,lagestiondesraccourcisclavier
estind‚pendantedutypedeclavier(Azerty,Qwerty,etc),etd‚pendantede
l'‚quivalentplac‚dansl'optioncorrespondante.Pourmodifierunraccourci
clavierd'unprogrammesousBIG,ilsuffitdelemodifierdanslefichier
ressource.Sansdevoirrecompilerleprogramme,lenouvel‚quivalent
clavierseraactifimm‚diatement.Nouspouvonsdoncenvisageruneoption
(oud'unpetitprogrammeexterne)permettant…l'utilisateurde
reconfigurerentiŠrementl'interfacedulogicielenfonctiondeses
pr‚f‚rencespersonnelles.Ilauraitainsilapossibilit‚d'affecteraux
optionsqu'ilutiliseleplussouventun‚quivalentclavierr‚alisable
d'uneseulemain,ouplusfacilementm‚morisable,selonsesgo–ts.

Il est possible d'affecter des touches nonalphanum‚riques…unraccourci
clavier.Danscecas,latouchesp‚cialeestfacultative(Parexemple,une
optionpeutˆtreappel‚eparlatouche<Undo>touteseule).Voicilaliste
desmots-cl‚…placerdansl'optiondemenu,pourchacunedecestouches,
quevousreconnaŒtrezaupassage :

Help,Undo,BackspcouBksp,DelouDelete,Insert,Clr,Fn.

"Fn"estmispourlestouchesdefonction,le'n'‚tant‚videmment…
remplacerparlenum‚rodelatouche.Iln'estpasfaitdediff‚renceentre
lesmajusculesetlesminuscules.Lescombinaisonsinterdites,parceque
r‚serv‚esparlesystŠmesont :<Alternate +Help>(Hardcopie),
<Alternate +Insert>(clic gauche),<Alternate +Clr>(clic droit)et
touteslescombinaisons<Alternate + pav‚num‚rique>,r‚serv‚spourles
codesAsciisurlesversionslesplusr‚centesduTOS..

Enfonctionducontexte,larecherchedecorrespondanceentreuneoptionou
unboutonetleraccourciclaviereffectu‚sefaitseloncertainesrŠgles
depriorit‚.Lecasleplussimpleestceluio—unformulaireordinaireest
affich‚.Lemenud‚roulantestalorsinactif.Larecherchesefaitdansle
formulaireseulement.

Silafenˆtredepremierplanestunefenˆtreordinaire,larecherchese
faitdanslemenuuniquement(etsesmenushi‚rarchiques).Sic'estune
fenˆtreavecformulaireoutoolbar,etqueceformulairenecomportepasde
champs‚ditables,larechercheestfaŒteenpriorit‚danslemenu,puis
ellecontinue(sirienn'a‚t‚trouv‚)dansleformulaireoulatoolbarde
lafenˆtre.Sileformulairedelafenˆtrecomporteunouplusieurs
champ(s)‚ditable(s),larechercheestfaŒteuniquementdansleformulaire.
Silafenˆtrecomporteunmenu,c'estcemenu(etsesmenushi‚rarchiques)
€quiontpriorit‚.Larecherchesepoursuitensuitedanslemenuprincipal.
Ilestimpossibled'avoirunefenˆtrecontenant…lafoisunmenu,une
toolbaretunformulaireoutoutecombinaisondeux…deuxdeces‚l‚ments.
BIGnelepermetpas,etcelan'auraitpasgrandint‚rˆt.

DerniermotsurlesobjetsUserDef,…proposdesobjetsB_NICELINE.Ilsne
sontnullementindispensables,maisilsont‚t‚ajout‚s…BIGcarles
objetsnormauxprovoquentunplantageavecl'utilitaireLetThemFly.BIG
transformedoncautomatiquementleslignesdetirets("-")oudesignes
‚gal("=")des‚parationdesmenusenB_NICELINE(l'attributDISABLEDdoit
ˆtremis,‚videmment).

!************************
`!Lesbullesd'aide

Lacr‚ationdesbullesd'aideesttrŠssimple,etleurgestionencours
d'ex‚cutionduprogrammeentiŠrementpriseenchargeparBIG.Lestextes
desbullessontplac‚sdansleressourcedansdeschaŒneslibres.Pour
signalerqu'unobjetpossŠdeunebulle,ilfautpositionnerlebit 14de
sonob_flags(d‚finisouslenom"AIDE_OBJET").Lenum‚rodelachaŒne
libreestcommed'habitudeplac‚dansl'octethautdel'ob_state.Puisque
l'ob_statedesobjetsB_POPUPetB_LISTestd‚j…utilis‚,cenum‚roest
plac‚dansl'ob_state‚tendudel'objet-racineduformulairepop-upreli‚
aubouton.

Lesbullesnepeuventˆtreaffect‚esqu'…desobjetsdeformulaire.Donc,
pasdebullessurlebureau,nidanslesmenus(defenˆtreounon).Les
objetsnepouvantpasrecevoirdebullessont :B_EDIT,B_FRAME,B_GRASTR
etB_FNCP,carl'octethautdeleurob_stateestd‚j…utilis‚(lespop-ups
etpop-listessontdesexceptions).

Lavariableglobale`$"aide_en_ligne"`d‚terminelecomportementdes
bulles.Sisavaleurestdez‚ro(valeurpard‚faut),touteslesbulles
sontd‚sactiv‚es.

Sisavaleurestde-1,lesbullessontautomatiquementactives,et
s'affichentdŠsquelasourispassesurunobjetquienpossŠdeune.

Sisavaleurestpositive,elleestconsid‚r‚ecommerepr‚sentantparun
masquedebitlacombinaisondetouchessp‚ciales(Control,Shift,
Alternate)devantˆtreenfonc‚espourquelesbulless'affichent.C'estpar
exemplelecasdanslad‚mo,o—cettevariablevaut 4,cequicorrespond…
latoucheControl.

Lalongueurmaximumd'untextedebulleestde960caractŠres,cequi
depasselargementlescapacit‚sdes‚diteursderessourcesactuels !

Lafonctionbulle_attach()permetdelierlesboutonsautoris‚s…comporter
unebulled'aide…leurschaŒneslibresdebullesrespectivesaud‚butde
l'ex‚cutionduprogramme,cequiestpluspratiquequedelefairedurant
lacr‚ationduressource.Surtoutquesil'ondoitparlasuiteajouterune
chaŒnelibre,lesnum‚rosdecertainesrisquentd'ˆtred‚cal‚s.Cette
fonctionpositionne‚galementlebitAIDE_OBJETdel'ob_flag.

€!************************
`!Letravailaveclesfenˆtres

BIGprendenchargeunegrandepartiedutravailsurlesfenˆtres.Illes
ouvre,lesferme,lesmanipuleentiŠrement(redraws,d‚filement,
d‚placement,redimensionnement,ic“nisation,etc),etgŠreunequantit‚
"illimit‚e"defenˆtresparapplication.Entendons-nousbien:leGEMne
permetd'afficherqu'unnombrelimit‚defenˆtressimultan‚ment…l'‚cran
(7surlesanciensTOS,davantage…partirdelaversion4).BIGnepeut
franchircettelimite,maisilr‚aliseunegestioninternedesfenˆtresqui
existenttoujoursdanslam‚moireunefoisqu'ellesont‚t‚referm‚essur
l'‚cran.Unlogicielpeutdonctravaillervirtuellementavecdesdizaines
defenˆtres,laseulelimite‚tantlaquantit‚dem‚moiredisponible.

LeprincipedesfenˆtresBIGesttrŠssimple :unefenˆtreGEMordinaire
estcr‚‚eetouverte,maisellenepossŠdeaucunattribut.Danscette
fenˆtreestplac‚un"formulaire-fenˆtre"quiestla"fenˆtreBIG".Ainsi,
denouveauxboutonsont‚t‚ajout‚s,maisl'ensembleestn‚anmoinsduGEM,
sansaucuneastucedeprogrammationauniveaudusystŠmed'exploitation.
Celapermetaussidetravaillerconfortablementenutilisantlesmessages
standardsdel'AES,lalistederectanglespourleredraw,etc,sans
risquerdeconflitsaveclesautresapplicationspr‚sentes.Enconc‚quence
logique,lafonctionGEM`$wind_calc()`devientinutilisablepuisqueles
coordonn‚esdelazonedetravailetcelledelafenˆtresontlesmˆmes
pourGEM !Ilfaut`!OBLIGATOIREMENT`utiliserlafonctionBIG‚quivalente
`$bwind_calc()`.

Demˆme,lapossibilit‚demanipulerlesfenˆtresenarriŠre-planesttrŠs
simplementmiseenplace.Lorsqu'unmessageWM_TOPPEDarrive,BIGagiten
fonctiondel'objetdu"formulaire-fenˆtre"quia‚t‚cliqu‚ :soitilfait
effectivementpasserlafenˆtreenpremierplan,soitilactiveuneautre
fonction,d‚placementparexemple.

Pourlapossibilit‚defairesortirlesfenˆtresparlagauchedel'‚cran,
ilfautˆtreprudent,surtoutlorsdemessagesderedraw.Eneffet,leGEM
partduprincipequ'unefenˆtrenepeutsortirparcec“t‚,etdans
certainessituations,lazone…redessinerpeutcontenirdescoordonn‚esen
'x'n‚gatives !MaisBIGveilleetfaitlen‚cessairepourcorrigerles
valeurslorsquelecassepr‚sente.

LazonedetravaildesfenˆtresBIGn'estpasbˆtementtransparentecomme
celledesfenˆtresGEMclassiques.Donc,plusbesoindecommencerunredraw
parun"blanchissage"decettezone.Ilestmˆmepossibledeluiaffecter
unetrameetunecouleur !Ilestd'ailleurpossibledechangeraussiles
couleursdesboutons,latrameetlacouleurdesascenseurs,dessliders,
etc.Nousenparleronsend‚taildanslechapitredesfonctionsdegestion
desfenˆtres.

LesnouveauxboutonsentraŒnent‚videmmentl'apparitiondenouveaux
attributsdefenˆtre.
`$SMALLER`Boutond'ic“nification.
`$CYCLER`Bouton"fenˆtresuivante".
`$ALLSIZER`LestroisnouveauxSizersenmˆmetemps.Iln'estpaspossible
den'activerquecertainsd'entreeux :c'estlestroisouaucun.Par
contre,leSIZERnormalestind‚pendant.

L'attributNAMEduGEMpeutˆtreutilis‚,maisBIGl'ignore.Quelques
soientlesattributschoisis,lafenˆtreauratoujoursunebarredetitre,
mˆmesiletitrelui-mˆmen'existepas(chaŒnevide),mais…monavisles
fenˆtressanstitresont…‚viter.Parcontre,l'attributMOVERsert…
activerlapossibilit‚ded‚placerlafenˆtre.Sicetattributestabsent,
lafenˆtreauraunebarredetitre,maiscelle-cinepourraˆtreutilis‚e
pourd‚placerlafenˆtre.
€
!************************
`!ConceptdesfenˆtresBIG

SousGEM,oncommenceparcr‚erlafenˆtre(aveclafonction
`$wind_create()`),puisonl'ouvre(`$wind_open()`)pourafficherquelquechose
danssazonedetravail.GEMtient…jourdestableauxdedonn‚esquile
renseignent…n'importequelmomentsurunefenˆtredonn‚e.BIGfaitla
mˆmechose,maissestableauxcontiennentbeaucoupplusd'informations,et
lenombredetableaux(doncdefenˆtres)n'estpaslimit‚.

Pourˆtrepr‚cis,ils'agitd'untableaudestructures.C'estcette
structure'`$BigWind`'quicontienttouteslesinformationsn‚cessaires…la
gestiondesfenˆtresparBIG.Lesroutinesd'initialisationduprogramme
r‚serventdŠsled‚butdel'ex‚cutionunezonem‚moiredelataille
n‚cessairepourlenombredefenˆtresquiserontutilis‚esparle
programme.Desortequenousn'avonsqu'uneseulevariableglobale(nomm‚e
'win'),quiestdelaforme"BigWind*win",c'est-…-dire"pointeursurune
structureBigWind".Apartirdel…,nouspouvonsacc‚der…lastructurede
n'importequellefenˆtrecommes'ils'agissaitd'untableau.Parexemple,
lastructurecontenantlesinformationsrelatives…latroisiŠmefenˆtrese
trouve…l'adresse"win[2]"(puisquelanum‚rotationcommence…0).
Voicicettestructure,lesd‚tailssuivent...

typedefstructBigWind{/*DEFINITIOND'UNEFENETRE*/
intw_hg;/*HandleGEM(ou-1ou0)*/
intw_type;/*TypeBIGdelafenˆtre*/
intw_attr;/*Attributs(wind_create)*/
GRECTw_curr;/*Coordonn‚escourantesdelafenˆtre*/
Oldww_old;/*Coordonn‚esavantic“nification*/
intw_wmini;/*Largeurminimum*/
intw_hmini;/*Hauteurminimum*/
intw_wmaxi;/*Largeurmaximum*/
intw_hmaxi;/*Hauteurmaximum*/
intw_wunit;/*Unit‚ded‚calagehorizontale*/
intw_hunit;/*Unit‚ded‚calageverticale*/
  intw_hprot;/*Nombredepointsprot‚g‚s…gauche*/
  intw_vprot;/*Nombredepointsprot‚g‚senhaut*/
Contw_cont;/*Selonlecontenudelafenˆtre*/
Palette*w_pal;/*Pointeursurlapaletteassoci‚e*/
OBJECT*w_bar;/*Sifenˆtreavecmenuoutoolbar:adressearbre*/
OBJECTw_fen[23];/*Formulairefenˆtre*/
intw_flags;/*Pleineouv.,Clavier,Redraw,Calage,DerniŠre.*/
intw_mouse;/*Formedesourisdanslafenˆtre*/
intw_icon;/*Ic“nification:indexfenˆtreassoci‚e*/
FNCPw_redicn;/*Routinederedrawsifenˆtreic“nifiee*/
  FNCPw_cycle;/*Routinedepassage…lafenˆtresuivante*/
FNCPw_redraw;/*Routinederedrawnormale*/
FNCPw_top;/*Routinedepremierplan*/
FNCPw_close;/*Routinedefermeture*/
FNCPw_move;/*Routinefenˆtredeplac‚e*/
FNCPw_size;/*Routineredimensionnement*/
FNCPw_full;/*Routinepleineouverture*/
FNCPw_hslid;/*Routinesliderhorizontal*/
FNCPw_vslid;/*Routineslidervertical*/
FNCPw_uppage;/*Routinepagehaut*/
FNCPw_dnpage;/*Routinepagebas*/
FNCPw_lfpage;/*Routinepagegauche*/
FNCPw_rtpage;/*Routinepagedroite*/
FNCPw_upline;/*Routinelignehaut*/
FNCPw_dnline;/*Routinelignebas*/
FNCPw_lfline;/*Routinelignegauche*/
FNCPw_rtline;/*Routinelignedroite*/
€char*w_title;/*Pointeursurtitredelafenˆtre*/
char*w_infos;/*Pointeursurinfosdelafenˆtre*/
longw_wtot;/*Largeurmaxicontenufenˆtre*/
longw_htot;/*Hauteurmaxicontenufenˆtre*/
longw_lin;/*1ølignedelafenˆtre*/
longw_col;/*1øcolonnedelafenˆtre*/
}BigWind;

L'‚l‚ment'w_curr'estunesous-structureGRECT,d‚finiecommececiparle
fichierAES.H:
typedefstruct
{
intg_x;/*Coordonn‚eenx*/
intg_y;/*Coordonn‚eeny*/
intg_w;/*Largeur*/
intg_h;/*Hauteur*/
}GRECT;

L'‚l‚ment'w_old'unesous-structureOldw,utilis‚epour"mettredec“t‚"
lescoordonn‚esetlesattributsdelafenˆtrelorsqu'elleestic“nifi‚eou
amen‚e…latailledel'‚cran,afindepouvoirlesrestaurerensuite:
typedefstructoldw{/*DONNEESFENETREICONIFIEE*/
GRECTw_coord;/*Coordonn‚es*/
intw_att;/*Attributs*/
}Oldw;

L'‚l‚ment'w_cont'estuneunion:
typedefunioncont{/*DEFINITIONDUCONTENUD'UNEFENETRE*/
Formw_form;/*Sifenˆtreformulaire*/
MFDBw_img;/*Blocd'informationssiimage*/
char*w_adr;/*Sitexteouautre,adressedonn‚es*/
}Cont;

Cetteunionestelle-mˆmecompos‚ed'unesous-structure:
typedefstructform{/*DEFINITIONFENETREFORMULAIRE*/
OBJECT*w_tree;/*Adressearbre*/
intw_edit;/*Editablecourant*/
intw_pos;/*Positionducurseur*/
char*w_bak;/*Sauvegarde‚tatformulaire*/
}Form;

Ledernier‚l‚mentdel'union,'w_adr',estunsimplepointeursurdes
donn‚es.Silafenˆtrecontientdutexte,ilpourraled‚signer
directement,sinonilpourrapointersurunezoned‚crivantcesdonn‚es.

LetypePaletteestd‚finiainsi:
typedefintPalette[3];

Enfin(ouf!),voicilad‚finitiondutype'FNCP',quisignifie"FuNCtion
Pointer":
typedefvoid(*FNCP)(void);

!************************
`!LastructureBigWind

Voil…lesd‚tailspromis,ladescription‚l‚mentpar‚l‚mentdecette
structure.Touslesnomsd'‚l‚mentscommencentpar'w_'pourles
distinguer.Jevousconseilled'‚viterdedonner…vosvariablesdesnoms
commen‡antparlesmˆmescaractŠres.Pourchaque‚l‚ment,j'indiquela
significationmn‚moniquedesonnom,quisert…s'ensouvenirplus
facilement,ainsiquelavaleurattribu‚e…l'initialisation.

`(intw_hg`"HandleGem".Pouracc‚der…unefenˆtre,BIGutilise
€naturellementlesappelsGEM.Ilestdoncindispensabledeconserver
quelquepartlehandleGEMdecettefenˆtre.Al'initialisation,cet
‚l‚mentcontient'-1'(quiestd‚finisouslelabel'BLANK'danslefichier
BIG.H).Celaindiquequelafenˆtren'ajamais‚t‚ouverte.DŠsqu'elleest
cr‚‚eetouverte,ilcontientlehandleGEMdelafenˆtre.Maislorsqu'elle
estreferm‚e,savaleurn'estpasremise…'-1'mais…'0',cequiindique
qu'ellea‚t‚cr‚‚e,puisd‚truiteparleGEM,maisqu'elleexistetoujours
pourBIG.Lesvaleurscontenuesdanslesautres‚l‚mentsdelastructurene
sontdoncplusdesvaleurspard‚faut,maisellesrepr‚sententles
paramŠtresdelafenˆtre,quientrerontdenouveauenactionsilacr‚ation
decettefenˆtreestdenouveaudemand‚eauGEM.

`(intw_type`"TYPEdelafenˆtre".Ils'agitdutypedupointdevuede
BIG.Ilyaplusieurstypesdebase.Lesvoiciavecleurslabelsde
d‚finitions:
`$WTYP_PICT`(3)Lafenˆtrecontientuneimage.BIGsechargedetout.
`$WTYP_FORM`(2)Lafenˆtrecontientunformulaire.BIGsechargedetout.
`$WTYP_NORM`(1)Lafenˆtreest"normale",ellecontientautrechose,
probablementdutexte.Leprogrammeurdoit‚crirelaroutined'affichage,
BIGsechargedureste.
`$WTYP_TOOL`(0x4000)SaufdanslecasWTYP_FORM(interdit),lequatorziŠme
bitdew_typeindiquequelafenˆtrecontientunetoolbar.
`$WTYP_MENU`(0x8000)SaufdanslecasWTYP_FORM(interdit),lequinziŠmebit
dew_typeindiquequelafenˆtrecontientunmenu.
Unefenˆtrenepeutavoir…lafoisunetoolbaretunmenu.BIGnev‚rifie
pas,maisdonnelapriorit‚aumenu.
Al'initialisation:WTYP_NORMpard‚faut.

`(intw_attr`"ATTRibuts".Ils'agitdesattributsGEMdelafenˆtre
(ascenseurs,barreded‚placement,etc)qu'onindique…lafonction
wind_create().Plusieursjeuxd'attributssontd‚finisparBIGpour
simplifierletravail:
`$WATR_ALLG`(NAME|CLOSER|FULLER|MOVER|INFO|SIZER|UPARROW|
DNARROW|VSLIDE|LFARROW|RTARROW|HSLIDE|SMALLER)Touslesattributs
GEMsontactiv‚s.
`$WATR_ALLB`TouslesattributsBIGsontactiv‚s,c'est-…-direvraimenttous.
`$WATR_CURRG`((NAME|CLOSER|FULLER|MOVER|SIZER|UPARROW|DNARROW|
VSLIDE|LFARROW|RTARROW|HSLIDE|SMALLER))LesattributsGEMlesplus
courammentutilis‚s,c'est-…-diretoussauflaligned'infos.
`$WATR_CURRB`Lesattributslespluscourants,dupointdevuedeBIG,c'est-
…-direenplusdeWATR_CUURG :CYCLERetALLSIZER.
`$WATR_FORMG`(NAME|CLOSER|MOVER|SMALLER)R‚serv‚auxfenˆtres-
formulairesnormalesdetypeGEM(leformulairen'estpasplusgrandque
l'‚cran).Seulslenomdelafenˆtre,leboutondefermeture,labarrede
d‚placementetl'ic“nificationsontactifs.
`$WATR_FORMB`Pareil,maispourBIG,avecenplusleCYCLER.
Al'initialisation:WATR_CURRBpard‚faut.

`(GRECTw_curr`Coordonn‚esetdimensionscourantesdelafenˆtre.Ces
informationssontmises…jour…chaquechangementdetailleou
d'emplacementdelafenˆtre.Al'initialisation:0,0,100,100.

`(Oldww_old`Enregistrementdescoordonn‚esetdesattributsd'unefenˆtre
avantic“nification,afindelesrestitueraumomentdela
d‚sic“nification.

`(intw_wmini,w_hmini`LargeuretHauteurminimumdelazonedetravailde
lafenˆtre.Siontentedeladimensionner…desvaleursinf‚rieures,BIG
corrige.Lecalcultientcomptedelapr‚sence‚ventuelled'unmenuou
d'unetoolbardanslafenˆtre.

`(intw_wmaxi,w_hmaxi`LargeuretHauteurmaximumdelazonedetravailde
lafenˆtre.Siontentedeladimensionner…desvaleurssup‚rieures,BIG
€corrige.Lecalcultientcomptedelapr‚sence‚ventuelled'unmenuou
d'unetoolbardanslafenˆtre.Maisneplacezpasdesobjetsdanscette
toolbarplus…droitequelalargeurmaximumdelafenˆtre !Silafenˆtre
estdetypeimage(WTYP_PICT),lesdimensionsdel'imagedeviennentles
dimensionsmaximumdelafenˆtre.

`(intw_wunit,w_hunit`Unit‚sded‚calagehorizontaleetverticaledela
fenˆtre,enpixels.Lorsd'unclicsurunedesflŠchesded‚filement,le
contenuestd‚cal‚dansladirectiondemand‚edecettevaleur.Pourdu
texte,ceseraitrespectivementlalargeuretlahauteurd'unecellulede
caractŠre.Al'initialisation:1,1.

  `(intw_hprot`et`(intw_vprot`"HorizontalePROTection"et"Verticale
PROTection".Ils'agitdunombredepoints(pixels)quiseront"prot‚g‚s"…
gauche(horizontal)etenhaut(vertical)delazonedetravail.Les
‚v‚nementsded‚placementd'uneligneverslehaut,lebas,lagaucheoula
droiten'affecterontpascettepartiedel'affichage,quiresteainsi
prot‚g‚e.Celapermet,parexemplesionaffichedescolonnes
d'informations,deconserverenhautdelafenˆtrelestitresdeces
colonnesmˆmesionsed‚placeverticalement.Ces‚l‚mentssontfix‚s… 0…
l'initialisation.C'estleprogrammeurquidoit,sin‚cessaire,yplacer
d'autresvaleurs.

`(Contw_cont`"CONTenudelafenˆtre".Fix‚…'0L'lorsde
l'initialisation,cet‚l‚mentestenfaituneunion.Ild‚penddecequi
estaffich‚danslafenˆtre.Voicid‚critles‚l‚mentsdecetteunion:

`(Formw_form`"FORMulaire".Silafenˆtrecontientunformulaire,w_cont
estunestructure'Form',d‚finieparBIG.Envoiciladescription:

`(OBJECT*w_tree`Adresseduformulaire.

`(intw_edit`Sileformulairecontientun(ouplusieurs)champ(s)
‚ditable(s),num‚rod'objetduchampo—setrouvelecurseur.-1sinon.

`(intw_pos`Sileformulairecontientun(ouplusieurs)champ(s)
‚ditable(s),positionducurseurdanslechampcourant.-1sinon.

`(char*w_bak`BIGestenmesuredeg‚rerlesboutons'Confirme','Annule',
'Applique'et'R.A.Z.'desformulaires,enrestaurantl'‚tatduformulaire
encasd'annulationouremise…z‚ro.Cepointeurindiquelazonede
sauvegardedel'‚tatduformulaire.

Suitedel'union'Cont':
`(MFDBw_img`"IMaGe".Silafenˆtrecontientuneimage,w_contestun
'MFDB'.LeMFDB(MemoryFormDefinitionBlock)estunestructure
standardis‚edelaVDI,quicontienttouteslesinformationsn‚cessaires…
lagestiond'uneimage(sonadresse,sesdimensions,etc).Grƒce…cette
standardisation,BIGpeuts'occuperint‚gralementdel'affichagedel'image
danslafenˆtre,sansinterventionduprogrammelui-mˆme.

Suitedel'union'Cont':
`(char*w_adr`Silafenˆtrenecontientniuneimage,niunformulaire
(ellecontientalorsprobablementdutexteouungraphismecalcul‚),cet
‚l‚mentestunpointeursurcharquiindiqueled‚butdelazonem‚moireo—
sontstock‚eslesdonn‚es(letexte).Laroutined'affichagedecette
fenˆtrepourraalorslestrouverdirectement,quelquesoitlafenˆtre
courante.

Revenons…lastructureprincipale:
`(Palette*w_pal`"PALette".Cet‚l‚mentestunpointeursurunezoneden
fois3int,'n'‚tantlenombredecouleursaffichables.Chacundes3mots
d‚finilesvaleursderouge,vertetbleudelacouleur.Ainsi,ilest
€possibled'associerunepalettedecouleur…chaquefenˆtre.Celaest
presqueindispensablepourlesfenˆtred'images,maispeuts'av‚rerutile
pourd'aurtesfenˆtres.Sicet‚l‚mentpointesurZERO,BIGactivela
palettepard‚faut.PointesurZERO…l'initialisation.

`(OBJECT*w_bar`"BARre".Silafenˆtrecontientunebarredemenuouune
toolbar,adressedel'arbredecemenu.

`(OBJECTw_fen[23]`"FENˆtre".C'estdanscettezonede23strcturesOBJECT
quele"formulaire-fenˆtre"desfenˆtresBIGestcopi‚.Eneffet,ilest
constitu‚de23objets,etchaquefenˆtrepossŠdelesien,avecles
caract‚ristiquesquisonpropres…cettefenˆtre(parexemple,certains
objetspourrontˆtrecach‚ssilafenˆtrenepossŠdepasl'attribut
correspondant).Normalement,leprogrammeurn'apasbesoindemodifierni
mˆmedelirelesinformationsplac‚esdanscet‚l‚mentdeBigWind.Les
fonctionsdeBIGs'occupentdetout,certainessontjustementdestin‚es…
modifierlesdonn‚esdecet‚l‚ment(lacouleurd'unobjet,parexemple).

`(intw_flags`Cet‚l‚mentestunmasquedebits.Voicisadescription:
`$Bit0:WFFULL(WindowflagFULL)
`$Bit1:WFARROW(WindowFlagARROW)
`$Bit2:WFCALAG(WindowFlagCALAGe)
`$Bit3:WFDECAL(WindowFlagDECALage
`$Bit4:WFGROUP(WindowFlagGROUPementflŠches)
`$Bit5:r‚serv‚
`$Bit6:r‚serv‚
`$Bit7:WLAST(WindowLAST)
L'octetdefaiblepoidsdecemotestentiŠrementutilis‚our‚serv‚pour
d'‚ventuellesextensionsfuturesdeBIG.Parcontre,l'octetdepoidsfort
n'estpasutilis‚,nimˆmetest‚.Vousˆtesdonclibredel'utiliser…
votreguisesilesfenˆtresdevotreprogrammeontbesoind'autresflags.

`$WFFULL` :Lepremierbitestmissilafenˆtreaactuellementsataille
maximum(pleineouverture).
`$WFARROW` :Lesecondestmissilafenˆtredoitˆtremanipulable…partirdu
clavier.Lestouchesfl‚ch‚escorrespondentauxflŠchesdelafenˆtres,et
les<Shift +flŠche>correspondentauxascenseurs.<Esc>ouvrelafenˆtre…
sataillemaximumoucelledel'‚cran,oularamŠne…sataillepr‚c‚dente.
Enoutre,silafenˆtreestdetypeWTYP_NORM,<Clr>amŠnel'affichagesur
lapremiŠreligneet<Shift +Clr>surladerniŠre(moinslahauteurdela
fenˆtre).
`$WFCALAG` :LetroisiŠmeindiquequelalargeuretlahauteurdelazonede
travaildelafenˆtredoiventtoujoursˆtredesmultiplesdesunit‚sde
d‚calage.Demˆmepourlepositionnementducontenudelafenˆtrelorsd'un
‚v‚nementSlider.
`$WFDECAL` :LequatriŠmeestrendun‚cessaireparlapr‚sencedesnouveaux
Sizers.S'iln'estpasmis,lapartieducontenuaffich‚e…partirde
l'anglesup‚rieurgauchedelazonedetravaildelafenˆtreneserapas
modifi‚e,mˆmeencasderedimensionnementparleSizerHautGauche.Sile
bitestmis,lapartieaffich‚eseraeventuellementactualis‚e.Par
exemple,sivousr‚duisezlahauteurdelafenˆtrede50 pixelsaumoyendu
SizerHautDroit,lecontenudelafenˆtreresteraaumˆmeemplacement
"virtuel",etdoncl'affichagecommencera50 pixelsplusbas.Silebit
n'estpasmis,l'affichagecommenceratoujoursaumˆmeendroit.
`$WFGROUP` :Sicebitestpositionn‚,lesquatreflŠchesdelafenˆtreseront
group‚esdansl'angleinf‚rieurdroit.CeflagnedoisJAMAISˆtremispour
unefenˆtreformulaire.
Lesdeuxbitssuivantssontpourl'instantinutilis‚s.Quantaubit7,il
estutilis‚parBIGpoursavoirsilafenˆtreestladerniŠredecellesqui
ont‚t‚d‚clar‚es(nemodifiezJAMAIScebit).Al'initialisation:WFARROW
seulement.

`(intw_mouse`Sicet‚l‚mentest‚gal…z‚ro(valeur…l'initialisation),
€lasourisauratoujourslatraditionnelleformedeflŠche.Sinon,lavaleur
estinterpr‚t‚ecommelenum‚roAESdelaformequelasourisdoitprendre
danslazonedetravaildelafenˆtre(lorsquelafenˆtreestaupremier
plan).

`(intw_icon`Silafenˆtreestnormale,cet‚l‚mentcontient'-1'.Sielle
estic“nifi‚e,ilcontientl'indexBIGdelafenˆtreassoci‚e.Cela
signifiequesiellea‚t‚ic“nifi‚eseule,c'estsonpropreindex,maissi
ellefaitpartied'ungroupedefenˆtresiconifi‚esenuneseule,c'est
l'indexdelafenˆtreprincipale,cellequia‚t‚effectivementic“nifi‚e,
lesautres‚tantenr‚alit‚provisoirementd‚truites.Lorsdela
d‚sic“nification,BIGchercheratouteslesfenˆtresactuellementferm‚es
dontcet‚l‚mentestl'indexdecelledontondemandelad‚sic“nification,
etillesrouvrira.

Viennent…pr‚sentunes‚riedepointeurssurfonctionsquivontnous
permettreded‚terminercommentlafenˆtrevar‚agirdanslesdiff‚rents
casd'‚v‚nements,etcelaautomatiquement.Nousverronsplusloincomment
affecterunefonction…unpointeur.

`(FNCPw_redicn`"REDrawICoN"Pointeursuruneroutineder‚affichagedu
contenudelafenˆtrequiestutilis‚euniquementsilafenˆtreest
ic“nifi‚e.S'ilcontient0L,c'estlaroutinenormale(voir‚l‚ment
suivant)quiestutilis‚e.Al'initialisation,0L.

`(FNCPw_cycle`Pointeursurlaroutinedepassageaupremierplandela
fenˆtresuivante.Al'initialisation,ilpointesurlafonction
'next_wind()'.

`(FNCPw_redraw`Pointeursurlaroutineder‚affichageducontenudela
fenˆtre.Al'initialisation,0L.Cepointeurn'estn‚cessairequesila
fenˆtrecontientautrechosequ'uneimageouunformulaire,cardansces
casBIGsechargeduredraw.S'ilyadeszones"prot‚g‚es"enhautou…
gauchedel'affichage(oulesdeux),ilfautentenircomptedansla
routine.Elledoitafficherlecontenudelaoudeszone(s)prot‚g‚es
ind‚pendammentdel'affichagelui-mˆme.

`(FNCPw_close`Pointeursurlaroutinedefermeturedelafenˆtre.A
l'initialisation,ilpointesurlafonction'closed()'quifermelafenˆtre
etdemandeauGEMd'oubliersonexistence(maisBIGaplusdem‚moire).
Toutefois,ilfaudradanscertainscasqueleprogrammeur‚crivecette
fonctionafindelib‚rersin‚cessairelazonem‚moireoccup‚eparexemple
parletextedelafenˆtre.

`(FNCPw_move`PointeursuruneroutinequiinformeleGEMquelafenˆtrea
‚t‚d‚plac‚e,etquienregistresesnouvellescoordonn‚es.Pointe…
l'initialisationsurlafonction'moved()'.

`(FNCPw_size`PointeursuruneroutinequiinformeleGEMquelafenˆtrea
‚t‚redimensionn‚e,etquienregistresesnouvellescoordonn‚es.Pointe…
l'initialisationsurlafonction'sized()'(ou'size_form()'danslecas
d'unefenˆtreformulaire).Voyezdanslechapitredelavisiteguid‚ece
quia‚t‚dit…proposdelafenˆtred'histogrammes.

`(FNCPw_full`Pointeursurlafonctionquidonne…lafenˆtreses
dimensionsmaximales,oularamŠneauxpr‚c‚dentessielleestd‚j…au
maximum.Cettetaillemaximumest‚ventuellementlimit‚edanslecasd'une
fenˆtreimageouformulaireauxdimensionsdecetteimageoudece
formulaire.Lesnouvellescoordonn‚essonttransmisesauGEM.A
l'initialisation,pointesurlafonction'fulled()'(ou'full_form()'dans
lecasd'unefenˆtreformulaire).

`(FNCPw_hslid,w_vslid`"HorizontalSLIDer"et"VerticalSLIDer"Pointeurs
€surlesfonctions…ex‚cuterencasded‚placementd'unslider(horizontal
ouvertical)lelongdel'ascenceurcorrespondant.Lafonctioneffectueles
testsn‚cessaires,transmetl'informationauGEMetl'enregistre.A
l'initialisation,pointentrespectivementsur'hslid()'et'vslid()'.

`(FNCPw_uppage,w_dnpage,w_lfpage,w_rtpage`"UPPAGE","DowNPAGE","LeFt
PAGE"et"RighTPAGE".Pointeurssurlesfonctions…ex‚cuterencas
d'‚v‚nementd'ascenceur,c'est-…-direunedemandeded‚filementparpage
verslehaut,lebas,lagaucheouladroite.Lafonctioneffectueles
testsn‚cessaires,transmetl'informationauGEMetl'enregistre.A
l'initialisation,pointentrespectivementsur'uppage()','dnpage()',
'lfpage()'et'rtpage()'.Cesfonctionsd‚placentlecontenudelafenˆtre
delahauteuroudelalargeur(selonlecas)delafenˆtre,oumoinssion
est"aubout"del'affichage.

`(FNCPw_upline,w_dnline,w_lfline,w_rtline`"UPLINE","DowNLINE",
"LeFtLINE"et"RighTLINE".Pointeurssurlesfonctions…ex‚cuterencas
d'‚v‚nementdeflŠches,c'est-…-direunedemandeded‚filementparligne
verslehaut,lebas,lagaucheouladroite.Lafonctioneffectueles
testsn‚cessaires,transmetl'informationauGEMetl'enregistre.A
l'initialisation,pointentrespectivementsur'upline()','dnline()',
'lfline()'et'rtline()'.Cesfonctionsd‚placentlecontenudelafenˆtre
delahauteuroudelalargeur(selonlecas)del'unit‚ded‚placement
not‚dansles‚l‚ments'w_wunit'et'w_hunit'.

  `(char*w_title`PointeursurlachaŒnedetitredelafenˆtre.0…
l'initialisation.

`(char*w_infos`PointeursurlachaŒnedeligned'infosdelafenˆtre.0…
l'initialisation.

  `(longw_wtot,w_htot`"WidthTOTal"et"HeightTOTal".Ces‚l‚ments
contiennentrespectivementlalargeuretlahauteurtotaledelafenˆtre,
enpixels.Pouruneimage,celacorrespondauxdimensionsdecetteimage.
Pourdutexte,lalargeurrepr‚senteraitlenombremaximumdecaractŠres
d'unelignemultipli‚parlalargeurd'unecelluledecaractŠre.Lahauteur
seraitlenombredelignesmultipli‚parlahauteurd'unecellulede
caractŠre.0…l'initialisation.

  `(longw_lin,w_col`"LIGne"et"COLonne".Repr‚sentent(enpixels)les
premiŠresligneetcolonne…afficherdanslecoinsup‚rieurgauchedela
zonedetravaildelafenˆtre,parrapportaucontenutotal(w_wtotet
w_htot).0…l'initialisation.

!************************
`!Leformulaire-fenˆtre

Pourlescurieux,voiciunedescriptionsuccinteduformulairefenˆtre.Il
comporte23objetsdontlesnoms(internes…BIG)commencentpar'BW_'
commeBigWindow.Certainssontappel‚s"Gadgets"etsontd‚critsaprŠsla
liste.

`$BW_BKGR`"BacKGRound"L'objet-racine.Ilesttransform‚parBIGenG_USERDEF
etsaroutinededessintraceunsimplerectangleblancopaquesanscadre.
`$BW_SIZERUL`"SIZERUpLeft"UnSizer.Gadget.
`$BW_CLOSER`Boutondefermeture.Gadget.
`$BW_MOVER`Barredetitreetd‚placement.Transform‚eenG_USERDEF.
`$BW_SMALLER`Boutond'ic“nification.Gadget.
`$BW_CYCLER` Passage…lafenˆtresuivante.Gadget.
`$BW_FULLER` Boutondepleineouvertureetretourtaillepr‚c‚dente.Gadget.
`$BW_SIZERUR` "SIZERUpRight"UnSizer.Gadget.
`$BW_INFO`Ligned'info.Transform‚eenG_USERDEF.
`$BW_BARRE` Utilis‚internementpourpositionnerlemenuoulatoolbars'ily
€ena(invisiblesinon).
`$BW_VBAR` Contienttousles‚l‚mentsdel'ascenseurvertical.
`$BW_UPARROW` FlŠcheverslehaut.Gadget.
`$BW_VELEV` Ascenseurvertical.
`$BW_VSLIDE` Slidervertical.Transform‚enG_USERDEF.
`$BW_DNARROW` FlŠcheverslebas.Gadget.
`$BW_SIZERDL` "SIZERDownLeft"UnSizer.Gadget.
`$BW_HBAR Contienttousles‚l‚mentsdel'ascenseurhorizontal.
`$BW_LFARROW` FlŠcheverslagauche.Gadget.
`$BW_HELEV` Ascenseurhorizontal.
`$BW_HSLIDE` Sliderhorizontal.Transform‚enG_USERDEF.
`$BW_RTARROW` FlŠcheversladroite.Gadget.
`$BW_SIZERDR` "SIZERDownRight"UnSizer.Gadget.
`$BW_WORK` Zonedetravail.Transform‚eenG_USERDEF,elleestTOUJOURS
opaque.

Les"gadgets"sontlesboutonsdelafenˆtre.Ilsontconstitu‚sd'un
rectangle,d'unepetiteic“neetd'uneligned'ombre.L'emplacementde
cetteligneetled‚calaged'unpixeldel'imagedonnentl'impressionque
leboutons'enfoncelorsqu'ilests‚lectionn‚.Celaestvalableaussipour
lesdeuxsliders.

PlusieursparamŠtrespeuventˆtremodifi‚s,parexemplelescouleursde
trameetdetexte,etc.Voyezlesfonctions`$set_windows()`et
`$set_work()`pourplusded‚tails.

€!************************
`!LesfonctionsdeBIG

BIGmet‚videmment…votredispositiondesfonctions.Dupointdevuedu
d‚veloppeur,cesfonctionspeuventˆtrer‚partiesendeuxgroupes:celles
queleprogrammeurappelle…partirdulogicielqu'ilestentrainde
d‚velopper,etcellesqueBIGappellent"eninterne".Danscette
documentation,jened‚criraiquelesfonctionsdupremiergroupe.

!************************
`!Les‚v‚nements

PourquelesfonctionsdeBIGcommuniquentavecleGEMetavecles
fonctionsduprogrammeprincipal,denouveauxtypesd'‚v‚nementssont
utilis‚s.Letyped'‚v‚nementestplac‚dansl'‚l‚ment0dubuffer
d'‚v‚nement,quiestuntableaud'entiers.Ilpeutdoncprendredesvaleurs
de0…65535.GEMn'utilisequ'unetrentainedecesvaleurs,desorteque
lesautressontdisponibles.CertainssystŠmes(commeleTubeGEM)se
r‚serventd‚j…destypesd'‚v‚nements‚tendus.Lesnouveaux‚v‚nementsde
BIGsontbienentendusdiff‚rentsdetouslesautresdontj'ai
connaissance.

Danstouslescas,ces‚v‚nementsrespectentlemodŠleGEM,c'est-…-direle
typedansl'‚l‚ment0dubuffer,l'identificateurdudestinatairedans
l'‚l‚ment1,et'0'dansl'‚l‚ment2,puisqu'aucundeces‚v‚nementsne
comportedesurplusd'information.Les‚l‚mentssuivantscontiennentdes
informationsd‚pendantesdutypedemessage.

`$BEV_HIERM(BigEVentHIERarchicalMenu)
Uneoptiondemenuhi‚rarchiquedumenuprincipala‚t‚s‚lectionn‚e.Le
programmere‡oitun‚v‚nementMU_MESAG.
Mot0:BEV_HIERM(150).
Mot3:Num‚rodutitredumenuprincipal.
Mot4:Num‚rodel'optiondumenuprincipal.
Mot5:Num‚rodansleressourcedel'arbresous-menu.
Mot6:Num‚rodel'objetcliqu‚danscetarbre.

`$BEV_FREEPU(BigEVentFREEPop-Up)
Uneoptiondepop-uplibrea‚t‚s‚lectionn‚e.Leprogrammere‡oitun
‚v‚nementMU_BUTTON.
Mot0:BEV_FREEPU(151).
Mot3:Num‚rodel'arbrepop-up.
Mot4:Num‚rodel'objetcliqu‚danscetarbre.

`$BEV_WFORM(BigEVentWindowFORMulaire)
UnobjetEXITdeformulaireenfenˆtrea‚t‚cliqu‚.Leprogrammere‡oitun
‚v‚nementMU_BUTTON.
Mot0:BEV_WFORM(152).
Mot3:IndexBIGdelafenˆtreformulaire.
Mot4:Num‚rodel'objetcliqu‚.

`$BEV_WMENU(BigEVentWindowMENU)
Uneoptiondemenuenfenˆtrea‚t‚s‚lectionn‚e.Leprogrammere‡oitun
‚v‚nementMU_BUTTON.
Mot0:BEV_WMENU(153).
Mot3:Num‚rodutitredemenu.
Mot4:Num‚rodel'optioncliqu‚e.
Mot5:IndexBIGdelafenˆtrecontenantlemenu.

`$BEV_WHIER(BigEVentWindowHIERarchicalmenu)
Uneoptiondemenuhi‚rarchiquedemenuenfenˆtrea‚t‚s‚lectionn‚e.Le
programmere‡oitun‚v‚nementMU_BUTTON.
Mot0:BEV_WHIER(154).
€Mot3:Num‚rodutitredemenu.
Mot4:Num‚rodel'optionquiaappel‚lesous-menu.
Mot5:Num‚rodansleressourcedel'arbresous-menu.
Mot6:Num‚rodel'objetcliqu‚danscetarbre.
Mot7:IndexBIGdelafenˆtrecontenantlemenu.

`$BEV_TOOL(BigEVentTOOLbar)
Unobjetdetoolbard'unefenˆtrea‚t‚cliqu‚.Leprogrammere‡oitun
‚v‚nementMU_BUTTON.
Mot0:BEV_TOOL(155).
Mot3:IndexBIGdelafenˆtrecontenantlatoolbar.
Mot4:Num‚rodel'objetcliqu‚.

D'autrepart,lorsd'‚v‚nementsseproduisantsurunefenˆtre,BIGretourne
auprogrammelemessageGEMcorrespondant.Parexemple,siond‚placeune
fenˆtreBIG,leGEMneg‚nŠrepasdemessageWM_MOVED,puisquecesontles
routinesdeBIGquieffectuentled‚placement.MaisBIGsimuleunmessage
entoutpointsemblableetleretourne.ainsi,leprogrammeestinform‚de
toutcequisepasse.

Ilyadanscedomainede"nouveaux"messagesdestin‚s…simulerceuxdu
GEM...maisleGEMenestd‚pourvu.Lesvoici :

`$WM_CYCLED(38)Cyclagedefenˆtre.
Mot 3 :HandleGEMdelafenˆtrequiad‚clench‚lecyclage.
Mot 4 :HandleGEMdelanouvellefenˆtredepremierplan.
LemessageWM_BOTTOM(33)desversionsr‚centesdel'AESestsousBIG
‚quivalent…WM_CYCLED.

`$WM_ICONIFY(34),WM_UNICONIFY(35)etWM_ALLICONIFY(36)`sonttousles
troisimpl‚ment‚sseulementdanslesderniŠresversionsdel'AES.
Toutefois,onpeutlesutilisersousBIGdansn'importequelle
configuration.
Mot 3 :HandleGEMdelafenˆtreconcern‚e.

TouslesmessagesdetypeGEM(WM_xxx)sontdoncretourn‚sparBIG…
l'application,maisinversement,ilspeuventtousˆtreenvoy‚spar
l'application,aumoyendelafonction`$send_mesag()`.

Laseulerestrictionconcernel'envoiedesmessagesWM_HSLIDetWM_VSLID :
Sil'applicationenvoieundecesmessages,lapositionduslider
correspondantneserapasmodifi‚e.Cettemodificationdoitˆtrefaite
auparaventparleprogramme.Parcontre,lesvaleursdew_linetw_colsont
actualis‚es.

!************************
`!Leressourceinclus

BIGpossŠdeunressourceint‚gr‚quiluiestpropre.Iln'estpas
incompatiblequeleprogrammelui-mˆmeaitsonressource(externeounon)
etqueBIGajoutequelquesarbresint‚gr‚s.Ceressourceinclusfaisant
partieduprogrammelui-mˆme,ilseraquelquepartenm‚moire.Ilsuffitde
savoiro—pourtransmettrelesadressesn‚cessairesauxfonctionsquien
ontbesoin.L'utilisationparBIGdeceressourceinclusestentiŠrement
automatis‚e.Vousn'avezpas…vousenpr‚occuper.

RappelonsqueBIGpeuttravaillerdelamˆmemaniŠreavecunRSCexterneet
uninterne.Reportez-vousauchapitre"`$Travailavecunressourceint‚gr‚`"
pourensavoirplus.

Ceressourceincluscompte8formulaires,2alerteslibreset1chaŒne
libre.LepremierformulaireestlaboŒted'alerted‚pla‡ablequiest
modif‚etutilis‚parl'appeldelafonction"big_alert()".Leformulaire
€suivantcontientlesic“nesd'alerte(BIGoffre9motifsd'ic“nesaulieu
des3habituels).LetroisiŠmecontientlesdeuxflŠchesded‚filementdes
menusenfenˆtre.LequatriŠmecontientlesG_ICONsutilis‚espourle
dessindesB_RADIOs,desB_COCHEsetdubouton"optionsuivante"despop-
upsetpop-lists.LesuivantcontientlaG_BOXetlesdeuxflˆches
utilis‚espourlaconstructiondesscroll-menus.Lesuivantcontientle
formulaireservant…cr‚erlespop-listes.L'avant-dernierestle
formulaire-fenˆtrelui-mˆmeetlederniercontienttouteslespetites
ic“nesdesboutonsdefenˆtre.

Quantauxalertes,lapremiŠreestcellequiestutilis‚epoursignalerque
leressource(externe)n'apas‚t‚trouv‚pourˆtrecharg‚,etlaseconde
informel'utilisateurqu'ilestimpossibled'ouvrirunenouvellefenˆtre.

LachaŒnelibre,pourfinir,contientletextequiestaffich‚sil'on
tentedelancerunprogrammesousBIG(doncsousGEM)…partirdudossier
AUTO.

!************************
`!Lesvariablesglobales

BIGtravailleavecquelquesvariablesglobales,quisontdoncaccessibles
auprogrammelui-mˆme.Leurnombrea‚t‚limit‚aumaximum,maistoutefois
certainescontraintessont…respecter.J'aipr‚f‚r‚proc‚derainsi,plut“t
qued'alourdirletravaildecertainesfonctionsparuneincessante
passationdepointeurs,pastoujoursfacile…suivreet…comprendre.
Voiciunepr‚sentationsuccintedecesvariablesglobales.Nousverronsles
d‚tailsaveclesfonctions.

`$intap_id;`IdentificateurAESdel'application.

`$intbuf[8];`Bufferd'‚v‚nements.

`$intmx,my,mk;`Positiondelasouriset‚tatdesboutons.

`$intedit,pos;`Editablecourant,positionducurseurdanscet‚ditable.

`$intobject;`Objetcliqu‚lorsd'un‚v‚nementMU_BUTTON.

`$intkbd,key,clik;`Etatcourantdestouchesd'‚tat(Control,Shift...),
‚v‚nementclaviercourant,nombredeclicssouris.

`$intwind;`HandleGEMdelafenˆtrecliqu‚e(sileclicaeulieudansla
zonedetravail).

`$intintgr;`"INT‚gR‚"FlagquivautTRUEsileressourceestint‚gr‚,FALSE
s'ilestexterne.

`$char*pathapp;`Cheminpard‚fautdel'application,c'est-…-direle
chemind'o—ellea‚t‚lanc‚e.

`$OBJECT*adr_menu,*adr_desk;`Nomsr‚serv‚spourlesadressesdes
formulairesMenuetBureauduprogramme(inutilis‚essil'applicationest
unaccessoire,facultatifssic'estunprogramme).

`$OBJECT**ir_trindex;`PointeursurpointeurdestructuresOBJECT.Il
s'utilisedonccommeuntableaudestructures.Cepseudo-tableaucontient
touteslesadressesdetouslesformulairesduressource,quecelui-cisoit
int‚gr‚ouexterne.L'adresseduformulaire'FORM's'obtientparexemple
par"ir_trindex[FORM]".L'utilisationdelafonctionGEMrsrc_gaddr()est
doncinutile.

`$intcliq_in;`Cettevariableestutilis‚econjointementaveclespop_ups,
€lespop-listesetleshi‚rarchiques.Siuneoptiona‚t‚effectivement
choisie,cettevariableestTRUE,sinonFALSE.

`$GRECTzclip;`(ZoneCLIPping)Lorsd'unmessagederedraw,lesrectangle
delalistesontdessin‚sunparun.Silafenˆtreestdetype"normal",la
fonctionpoint‚eparl'‚l‚mentw_redrawestappel‚…chaquefois.Avantcet
appel,lescoordonn‚esdelazoneclipp‚e(donc…redessiner)sontplac‚es
danscettevariables.Sicelas'avŠren‚cessairepouroptimiserlavitesse
d'affichage,led‚veloppeurpeutneredessinerquecequisetrouve
effectivementdanslazone(particuliŠrementavecunsoftdegraphisme
vectoriel,parexemple).

`$FNCP*fnc;`Adressedelazonedespointeursdefonctionli‚saux
objets.

`$BigWind*win;`Adressedelazonedesfenˆtres(structuresBigWind).

`$intaide_en_ligne;`Comportementdesbullesd'aide.0 :jamais ;-1 :
toujours ;autre :masquedebitdestouchessp‚ciales.

`$t_ident_hard_softdesc_hard_soft;`Informationsconcernantlehardware.
Cesinformationssontcontenuesdansunestructuret_ident_hard_soft,ainsi
d‚finie:
`$typedefstruct
`${
`$t_machinela_machine;
`$t_proc_graphiqueproc_graphique;
`$t_cpule_cpu;
`$intv_aes;
`$intv_tos;
`$charmultitache;
`$ type_gdosle_gdos;
`$}t_ident_hard_soft;
Voiciled‚taildeses‚l‚ments:
t_machinela_machineLetypedemachine.
t_proc_graphiqueproc_graphiqueLeprocesseurgraphique.
t_cpule_cpuLemicro-processeurcentral.
intv_aesLaversiondel'AES.Leplussimpleestdelatesteren
hexad‚cimal,commeparexemple"if(desc_hard_soft.v_aes==0x410)",car
celasignifie"version4.10"!
intv_tosLaversionduTOS.Mˆmeremarquequepourl'AES.
charmultitacheFlagquivautTRUEsionestsousenvironnementmultitƒche,
FALSEsinon.
type_gdosle_gdosVariable‚num‚r‚epr‚cisantleGDOSinstall‚.Voyezle
d‚taildecette‚num‚rationdanslechapitredesd‚finitions.

t_displaywork_displayInformationconcernantl'affichage.Ellessont
contenuedansunestructuret_display,quevoici:
`$typedefstructt_display
`${
`$size_ttaille;`/*Tailled'un‚cran*/
`$size_ttaille_ligne;`/*Longueurd'uneligneenoctets*/
`$inthandle;`/*HandleVDIstationdetravail*/
`$intw;`/*Largeurdel'‚cran*/
`$inth;`/*Hauteurdel'‚cran*/
`$inthc;`/*TailledescaractŠresdebaselineatopline*/
`$t_resolutionres;`/*R‚solutioncourante,priseaud‚marrage*/
`$intmode;`/*LemodecourantsionestsurFalcon*/
`$charune_palette;`/*FALSE:pasdepalette,TRUE:unepalette*/
`$longn_color_pal;`/*NombredecouleursdelapaletteoudusystŠme*/
`$longn_color;`/*Nombredepinceauxdisponiblessimultan‚ments*/
`$intn_plane;`/*Profondeurdel'‚cran,ennbredeplans*/
`$Palette*palette;`/*Pointeurverslasauvegardedesfeutres*/
€`$intnb_bit_coul[3];`/*Nombredebitsparcouleur*/
`$intmasque_coul[3];`/*Masquepourlescouleurs*/
`$void*phys;`/*Adressephysiquedel'‚cranaulancement*/
`$void*log;`/*Adresselogiquedel'‚cranaulancement*/
`$}t_display;
Voicilesd‚tails:
size_ttailleTailleenoctetdel'‚cran.
size_ttaille_ligneTailleenoctetsd'unelignedepixels.
inthandleHandledelastationdetravailvirtuelleVDI.
intwLargeurdetoutl'‚cranenpixels.
inthHauteurdetoutl'‚cran,enpixels.
inthcHauteurstandarddescaractŠres"normaux",delabaseline…la
topline.
t_resolutionresLar‚solution,puisquelafonctionGetrez()nesignifie
plusgrand-chosesurFalcon.
intmodeLemodecourantsiontravaillesurFalcon.Ils'agitd'unmasque
debitsd‚crivantlemodevid‚o.Voicilesd‚tails:
Bits0…2:Bitsparpixels.0=1bps;1=2bps;2=4bps;
3 = 8 bps ;4=16bps.
Bit3:Flag80colonnes(40s'iln'estpasmis).
Bit4:FlagVGA(modeTVs'iln'estpasmis).
Bit5:FlagPALouNTSCs'iln'estpasmis.
Bit6:FlagOverscan.Multipliexetypar1.2(inutilis‚enVGA).
Bit7:Flagdecompatibilit‚ST.
Bit8:Flagvertical.Modeentrelac‚sur‚cranscouleur,doubleligneen
VGA.
Bits9…15:R‚serv‚s.
charune_paletteS'iln'yapasdepalette(NearTrueColorouTrueColor),
FALSE.TRUEsinon.
longn_color_palNombredecouleursaffichablessimultan‚ment.
long_n_colorNombredepinceauxdisponibles.
intn_planeNombredeplansdecouleurs.
Palette*palettePointeursurlasauvegardedelapalettepard‚faut(celle
quiestactiveaulancementduprogramme).Letype"Palette"estd‚fini
commececi:"typedefintPalette[3];",ilestdoncadapt‚auformatVDIde
descriptiondespalettesdecouleurs.BIGr‚serveunezonem‚moired‚sign‚e
par"palette"etd'unetaillesuffisante:
palette=(Palette*)malloc(n_color*sizeof(Palette));
intnb_bit_coul[3]Nombredebitsparcouleur.
intmasque_coul[3]Masquepourlescouleurs.
void*physAdressedel'‚cranphysiqueaulancementduprogramme.
void*logAdressedel'‚cranlogiqueaulancementduprogramme.
Cesstructuresutilisentdesd‚finitionsquiserontpr‚sent‚esau
paragraphesuivant.

Enfin,lescoordonn‚esdubureausontplac‚esdansunestructure
t_desktop :
`$t_desktopbureau;`/*Coordonn‚esdubureau*/
`$typedefstructt_desktop
`${
`$intxd,yd,wd,hd;`/*'d'pour"Desk"*/
`$}t_desktop;

!************************
`!Lesd‚finitions

Pourfaciliterlaprogrammation,BIGpropose(etutilise)desd‚finitions
(#define)nombreuses.Envoicilaliste,aveclatraductionmn‚monique
(lorsquec'estn‚cessaire).

`$FALSE,TRUERespectivement'0'et'1'`,ilssontutilis‚sdanslestests.De
grandsclassiques.

€`$NOT(!)`Plusfacilementlisibledansunlistingquelepointd'exclamation
trop‚troit.

`$BLANK(-1)`TrŠsutilis‚parBIG,Cettevaleurestsouventtransmise…une
fonctionpourluiindiquerqu'elledoitignorerounepastraiterles
chosesrelatives…ceparamŠtre.Parexemple,s'iln'yapasdechamp
‚ditabledansunformulaire,leparamŠtretransmispourlavariable'edit'
est'BLANK'.

`$ZERO(0)`Pluslisiblequelechiffre0.Attention…nepasconfondrecette
d‚finitionavec'NULL',d‚finieparSTDDEF.H,cenesontpaslesmˆmesdu
tout.

`$MAX_ALRT(250)`"MAXimumALeRTe".Taillemaximumpossibled'unechaŒne
d'alerte.Enfait,c'estunpeumoinsquecela.

`$BIT15(0x8000)`Le15øbitd'unintestpositionn‚danscertainscas,par
exemplelorsd'undouble-clic.

`$max((A,B)((A)>(B)?(A):(B)))`Macroquiretournelavaleurlaplus
‚lev‚eentredeux.

`$min((A,B)((A)<(B)?(A):(B)))`Macroquiretournelavaleurlamoins
‚lev‚eentredeux.

`$B_MOVE,B_SELEC,B_GRASTR,B_FRAME,B_HELP,B_EDIT,B_UNDO,B_UNDER,
`$B_POPUP,B_LIST,B_PICT,B_HIERM,B_FNCP`Types‚tendusd'objetsUserDef.
Voirlechapitre"Lesnouveauxtypesd'objets".

`$DLG_DESK((MU_KEYBD|MU_BUTTON|MU_M1|MU_MESAG|MU_TIMER))`"DiaLoGue
DESK"
`$DLG_FORM((MU_KEYBD|MU_BUTTON|MU_TIMER))`"DiaLoGueFORMulaire"
Pourlagestiondes‚v‚nements,deuxmasquespourlesdeuxsituationsles
pluscourantes:gestiondubureauavecmenuetfenˆtres,etgestiond'un
formulaireseulement.

`$BEV_HIERM,BEV_FREEPU,BEV_WFORM,BEV_WMENU,BEV_WHIER,BEV_TOOL`D‚j…
mentionn‚s,lesnouveauxtypesd'‚v‚nementscr‚‚sparBIG.Voirlechapitre
"Les‚v‚nements".

`$WM_CYCLED,WM_BOTTOM,WM_ICONIFY,WM_UNICONIFY,WM_ALLICONIFY`D‚j…
mentionn‚s,cesontdesmessagescr‚‚sparBIGouofficielsseulement
depuiscertainesversionsdel'AES,maisquiexistenttoussousBIG.Voir
lechapitre"Les‚v‚nements".

`$WATR_ALLG`"WindowATtRibutsALLGem"
`$WATR_ALLB`"WindowATtRibutsALLBig"
`$WATR_CURRG`"WindowATtRibutsCURrentsGem"
`$WATR_CURRB`"WindowATtRibutsCURrentsBig"
`$WATR_FORMG`"WindowATtRibutsFORMulaireGem"
`$WATR_FORMB`"WindowATtRibutsFORMulaireBig"
AttributsGEMdesfenˆtres,deuxfoistroisjeuxsouventemploy‚s."ALL"
signifietouslesattributs,"CURR"lespluscourants(toussauflalignes
d'info)et"FORM"unjeupourlesfenˆtresformulaire(NAME,CLOSERet
MOVER).le'G'signifiequelesattributsselimitent…ceuxduGEM,le'B'
qu'ilscomprennentaussilesattributs‚tendusdeBIG.

`$WTYP_NORM(1)`"WindowTYPeNORMal"
`$WTYP_FORM(2)`"WindowTYPeFORMulaire"
`$WTYP_PICT(3)`"WindowTYPePICTure"
`$WTYP_TOOL(0x4000)`"WindowTYPeTOOLbar"
`$WTYP_MENU(0x8000)`"WindowTYPeMENU"
TypeBIGdesfenˆtres.Utilis‚esdanslastructureBigWind.
€
El‚mentw_flagsdelastructureBigWind :
`$WFFULL(0x01)`"WindowFlagFULL".Flagpourlesfenˆtres.Cebitestmis
lorsquelafenˆtreasataillemaximum.Ilesteffac‚lorsd'un
d‚placement,d'unredimensionnement,oulorsqu'onrecliquesurleboutonde
pleineouverturepourramenerlafenˆtre…sescoordonn‚esant‚rieures.
`$WFARROW(0x02)`"WindowFlagARROW".Flagpourlesfenˆtres.Lorsquecebit
estmis,lafenˆtrepeutˆtremanipul‚e…partirduclavier.
`$WFCALAG(0x04)`"WindowFlagCALAGe".Flagpourlesfenˆtres.Lorsquecebit
estmis,leslargeurethauteurdelazonedetravaildelafenˆtreest
toujourscal‚esurdesmultiplesdesunit‚sded‚calagelorsde
redimensionnements.Demˆmepourlesd‚filementsparsliders.
`$WFDECAL(0x08)`"WindowFlagDECALage".Flagpourlesfenˆtres.Lorsquece
bitestmis,les‚l‚mentsw_linetw_coldelastructuresBigWindsont
actualis‚slorsderedimensionnementseffectu‚savecl'undesSizersde
BIG.Sinon,cesvaleursrestentinchang‚es.
`$WFGROUP(0x10)`"WindowFlagGROUPement".Flagpourlesfenˆtres.Lorsquece
bitestbis,lesquatreflŠchesdelafenˆtresontgroup‚esdansl'angle
inf‚rieurdroit.CeflagnedoitJAMAISˆtremispourunefenˆtre
formulaire.
`$WLAST(0x0080)`"WindowLAST".Flagpourlesfenˆtres.LorsqueBIG
initialiselesfenˆtresqueleprogrammevautiliser,laderniŠrefenˆtre
delalisteestrep‚r‚eparcebit(commeleLASTOBdesobjetsGEM).

`$DCDEFAULT(0x0800)`"Double-ClicD‚fault".C'estlebit 11de
l'ob_flagsd'unobjetB_SELEC.Sicebitestopsitionn‚etqu'undouble-
clicestfaitsurcetobjet,leboutonpard‚fautduformulaireest
automatiquementactiv‚.

`$WFCLOSE(0x1000)`"WindowFormulaireCLOSE".Ils'agitdubit 12de
l'ob_flagsdesobjetsEXITd'unformulaireenfenˆtre.Sicebitestmis,
lafenˆtreestferm‚e.

`$BS_RIGHT(0x2000)`"B_SelectRIGHT".Ils'agitdubit 13del'ob_flagsdes
objetsB_SELECT.Sicebitestmis,leboutonestplac‚…droiteetle
texte…gauche.

`$AIDE_OBJET(0x4000)`Correspondaubit 14del'ob_flag.Celasignifieque
l'objetpossŠdeunebulled'aide.

`$NOTOP(0x8000)`Correspondaubit 15del'ob_flags.Sicebitestmispour
l'objet-racined'unformulaireenfenˆtreoud'uneToolBar,ceformulaire
oucetteToolBarpourraˆtremanipul‚(e)mˆmesisafenˆtreestenarriŠre
plan.Sanseffetsurlesautresobjetsainsiquepourlesformulaires
"ordinaires".

`$BKGR(0x0400)`"BackGround"Bit10del'ob_flags,utilis‚pourlerelief.

`$POINTIL(0x8888)`"Pointill‚s"Lorsqu'ond‚finiuntypedeligne
utilisateur(vsl_type),cecid‚termineunelignepointill‚eo—unpointsur
deuxestmis.

`$HLEFT(0)
`$HCENT(1)
`$HRIGHT(2)
`$VDOWN(0)
`$VLINE(3)
`$VTOP(5)
Cesd‚finitionscorrespondent…lafonctionVDIvst_alignment().

`$MTPOINT(1)
`$MTPLUS(2)
`$MTETOILE(3)
€`$MTCARRE(4)
`$MTCROIX(5)
`$MTLOSANGE(6)
Cesd‚finitionscorrespondent…lafonctionVDIvsm_type().

`$EFNONE(0x00)
`$EFGRAS(0x01)
`$EFGRIS(0x02)
`$EFITAL(0x04)
`$EFSOULI(0x08)
`$EFCONT(0x10)
Cesd‚finitionscorrespondent…lafonctionVDIvst_effects().

`$HNORM(13)
`$HPETIT(6)
`$HMINUS(4)
Cesd‚finitionscorrespondent…lafonctionVDIvst_height().

`$RONORM(0)
`$RO90(900)
`$RO180(1800)
`$RO270(2700)
Cesd‚finitionscorrespondent…lafonctionVDIvst_rotation().

`$HELP(0x6200)
`$UNDO(0x6100)
`$ENTER(0x1C0D)
`$RETURN(0x720D)
`$BACKSPC(0x0E08)
`$DELETE(0x537F)
`$SH_DELETE(0x537F)`"SHiftDELETE"
`$INSERT(0x5200)
`$SH_INSERT(0x5230)`"SHiftINSERT"
`$TAB(0x0F09)
`$ARDN(0x5000)`"ARrowDoWn"
`$ARUP(0x4800)`"ARrowUP"
`$ARLF(0x4B00)`"ARrowLeFt"
`$ARRT(0x4D00)`"ARrowRighT"
`$CT_ARLF(0x7300)`"ConTrolARrowLeFt"
`$CT_ARRT(0x7400)`"ConTrolARrowRighT"
`$CT_ARUP(0x4800)`"ConTrolARrowUP"
`$CT_ARDN(0x5000)`"ConTrolARrowDoWn"
`$SH_ARDN(0x5032)`"SHiftARrowDoWn"
`$SH_ARUP(0x4838)`"SHiftARrowUP"
`$SH_ARLF(0x4B34)`"SHiftARrowLeFt"
`$SH_ARRT(0x4D36)`"SHiftARrowRighT"
`$ESC(0x011B)
`$CLR(0x4700)
`$CT_CLR(0x7700)`"ConTrolCLR"
`$SH_CLR(0x4737)`"SHiftCLR"
`$ESPACE(0x3920)`Labarred'espace
`$FnLestouchesdefonction`('n'estlenum‚rodelatouche)
SH_FnLestouchesdefonctionshift‚es('n'estlenum‚rodelatouche)
Cesd‚finitionssontrelativesauclavier.Ellesrepr‚sententdestouches
oucombinaisonsdetouchesinvariablessurtouslestypesdeclaviers.
Ellessontutilis‚esparBIGpoursagestioninterne,maisvousenaurez
certainementbesoin…l'occasion.

Voicimaintenantlesnouveauxattributsdefenˆtres :
`$SMALLER(0x4000)`Boutond'ic“nification.
`$CYCLER(0x2000)`Bouton"fenˆtresuivante".
`$ALLSIZER(0x8000)`LestroisnouveauxSizersenmˆmetemps.

€Lesstructurest_ident_hard_softett_displayutilisentlesd‚finitions
suivantes:
t_machined‚finilamachinesurlaquelleonsetrouve:
`$typedefenum{
`$ST,
`$STE,
`$TT,
`$FALCON_030,
`$AUTRE_MACHINE
`$}t_machine;

t_proc_graphiqued‚finileprocessurgraphiqueutilis‚:
`$typedefenum
`${
`$PG_ST,
`$PG_STE,
`$PG_TT,
`$PG_FALCON_030,
`$AUTRE_PG,
`$}t_proc_graphique;

t_cpud‚finileprocesseurcentraldel'ordinateur:
`$typedefenum
`${
`$PROC_68000,
`$PROC_68030,
`$AUTRE_PROCESSEUR,
`$}t_cpu;

type_gdospr‚ciseletypedeGDOS :
`$typedefenum
`${
`$  AUCUN_GDOS=0,
`$  GDOS_STANDARD=1,
`$  FONT_GDOS=2,
`$  FSM_GDOS=3,
`$  SPEEDO_GDOS=4
`$}type_gdos;


t_resolutiond‚finilar‚solutioncourante:
`$typedefenum
`${
`$ST_BASSE=0,
`$ST_MOYENNE=1,
`$ST_HAUTE=2,
`$VGA_16COL=4,`/*leVGATT*/
`$VGA_256COL=5,`/*leVGAFALCON*/
`$R_256C_320_480=7,`/*le320*48016colTT*/
`$TRUE_COLOR_320_480=8,`/*le320*480FalconsurVGA*/
`$INCONNU=-1`/*aucuner‚solutionnormalis‚e*/
`$}t_resolution;

CommelescompilateursnepossŠdentpastoujourslesd‚finitionsrelatives
auxic“nescouleurs,BIGlesajoutedemaniŠreconditionnelle(repportez-
vous…unedocumentationGEMpourlesd‚tails) :
`$#if !defined( G_CICON )
`$#define G_CICON 33
`$typedef struct cicon_data {
`$        int num_planes;
`$        int *col_data;
`$        int *col_mask;
`$        int *sel_data;
€`$        int *sel_mask;
`$        struct cicon_data *next_res;
`$} CICON;
`$typedef struct cicon_blk {
`$        ICONBLK monoblk;
`$        CICON *mainlist;
`$} CICONBLK;
`$#endif

Enfin,ilexistedeuxd‚finitions"defacilit‚" :
`$ADR`remplacesimplement"ir_trindex",letableaudepointeursversles
adressesdetouslesformulairesduprogramme.
`$get_popup`remplacelachaŒne"match".Cettefonctionmatch()r‚alise
l'inversedelafonctionset_popup()(voirleschapitrescorrespondant).Il
estsansdouteplussimpledes'ensouvenirsouscenom.

!************************
`!LesCookies

BIGoffrequelquesfonctionspermettantunegestionlimit‚edesCookies.
CesfonctionsutilisentunestructureCookie,quevoici:
`$typedefstruct`/*DEFINITIOND'UNCOOKIE*/
`${
`$longident;` /*Identificateur*/
`$union
`${`         /*DATAsduCookie*/
`$longl;`   /*Siladonn‚eestsur1long*/
`$inti[2];` /*Siladonn‚eestsur2ints*/
`$charc[4];`/*Siladonn‚eestsur4octets*/
`$}datack;
`$}COOKIE;

!************************
`!Lesfonctionsprogrammeur

BIGpossŠdeunassezgandnombredefonctions.Jenevaispr‚sentericique
lesfonctionsqueleprogrammeurdoit(oupeut)appeler.Unetrentaine
seulementsontd'unusagetrŠscourant,etserontutilis‚esdanspresque
touslesd‚veloppements.Lesautressontdesfonctionsinternes.La
pr‚sentationdesfonctionsrespectelemodŠlesuivant:

Prototypage.Leprototypagedelafonction.
Description.Cequer‚aliselafonction.
ParamŠtres.LadescriptiondechaqueparamŠtreet(s'ilyalieu)duretour
delafonction.
Remarques.(Eventuellement)Desremarquessurcequiestfait,cequiest…
faire,etcequiest…nepasfaire.

!************************
`!initial

`$Prototypage
intinitial(char*rsc,intmenu,intdesk,
intnb_tree,OBJECT*rs_tree,char*rs_str,
intn_wind,intacc);

`$Description`Cettefonctiond‚clarel'application,ouvrelastationde
travail,initialiselaplupartdesvariablesglobales,chargeleressource
(s'ilestexterne,sinonadapteleressourceint‚gr‚…lar‚solution
courante),metenplaceleressourceinclusdeBIG,metenplaceleszones
m‚moirespourlagestiondesfenˆtres,desobjetsuserdef,des‚ditables
‚tendus,despointeurssurfonction,delapalettedecouleurs,r‚serve
l'espacem‚moirepourlagestiondesfenˆtresparBIG,initialisecertains
€‚l‚mentsdesstructuresBigWind,etc.

`$ParamŠtres
'rsc'estunpointeursurunechaŒnequiestlenomdufichierressource…
charger,ouunechaŒnevideencasderessourceint‚gr‚.
'menu'et'desk'sontlesnum‚rosd'arbres(dansleressource)quiseront
priscommemenuprincipaletbureaudel'application.Danslecasd'un
accessoiredebureau,cesdeuxparamŠtressontignor‚s.Siond‚sirecr‚er
unprogrammesansbureauousansmenu(ousanslesdeux),ilfaut
transmettre'-1'commeparamŠtrecorrespondant.
'nb_tree'estobligatoirement‚gal…0sileressourceestunfichier
externe.Sileprogrammetravailleavecunressourceint‚gr‚,nb_tree
indiquelenombred'arbres(menusetformulairesconfondus)dece
ressource.
'rs_tree'et'rs_str'sontdeuxpointeurssp‚ciaux.Danslecasd'un
ressourceint‚gr‚,ilspermettentd'indiquer…BIG…quelendroitdela
m‚moirecommencentlesdeuxtableaux'rs_trindex[]'et'rs_frstr[]'cr‚‚s
parlefichierRSH.Sinon,ilspointentsurZERO.Voyezauchapitre
"Travailavecunressourceint‚gr‚"lafa‡ondelesutiliser.
'n_wind'NombretotaldefenˆtresBIGaveclesquellesleprogrammeva
travailler.
'acc'Num‚rodansleressourcedelachaŒnelibre…utiliserpourl'appel
delafonctionmenu_register()sil'applicationestunaccessoiredebureau
(nomdel'accessoiredanslemenuBureau).Sic'estunprogramme,le
paramŠtreestignor‚,onpeuttransmettre'-1'.
retour:TRUEsitoutc'estbienpass‚,FALSEsinon(parexemple,le
fichierressourcen'apas‚t‚trouv‚).

`$Remarques`Lesvariables'adr_menu'et'adr_desk'ontdesnomsimpos‚spour
faciliterleurgestion.Eneffet,ilyadenombreusesfonctionsquifont
appel…cesadresses,etlestransmettre…chaquefoisseraitfastidieuxet
peupratique.Sivotreprogrammetravailleavecplusieursbarresdemenu
(oumˆmeplusieursbureaux,pourquoipas),l'adressedumenucourantdoit
ˆtredansadr_menu.Lafonctioncentre…l'avancetouslesformulaireset
videtousleschamps‚ditables.
OnaccŠdeauxstructuresdefenˆtres(et…leurs‚l‚ments)commeaux
‚l‚mentsd'untableau,parwin[index].w_adrparexemple(lanum‚rotation
commence‚videmment…z‚ro).
Ilestfortementrecommand‚denepasfaired'‚conomieaveclaquantit‚de
fenˆtresn‚cessaires,etded‚clarerunefenˆtrepar‚l‚mentd'information
…traiter.
Parexemple,ilestd‚conseill‚den'avoirqu'unefenˆtrepourafficherun
texteouuneimage,souspr‚textequelesdeuxneserontjamaisaffich‚sen
mˆmetemps.Ilvautmieuxdanscecasavoirdeuxfenˆtresdistinctes,les
paramŠtrescontenusdansleurs‚l‚ments‚tantdiff‚rents.Demˆme,d‚clarez
unefenˆtreparformulaireenfenˆtre.
Lagestionduprogrammeenserasimplifi‚e,quitte…fermerunefenˆtre
avantd'enouvriruneautresilesdeuxnedoiventpasˆtreaffich‚esen
mˆmetemps.
UnestructureBigWinddeplusenm‚moirenerepr‚senteque158octets,
alorsqu'unegestioncompliqu‚edepeudefenˆtressepartageantdes
contenusdiff‚rentsrisquedeprendrebeaucoupplus,sansparlerdutemps
detraitement.
CettefonctiondoitIMPERATIVEMENTˆtreappel‚parlafonctionmain()du
programmeprincipaldŠsled‚butdel'ex‚cution.

!************************
`!end

`$Prototypage
voidend(void);

`$Description`Cettefonctionfermetouteslesfenˆtresduprogramme,elle
€libŠrelesdiff‚renteszonesm‚moiresquiont‚t‚r‚serv‚es…
l'initialisationetencoursdeprogramme,ellelibŠreleressource,elle
fermelastationdetravail,ellerestaurelapalettedecouleursetautres
paramŠtresd'affichageetellequitteleprogramme.

`$Remarques`Cettefonctionn'estpasappel‚eparBIG.C'estvotreprogramme
quidevrasechargerdecetappellorsquel'utilisateurdemande…quitter
l'application.
Siunezonem‚moireestaffect‚eaucontenud'unefenˆtre,elledoitˆtre
lib‚r‚e.Silafonctiondefermetureaffect‚e…l'‚l‚ment
win[index].w_closedecettefenˆtrenes'enchargepas,vousdevrezle
faire"…lamain"AVANTd'appelerend().

!************************
`!create_hierm

`$Prototypage
voidcreate_hierm(OBJECT*adr);

`$Description`CettefonctioncherchelesobjetsB_HIERMsd'unmenuetplace
enavant-derniercaractŠredelachaŒneuneflŠcheversladroiteo—la
gaucheselonlecot‚o—vased‚roulerlemenuhi‚rarchique.

`$ParamŠtre
'adr'Adressedel'arbremenu.

`$Remarques`Encequiconcernelemenuprincipald'uneapplication,la
fonctioninitial()secharged'appelercettefonction.Elleest‚galement
appel‚eautomatiquement…chaquefoisqu'unclicalieusuruntitrede
menuenfenˆtre,carlafenˆtreapuˆtred‚plac‚e,etlessous-menus
pourraientalorsdevoirˆtred‚roul‚sdel'autrecot‚.Maissivousd‚sirez
changerlabarredemenu(etsilanouvellecomportedesB_HIERMs),vous
devezappelercettefonctionlorsdupremieraffichagedecettebarre.Lors
desr‚affichagesult‚rieurs,oudelar‚activationdelapremiŠrebarre,ce
n'estpasn‚cessaire.
LesoptionsdemenudetypeB_HIERMdoiventˆtreremplisd'espacessur
touteleurlargeur.L'avant-derniercaractŠreestremplac‚paruneflŠche
(Ascii3ou4)plac‚eparcettefonction.

!************************
`!dialog

`$Prototypage
intdialog(intflags,OBJECT*address,intf,
intfl_rb,intform_pu,
MFDB*img,intfl_move);

`$Description`CettefonctionestlecoeurdeBIG.C'estlaboucle
principalequiscruteles‚v‚nementsetlesgŠreengrandepartie.Elle
seratoujoursappel‚eaumoinsunefoisdansunprogrammesousBIG.

`$ParamŠtres
'flags'C'estlemasquedebits(lemˆmequepourlafonctionGEM
evnt_multi())quiindiquequels‚v‚nementsdoiventˆtresurveill‚s.BIG
proposedesd‚finitionstoutesfaitespourlessituationslesplus
courantes(voirlechapitre"Lesd‚finitions").
'address'Adresseduformulaire…traiter,oudubureau.
'f'"Flag".SiceflagestTRUE,Lafonctionsurveillelemenu,lebureau,
lesfenˆtres,etc.S'ilestFALSE,elleselimiteauformulaireindiqu‚par
'address',consid‚rantquelesautres‚v‚nementssontbloqu‚spar
wind_update().
'fl_rb'"FLagRightButton".SiTRUE,unclicduboutondroitdelasouris
appelleunmenupop-uplibre(voirparamŠtresuivant).
€'form_pu'"FORMulairePop-Up".Num‚rod'arbreduformulaireservantdepop-
uplibreencasdeclicsurleboutondroit.-1s'iln'yenapas.A
r‚serverpourletravailsurlebureau.
'img'Danslecasd'unformulaired‚pla‡able,c'estunpointeursurleMFDB
quicontientlefonddeceformulaire.CeparamŠtren'estpasutilis‚sion
travailsurlebureau,maisunMFDBdoitˆtrequandmˆmetransmis.
'fl_move'Indiquesileformulaireestd‚pla‡able(TRUE)ounon(FALSE).
EgalementFALSEsilafonctiongŠrelebureau.
retour:Lafonctionretourneunmasquedebitscorrespondantautype
d'‚v‚nementquis'estproduit.Cemasqueestlemˆmequepourlafonction
GEMevnt_multi().

`$Remarques`Voiciunrappeldumasquedebitsutilis‚parevnt_multi()et
dialog().
`$Bit0:MU_KEYBD`(‚v‚nementclavier)
`$Bit1:MU_BUTTON`(‚v‚nementclicsouris)
`$Bit2:MU_M1`(‚v‚nementzonesouris1)
`$Bit3:MU_M2`(‚v‚nementzonesouris2)
`$Bit4:MU_MESAG`(‚v‚nementmessagemenuoufenˆtre)
`$Bit5:MU_TIMER`(‚v‚nementtimer‚coul‚)

`!IMPORTANT
Lafonction`$dialog()`r‚alise‚galementgrƒceautimertoutuntravailde
surveillancedeplusieurschoses :fenˆtredepremierplanpouractiverla
palettedecouleurcorrespondantemˆmesurinterventiond'uneautre
application,bullesd'aide,menuhi‚rarchiqueetclicdroitdelasouris.
CettesurveillancepermanenteentraŒneuncertainralentissement,
particuliŠrement‚videntesurlesanciennesmachines 8 Mh.
Ilestpossiblede"d‚brancher"cesfonctionsentapantdanslesourcede
votreprogrammelaligne :
  `$#defineLIGHT
Cetted‚finitiondoitˆtreplac‚e`!AVANT`"#include <BIG2.H>".
Evidemment,leseffetssignal‚sdisparaŒssent‚galement.Plusdebulles
d'aide,plusdemenushi‚rarchiques,etc(maislesmenushi‚rarchiquesde
menusenfenˆtresonttoujoursactifs).Maisdansunprogrammequineles
utilisentpas,ilvautmieuxlesd‚connecter(c'estparexemplelecasde
BIG_DOC).Toutefois,letraitementdelapalettedecouleurcontinue…ˆtre
actifpuisquec'estaumomento—unefenˆtreestamen‚eaupremierplanque
BIGactivelapalettequiluicorrespond.Simplement,cettegestionne
tiendrapluscomptedesfenˆtresappartenant…d'autresapplications.

!************************
`!get_bkgr

`$Prototypage
voidget_bkgr(intof_x,intof_y,intof_w,intof_h,MFDB*img);

`$Description`(GETBacKGRound).Cettefonctionsauvel'imaged'unezonedans
unMFDB,afindelarestaurerplustard.Ellepermetdemettre"dec“t‚"le
fondd'unformulaireoud'unpop-up,parexemple.Cefondserarestaur‚par
lafonctionput_bkgr().

`$ParamŠtres
'of_x','of_y','of_w','of_h'"OFfsetX","OFfsetY","OFfsetWidth",
"OFfsetHeight".Coordonn‚esetdimensionsdelazone…sauvegarder.
'img'"IMaGe".PointeursurleMFDBquid‚criralazonesauv‚e.

`$Remarques`Cettefonctionestappel‚eeninterneparBIG,maisvouspouvez
l'utiliserpoursauverdeszonesd'‚cransin‚cessaire.Voiraussila
fonctionput_bkgr().

!************************
`!put_bkgr
€
`$Prototypage
voidput_bkgr(intof_x,intof_y,intof_w,intof_h,MFDB*img);

`$Description`(PUTBacKGRound)Cettefonctionrestaurel'imaged'unezonequi
a‚t‚sauv‚edansunMFDB,parlafonctionget_bkgr().

`$ParamŠtres
'of_x','of_y','of_w','of_h'"OFfsetX","OFfsetY","OFfsetWidth",
"OFfsetHeight".Coordonn‚esetdimensionsdelazone…sauvegarder.
'img'"IMaGe".PointeursurleMFDBquid‚critlazone…restaurer.

`$Remarques`Cettefonctionestappel‚eeninterneparBIG,maisvouspouvez
l'utiliserpoursauverdeszonesd'‚cransin‚cessaire.Voiraussila
fonctionget_bkgr().

!************************
`!get_string

`$Prototypage
char*get_string(intnumber);

`$Description`CettefonctionretourneunpointeursurunechaŒnelibre(ou
alertelibre)d'unressource,int‚gr‚ounon.

`$ParamŠtres
'number'Num‚rodelachaŒnelibredansleressource(donn‚parlefichier
headercr‚‚parl'‚diteurderessource).
retour:PointeursurlapositiondelachaŒneenm‚moire.

!************************
`!bulle_attach

`$Prototypage
voidbulle_attach(inttree,intobj,charbulle);

`$Description`Cettefonctionr‚aliselelienentreunobjetetlachaŒne
librequidoitluiˆtreaffect‚ecommebulled'aide.

`$ParamŠtres
'tree'Num‚rodel'arbrecontenantl'objet.
'obj'Num‚rodel'objetconcern‚.
'bulle'Num‚rodelachaŒnelibre…affecter…l'objetentantquetextede
labulle.

`$Remarques`Ilestpossibleder‚aliserlelien"manuellement"aumomentde
lacr‚ationduressource.Toutefois,celaestassezennuyeuxetsurtout,si
denouvelleschaŒnessontult‚rieurementins‚r‚es,letravaildoitˆtre
refait.Ilestdoncpluscommoded'effectuerunes‚ried'appels…cette
fonctionaud‚butduprogrammeafindecr‚ercesliensenutilisantles
nomsdesarbres,objetsetchaŒnes.
Lafonctionpositionne‚galementlebitAIDE_OBJETdel'objetconcern‚afin
designalerqu'unebulled'aideluiestaffect‚e.
Lafonctionestsanseffetpourlesobjetsnepouvantrecevoirdebulle
d'aide(voirlechapitresurlesbullesd'aide).

!************************
`!set_interface

`$Prototypage
voidset_interface (int under, int cunder, int ctxt_under,
                    int cicn_coche, int ctxt_coche,
                    int cicn_radio, int ctxt_radio,
€                    int cicn_popup, int ctxt_popup,
                    int cmove, int cgrastr,
                    int clin_frame, int ctxt_frame,
                    int cniceline);

`$Description`CettefonctionpermetdemodifiercertainsparamŠtres
concernantl'aspectdesobjetsBIG.

`$ParamŠtres
'under'Flag.S'ilvautTRUE,lecaractŠreserasoulign‚danslesobjets
B_SELECT,B_UNDOetB_UNDER.S'ilvautFALSE,lecaractŠreneserapas
soulign‚.
'cunder'IndexdecouleurducaractŠresoulign‚.
'ctxt_under'Indexdecouleurdurestedutextdanslesobjetscit‚sci-
dessus.
'cicn_coche'Indexdecouleurdel'ic“nedesboutonsB_COCHE.
'ctxt_coche'IndexdecouleurdutextedesboutonsB_COCHE.
'cicn_radio'Indexdecouleurdel'ic“nedesboutonsB_RADIO.
'ctxt_radio'IndexdecouleurdutextedesboutonsB_RADIO.
'cicn_popup'Indexdecouleurdel'ic“nedesboutonsB_POPUPetB_LIST.
'ctxt_popup'IndexdecouleurdutextedesboutonsB_POPUPetB_LIST.
'cmove'IndexdecouleurdeslignesdesobjetsB_MOVE.
'cgrastr'IndexdecouleurpourletextedesobjetsB_GRASTR.
'clin_frame'IndexdecouleurpourlecadredesobjetsB_FRAME.
'ctxt_frame'IndexdecouleurpourletextedesobjetsB_FRAME.
'cniceline'Indexdecouleurpourletrac‚desobjetsB_NICELINE.

`$Remarques`Si'-1'esttransmis…un‚l‚ment,ler‚glagecorrespondantest
inchang‚.Pard‚faut,lecaractŠreestsoulign‚(under==TRUE),ilesten
rouge(cunder==RED),ettouslesautresparamŠtressontr‚gl‚ssur'noir"
(BLACK).
Lesnum‚rosdetramecorrespondent…ceuxutilis‚sparlafonctionVDI
vsf_style().Lemotifdetramen'estdoncpaslimit‚aux7modŠlesde
l'AES,maispeutprendreundes24motifspr‚vusparlaVDI.
Lesr‚glagesaffectenttouslesobjetscorrespondantsdetousles
formulairesdel'application.
Lafonctiontestes'ilyaaumomentdel'appeldesfenˆtresformulaireou
desfenˆtresavectoolbarouvertes.Sielleentrouve,cesfenˆtressont
entiŠrementredessin‚espouractualiserlesnouveauxr‚glages.Donc,cette
fonctionnedoitjamaisˆtreappel‚elorsqueleGEMest"gel‚"parun
formulairebloquantouautre.

!************************
`!dlg_mouse

`$Prototypage
voiddlg_mouse(void);

`$Description`Cettefonctiontestelapositiondelasourisparrapport…la
zonedetravaildelafenˆtredepremierplanetchange‚ventuellementsa
forme.

`$Remarques`Ilestutiled'appelercettefonctiondanslasituation
suivante :unefenˆtreestouverte,etlasourisdoitprendreuneforme
d‚termin‚edanssazonedetravail.Latailledelafenˆtreestchang‚epar
leprogramme,sansquel'utilisateuraitdirectementchang‚sesdimensions.
Parexemple,lafenˆtreafficheunes‚riedetableaux.Par‚quivalent
clavier,l'utilisateurdemande…passerautableausuivant,etlataillede
lafenˆtreestautomatiquementajust‚eparleprogrammeauxdimensionsdu
nouveautableau.Alafindel'op‚ration,silasourisestdanslazonede
travail,ilfautactiverlaformepr‚vue.Sinon,ilfautactiverlaforme
deflŠchepard‚faut.Cetteop‚rationestr‚alis‚eparl'appel…cette
fonction.
€
!************************
`!formm_draw

`$Prototypage
voidformm_draw(OBJECT*adr,inted,
intflmove,MFDB*img);

`$Description`"FormMoveDRAW".Cettefonctionafficheunformulaire
d‚pla‡able.

`$ParamŠtres
'adr'Adresseduformulaire…afficher.
'ed'Num‚rod'objetduchamp‚ditabledanslequeldoitsetrouverle
curseuraud‚butdelagestionduformulaire.Lecurseurestplac‚…lafin
duchamp.-1s'iln'yenapas.
'flmove'"FLagMOVE".SiceflagestFALSE,led‚placementduformulairese
faiten"boŒtefant“me".S'ilestTRUE,lafonctionr‚serveunezone
m‚moireetysauvel'‚cranafinder‚aliserled‚placemententempsr‚Šl.
S'iln'estpaspossibleder‚servercettem‚moire,led‚placementsefait
enboŒtefant“me.
'img'PointeursurMFDButilis‚poursauverlefondsousleformulaire.

`$Remarques`Pourenleverleformulairedel'‚cran…lafindelagestion,
ilfautimp‚rativementutiliserlafonctionformm_undraw().

!************************
`!formm_undraw

`$Prototypage
voidformm_undraw(OBJECT*adr,MFDB*img);

`$Description`Cettefonctioneffacedel'‚cranunformulaired‚pla‡ablequia
‚t‚affich‚parlafonctionformm_draw().

`$ParamŠtres
'adr'Adressedel'arbre.
'img'PointeursurleMFDBdanslequela‚t‚sauv‚lefondduformulaire.

`$Remarques`Leformulaired‚pla‡ableestaffich‚imp‚rativementparla
fonctionformm_draw().

!************************
`!formf_draw

`$Prototypage
voidformf_draw(OBJECT*adr,inted);

`$Description`"FORMulaireFixeDRAW".Afficheunformulairetraditionnel,
fixe.

`$ParamŠtres
'adr'Adressedel'arbre…afficher.
'ed'Num‚rod'objetduchamp‚ditableo—placerlecurseuraud‚butdela
gestion,s'ilyena,ou-1.Lecurseurestplac‚…lafinduchamp.

`$Remarques`Cettefonctionn'existequepourdesraisonsdecompatibilit‚
etpourˆtrecomplet,maisonluipr‚fŠrerasansdoutelafonction
formm_draw().Leformulaireaffich‚aveccettefonctiondoitˆtreot‚de
l'‚cranavecformf_undraw().

!************************
`!formf_undraw
€
`$Prototypage
voidformf_undraw(OBJECT*adr);

`$Description`Cettefonctioneffacedel'‚cranunformulairefixequia‚t‚
affich‚parlafonctionformf_draw().

`$ParamŠtre
'adr'Adressedel'arbre.

`$Remarques`Lafonctiondoitˆtreutilis‚eencompl‚mentdeformf_draw().

!************************
`!match

`$Prototypage
intmatch(OBJECT*adr,intbutton);

`$Description`Cettefonctioncherches'ilyaunecorrespondanceentrele
texte(oulemotifd'imageoudeboŒte)d'unboutonpop-upoupop-listeet
undesobjetsdesonformulairepop-upassoci‚.

`$ParamŠtres
'adr'Adresseduformulairedanslequelsetrouvelebouton.
'button'Num‚roduboutondansceformulaire.
retour:Num‚rodel'objetdansleformulairepop-upsiuneoccurenceest
trouv‚e,0sinon.

`$Remarques`L'objet-racineduformulairepop-upayantlenum‚ro0,ilnepeut
yavoird'occurenceaveccenum‚rod'objet.Lafonctionretournedonc0si
aucunecorrespondancen'esttrouv‚e.

!************************
`!set_popup

`$Prototypage
voidset_popup(OBJECT*adr,intbutton,intoption);

`$Description`Cettefonctionrelieletexte(oulemotifd'imageoudeboŒte)
d'uneoptiondemenupop-upauboutonpop-upoupop-listassoci‚.

`$ParamŠtres
'adr'Adresseduformulairedanslequelsetrouvelebouton.
'button'Num‚roduboutondansceformulaire.
'option'Num‚rod'objetdel'optiondanslemenupop-up.

!************************
`!create_popup

`$Prototypage
OBJECT*create_popup(intnbre,char**liste);

`$Description`Cettefonctionpermetdecr‚erunmenupop-uptexteenm‚moire
…partird'unelistedechaŒnedecaractŠres.

`$ParamŠtres
'nbre'C'estlenombredechaŒnesdecaractŠresdestin‚es…devenirles
optionsdupop-up.
'liste'Pointeursurled‚butdutableaudeschaŒnes.Ellesdoivent
imp‚rativementsesuivreenm‚moireen‚tants‚par‚esparunoctetnul.
retour :l'adressedelazoner‚serv‚equiestd‚sormaislemenupop-upou
z‚roencasdeproblŠme.

€`$Remarques`CettefonctionestextrŠmementpratiquepourcr‚erunmenupop-up
dontonnepeutconnaŒtre…l'avance(…lacr‚ationduressource)lenombre
d'optionsouleurtexte.Parexemple,unpop-uppermettantdechoisirune
fonteSpeedoGDOS.Lepop-upainsicr‚‚nepeutˆtreutilis‚quecommepop-
uplibre,aveclafonctionfree_popup().Eneffet,unpop-up"ordinaire"
devraitli‚…unboutondeformulaire,lequelcontiendraitdansson
ob_statelenum‚rodusous-menu.Hors,lepop-upcr‚‚n'apasdenum‚ro !
D'autrepart,ilnefautsurtoutpasoublierdelib‚rerlam‚moirequela
fonctionar‚serv‚e,commececi :
`$     adr=create_popup(20,liste);
`$     free_pop_up(x,y,BLANK,adr);
`$     free(adr);
Lar‚servationestfaiteaveclafonctionmalloc()du Cetnonpascelledu
GEMDOS,tropbugg‚e.Lalib‚rationdoitdoncˆtrefaiteaussiparla
fonction C.
Sidesoptionsdoiventˆtred‚sactiv‚esouch‚ck‚es,leprogrammeurdevra
s'encharger.Parexemple :
`$     adr[3].ob_flags|=HIDETREE;
d‚sactivelatroisiŠmeoption(l'objetnø 0estlaracine).

!************************
`!free_popup

`$Prototypage
intfree_popup(intposx,intposy,intform,OBJECT*adr);

`$Description`Cettefonctionappelleunformulairepop-up"libre",encesens
quesapositionn'estpasli‚…lapositiond'unboutondansunformulaire.

`$ParamŠtres
'posx'"POSitionX".Coordonn‚eenxducentredupop-up.Ilsera
‚ventuellementd‚cal‚s'ildevaitsortirdel'‚cran.
'posy'"POSitionY".Coordonn‚eenyducentredupop-up.Ilsera
‚ventuellementd‚cal‚s'ildevaitsortirdel'‚cran.
'form'Num‚rodel'arbreservantdepop-up,ou'-1'sionpr‚fŠre
transmettredirectementl'adresse.
'adr'SileparamŠtrepr‚c‚dantvaut'-1',adresseduformulairepop-up.
Sinon,ilestignor‚,onpeuttrasmettre'-1'.
retour:TRUEsiuneoptiona‚t‚choisie,FALSEsilepop-upa‚t‚quitt‚
encliquant…c“t‚.

`$Remarques`Siunobjeta‚t‚choisi,TRUEestretourn‚etun‚v‚nementest
misenplaceparlafonctiondanslebufferd'‚v‚nements.Ilestdetype
'BEV_FREEPU'("BigEVentFREEPop-Up".Voyezsadescriptionauchapitre
"Les‚v‚nements".
Sil'objetcliqu‚estdetype"pointeursurfonction",lafonctionest
automatiquementex‚cut‚eavantleretourdelafonction.
Bienquecettefonctionsoitappel‚eeninterneparlafonctiondialog()
(voirleparamŠtre'fl_rb'dedialog()),vouspouvezavoirbesoinde
l'appelerdirectementdanscertainessituations.

!************************
`!big_alert

`$Prototypage
intbig_alert(intbutton,intnumber,char*str,intfl_alrt);

`$Description`CettefonctionappelleetgŠreuneboŒted'alerteBIG,c'est-…-
diresousformedeformulaired‚pla‡able.L'appeletlachaŒned'alerte
sontsemblables…leurshomologuesGEM.L'alertepeutcontenirjusqu'…5
lignesde31caractŠresmaximum,ettroisboutonsde20caractŠresmaximum.

`$ParamŠtres
€'button'Num‚roduboutonpard‚faut:0,1,2ou3.
'number'Num‚ro(dansleressource)delachaŒnelibrecontenantletexte
delaboŒted'alerte,aumˆmeformatquepourlafonctionGEMform_alert().
Sicelaconvientmieux…lasituation,lachaŒnepeutˆtreindiqu‚e
directementdansleparamŠtresuivant.'number'doitalorsˆtre‚gal…-1
(BLANK).
'str'"STRing".Siond‚siretransmettredirectementlachaŒne,le
paramŠtrepr‚c‚dantest-1.'str'estalorsunpointeursurlachaŒne
d'alerte.IndiquezsinonunechaŒnevide.
'fl_alrt'"FLagALeRT".SiceflagestTRUE,l'alerteserag‚r‚eparBIG,
commeunformulaired‚pla‡able.S'ilestFALSE,ceseraunealerteGEM
normale,appel‚eparform_alert().
retour:Num‚ro(1,2ou3)duboutonquia‚t‚cliqu‚,commedansla
fonctionGEM.

`$Remarques`BIGpropose9ic“nesd'alerte.SilachaŒnecomporteunnum‚ro
d'ic“nede'0',l'alerteserasansic“ne.Lesnum‚ros1…9correspondent
auxdessinssuivants:
1:Pointd'exclamation
2:Pointd'interrogation
3:PanneauStop
4:PanneauSensinterdit
5:Mainouverte
6:Lettre'i',commeInformation
7:Bombe(pourlesmessagesd'erreurs)
8:Imprimante
9:Disquette
Siontravailleen16couleursouplus,laboŒted'alerteestaffich‚een
relief,lefond‚tantgris(couleurnø8).Sinon,elleestaffich‚eenfond
blanc,sansrelief.

!************************
`!form_attach

`$Prototypage
voidform_attach(inttree,intobj,charformular);

`$Description`Cettefonctionr‚aliselelienentreunobjetdetypepop-up,
B_POPUP,B_LIST,B_HELPouB_HIERMetlesous-menu(ouformulaired'aide)
quidoitluiˆtreaffect‚.

`$ParamŠtres
'tree'Num‚rodel'arbrecontenantl'objet.
'obj'Num‚rodel'objetconcern‚.
'formular'Num‚rodusous-menu(ouformulaired'aide)…affecter…l'objet.

`$Remarques`Ilestpossibleder‚aliserlelien"manuellement"aumomentde
lacr‚ationduressource.Toutefois,celaestassezennuyeuxetsurtout,si
denouvellesarborescencessontult‚rieurementins‚r‚es,letravaildoit
ˆtrerefait.Ilestdoncpluscommoded'effectuerunes‚ried'appels…
cettefonctionaud‚butduprogrammeafindecr‚ercesliensenutilisant
lesnomsdesarbresetobjets.

!************************
`!parent

`$Prototypage
intparent(OBJECT*adr,intobject);

`$Description`Cettefonctionretournelenum‚rodel'objet-pŠred'unobjet.

`$ParamŠtres
'adr'Adresseduformulaire.
€'object'num‚rodel'objetdontoncherchelepŠre.
retour:Num‚rod'objetdupŠre.

!************************
`!bak_rsc

`$Prototypage
voidbak_rsc(OBJECT*tree,char**bak);

`$Description`"BAcKupReSsourCe".Cettefonctionsauvegardedansunbuffer
"l'‚tat"d'unformulaire,c'est-…-direlesboutonss‚lectionn‚sounon,le
textedes‚ditablesetdespop-ups,etc,afindelesrestituerparla
fonctionres_rsc()silebouton'Annule'estcliqu‚.

`$ParamŠtres
'tree'Adresseduformulaire.
'bak'PointeursurunpointeurdechaŒnequisertdebufferdesauvegarde…
lafonction.Cebufferestunezonem‚moirer‚serv‚e…lataillen‚cessaire
parlafonction.Ilseralib‚r‚parres_rsc()sicelle-ciestappel‚e,ou
devral'ˆtreparleprogrammeursinon.

`$Remarques`L'appeldecettefonctiondoitˆtrefaitparleprogrammeuravant
dedessinerleformulaire(parformm_draw()parexemple).Dansun
formulaireenfenˆtre,ilfautr‚-appelercettefonctionencasdeclicsur
lebouton'Applique'afind'enregistrerlenouvel‚tat.N'oubliezpasalors
defairepr‚c‚dercetappelpar'Mfree(adr_bakrsc)'(o—'adr_bakrsc'est
l'adressedubuffer),sinon,unetaille‚quivalenteseraitr‚serv‚e…
chaquefois,sansˆtrelib‚r‚e.Voiraussilafonctionres_rsc().

!************************
`!res_rsc

`$Prototypage
voidres_rsc(OBJECT*tree,char**bak);

`$Description`"REStaureReSsourCe".Cettefonctionrestaure"l'‚tat"d'un
formulairesauv‚parlafonctionbak_rsc().

`$ParamŠtres
'tree'Adresseduformulaire.
'bak'PointeursurunpointeurdechaŒnequisertdebufferdesauvegarde…
lafonction.Cebufferestunezonem‚moirequia‚t‚r‚serv‚e…labonne
tailleparlafonctionbak_rsc().Lam‚moireestlib‚r‚eparres_rsc().

`$Remarques`Attention:Silagestionduformulaireestquitt‚epar'Annule',
leprogrammeurdoitappelercettefonctionpourrestaurerl'‚tatdu
formulaire.Lazonem‚moireestalorslib‚r‚e.Silagestionestquitt‚e
par'Confirme',c'estleprogrammeurquidoitsechargerdelalib‚ration
delazonem‚moirepar:
Mfree(adr_bakrsc);
Sinon,lazonem‚moireresteraitallou‚e.Voiraussilafonctionbak_rsc().

!************************
`!set_radio

`$Prototypage
voidset_radio(OBJECT*adr,intrb);

`$Description`Cettefonctions‚lectionneunradio-boutondansungroupe
deradio-boutonsetd‚s‚lectionnetouslesautres.

`$ParamŠtres
'adr'Adresseduformulaire.
€'rb'Num‚rod'objetduradio-bouton…s‚lectionner.

`$Remarques`Lafonctionsecontentedes‚lectionnerleradio-boutonen
question,elleneredessinerien.Elledoitdoncˆtreappel‚eavant
l'affichageduformulaireoualorsleprogrammedoitsechargerde
redessinerl'objet-pŠredugroupe,etdonctouslesradio-boutonsparla
mˆmeoccasion.

!************************
`!get_radio

`$Prototypage
intget_radio(OBJECT*adr,intrb);

`$Description`Cettefonctioncherchequelradio-boutonests‚lectionn‚
dansungroupe.

`$ParamŠtres
'adr'Adresseduformulaire.
'rb'Num‚rod'objetd'undesradio-boutonsdugroupe(n'importelequel).
retour :Num‚rod'objetduradio-boutons‚lectionn‚.

!************************
`!set_attributes

`$Prototypage
voidset_attributes(OBJECTadr,intob,intattr);

`$Description`Cettefonctionsert…fixerlesattributsgraphiquesdes
objetsdetypeB_GRASTRetB_SMSTR.

`$ParamŠtres
'adr'Adresseduformulairecontenantl'objet.
'ob'Num‚rodel'objet.
'attr'Masquedebitsdesattributsvoulus,lesmˆmesquedanslafonction
vst_effects().

`$Remarques`L'objetn'estpasredessin‚.Lafonctiondoitdoncˆtre
appel‚eavantl'affichageduformulaireouleredessindoitˆtrefait"…la
main".

!************************
`!objc_xedit

`$Prototypage
voidobjc_xedit(OBJECT*adr,intcar,inted,int*po,
intaction,intf,intindex);

`$Description`Cettefonctionremplacel'appeldelafonctionGEMobjc_edit().
Elleestn‚cessaire…causedel'existencedansBIGdeschamps‚ditablesen
petitscaractŠres,queleGEMnetraitepascorrectement,maisest
utilisableaussiavecles‚ditablesordinaires.Lemieuxestdel'utiliser
syst‚matiquement…laplacedelafonctionGEM.Elles'utilisedefa‡on
similaire.

`$ParamŠtres
'adr'Adresseduformulaireo—setrouvel'‚ditable.
'car'CaractŠre…inscriredanslechamp(telqueletransmet
evnt_multi()).ZEROs'ils'agitd'“teroud'initialiserlecurseur.
'ed'Num‚rod'objetduchamp‚ditable.
'po'Pointeursurlapositionducurseurdanslechamp(sera‚ventuellement
modifi‚e).
'action'Action…r‚aliser,commepourobjc_edit:
€ED_INITLecurseurestplac‚…lafinduchamp.
ED_ENDLecurseurestenlev‚.
ED_CHARLecaractŠreesttrait‚.
'f'Flag.TRUEsiontravailledansunformulaireenfenˆtre,FALSEsinon.
'index'IndexBIGdelafenˆtreduformulaire,s'ilyena.BLANKsinon.

`$Remarques`CommeaveclafonctionGEM,lecurseurestdessin‚enmodeXor.
L'utilisationdelavaleur'ED_END'commeparamŠtre'action'sefaitdonc
delamˆmemaniŠre,lecurseurestalternativementmisouenlev‚…chaque
appel.Avec'ED_INIT',ilesttoujoursmis,maistoujoursenfindechamp.
BIGtraitecorrectementlefiltredelachaŒne"te_pvalid',etajoutemˆme
3nouveauxcaractŠresdefiltre:
'x'TouslescaractŠressontautoris‚s,maisilssontautomatiquement
convertisenmajuscule.Cefiltreexistaitd‚j…dansleGEM,maisn'‚tait
nullepartdocument‚.BIG"l'officialise"etassuresonfonctionnementsur
touslessystŠmes.
'H'Tousleschiffresh‚xad‚cimaux(0-9)+(a-f)+(A-F).
'S'Chiffres(0-9)ousigne'+'ou'-'.Pratiquepourles‚ditableso—une
valeurpositiveoun‚gativepeutˆtresaisie.LepremiercaractŠrede
filtredete_pvaliddoitˆtredanscecas'S'.
Leschamps‚ditablespeuventcomporterunouplusieurscaractŠre(s)fixe(s)
"aumilieu"delachaŒnete_ptmplt.Parexemple,cettechaŒnepouraitˆtre
"Prix HT : ____.__".Danscecas,lepointestuncaractŠrefixe(je
l'appellerai"marque"danslasuitedel'explication).Silecurseurde
saisieestavantlamarqueetquel'utilisateurtapeunpoint('.'),le
curseursaute…lapositionsitu‚ejusteaprŠslamarque,etl'intervalle
estremplispardesespaces.Maiscelanesefaitquesilamarqueestun
caractŠreisol‚.Ainsi,consid‚ronslechamp"Heure : __h__m__s".Sile
curseurestdanslapremiŠrepartiedelasaisieetquel'utilisateurtape
un'h',lesautducurseuresteffectu‚.Maissilechampest
"Heure : __Hr__Mn__Se",lesautneserapasfait.NotezquelafonctionGEM
objc_edit()fonctionnedelamˆmemaniŠre.
Anoter‚galement,unbugdelafonctionGEMobjc_draw():Silepremier
caractŠredelachaŒnete_ptextestun'@',lechamprestevide…
l'affichage.Pourtant,lecurseurestcorrectementplac‚,etlachaŒne
te_ptextest"normale"danslam‚moire.Danslapratique,celan'estpas
g‚nant,jenem'ensuispasaper‡udurantdesann‚es!

!************************
`!set_text

`$Prototypage
voidset_text(OBJECT*adr,intobject,char*string);

`$Description`CettefonctionplaceuntextedansunobjetdetypeG_STRING,
G_BUTTON,G_TEXT,G_BOXTEXT,G_FTEXT,G_FBOXTEXTouG_USERDEF(danscecas,
lesobjetsBIGcomportantuntexte).

`$ParamŠtres
'adr'Adresseduformulaire.
'object'num‚rodel'objetconcern‚.
'string'PointeursurlachaŒne…placerdansl'objet.

`$Remarques`Voiraussilafonctionget_text().

!************************
`!get_text

`$Prototypage
char*get_text(OBJECT*adr,intobject);

`$Description`Cettefonctionretourneunpointeursurletexted'unobjetde
typeG_STRING,G_BUTTON,G_TEXT,G_BOXTEXT,G_FTEXT,G_FBOXTEXTou
€G_USERDEF(danscecas,lesobjetsBIGayantuntexte).

`$ParamŠtres
'adr'Adresseduformulaire.
'object'Num‚rodel'objetconcern‚.
retour:PointeursurlapositiondelachaŒneenm‚moire.

`$Remarques`Danslecasd'unobjetB_EDIT,c'estunpointeursurled‚butde
lachaŒnedesaisiequiestretourn‚e.Voiraussilafonctionset_text().

9[...........................................................]0010
!************************
`!formw_draw

`$Prototypage
intformw_draw(OBJECT*adr,intindex,
inttitle,intinfos,intwed,
intattr,FNCPricn);

`$Description`Cettefonctionouvreunefenˆtreformulaire,etyplacele
formulaire.

`$ParamŠtres
'adr'Adresseduformulaire.
'index'IndexBIGdelafenˆtre…ouvrir.
'title'Num‚ro(dansleressource)delachaŒnelibrecontenantletitrede
lafenˆtre(-1s'iln'yenapas).
'infos'Num‚ro(dansleressource)delachaŒnelibrecontenantletextede
laligned'informationsdelafenˆtre(-1s'iln'yenapas).
'wed'"WindowEDitable"Num‚rod'objetduchamp‚ditableo—doitsetrouver
lecurseuraud‚butdelagestion(-1s'iln'yenapas).
'attr'"ATTRibuts".Attributsdelafenˆtre.
'ricn'"RedrawICoN".Routinededessinducontenudelafenˆtre…utiliser
sielleestic“nifi‚e.Si‚gal…0,ceseralaroutinenormalequisera
toujoursutilis‚e.
retour:TRUEsilafenˆtrea‚t‚correctementcr‚eetouverte,FALSEen
casdeproblŠme.

`$Remarques`Lafonctionrecherches'ilexisteunboutonded‚placementde
formulaire(B_MOVE),etlecache(HIDETREE)sielleentrouveun.Cecipour
lecaso—unmˆmeformulaireseraitutilis‚parleprogrammeen"normal"et
enfenˆtre.Leprogrammeurnedoitpasoublierderendre…nouveauvisible
ceboutonsileformulairedoitensuiteˆtreaffich‚normalement.D'autre
part,laboŒteracineestdot‚ed'unebordured'unpixelversl'ext‚rieur,
etl'‚ventuelattributOUTLINEDestannul‚.
Commetouslesformulairessontcentr‚spard‚fautsousBIG(parla
fonctioninitial()),c'est…cettepositionquelazonedetravaildela
fenˆtresetrouverapard‚faut.Maisilestpossibledelafaires'ouvrir
ailleursenmodifiant"manuellement"lapositionduformulaireavant
d'appelerlafonction,parexemplepar:
adr->ob_x=new_x;
adr->ob_y=new_y;
Lagestiondelafenˆtreparleclavieresttoujoursmises'iln'yapasde
champ‚ditable,ettoujoursannul‚esinon.RappelonsquesousBIGun
formulaireenfenˆtreavecdeschamps‚ditablesnedoitpasˆtreplac‚dans
unefenˆtreavecascenseursoucasederedimensionnement(voirchapitre"Un
autreformulaireenfenˆtre"danslavisiteguid‚e).
Silafenˆtrea‚t‚d‚j…ouverte,puisreferm‚e,sesanciennescoordonn‚es
sontutilis‚es.
L'‚tatduformulaireestsauvegard‚parbak_rsc()danslazoned‚sign‚epar
l'‚l‚mentwin[index].w_cont.w_form.w_bak.
S'ilyad‚j…tropdefenˆtresouvertes,lafonctionsecharged'afficher
laboŒted'alertecorrespondanteduressourceinclusdeBIG.
Lesdimensionsminimalesetmaximalesdelazonedetravaildelafenˆtre
€sont‚videmmentcellesduformulaire.

!************************
`!open_window

`$Prototypage
intopen_window(intindex,inttype,intattr,
intx,inty,intw,inth,
intwmi,inthmi,intwma,inthma,
               intwu,inthu,
intflags,intfmouse,
FNCPricn,FNCPredr,FNCPclos,
char*title,char*info,
longwt,longht,
intfmenu,intftool,intbar,
               intpattern,intcolorp);

`$Description`Cettefonctioncr‚eetouvreunefenˆtre.

`$ParamŠtres
'index'IndexBIGdelafenˆtre…ouvrir.
'type'typeBIGdelafenˆtre…ouvrir.
'attr'"ATTRibuts".AttributsGEMdelafenˆtre…ouvrir.
'x'Positionenxdel'anglesup‚rieurgauchedelafenˆtre…ouvrir.Il
s'agitdelafenˆtreelle-mˆme,passeulementlazonedetravail.
'y'Positionenydel'anglesup‚rieurgauchedelafenˆtre…ouvrir.Il
s'agitdelafenˆtreelle-mˆme,passeulementlazonedetravail.
'w'Largeurdelafenˆtre…ouvrir.Ils'agitdelafenˆtreelle-mˆme,pas
seulementlazonedetravail.
'h'Hauteurdelafenˆtre…ouvrir.Ils'agitdelafenˆtreelle-mˆme,pas
seulementlazonedetravail.
'wmi'"WidthMIni".Largeurminimumquepourraprendrelafenˆtredurantsa
gestion.Ils'agitdelafenˆtreelle-mˆme,passeulementlazonede
travail.
'hmi'"HeightMIni".Hauteurminimumquepourraprendrelafenˆtredurant
sagestion.Ils'agitdelafenˆtreelle-mˆme,passeulementlazonede
travail.
'wma'"WidthMAxi".Largeurmaximumquepourraprendrelafenˆtredurantsa
gestion.Ils'agitdelafenˆtreelle-mˆme,passeulementlazonede
travail.Si'-1'(BLANK)esttransmis,lalargeurmaximumseraledoublede
lalargeurdubureau.
'hma'"HeightMAxi".Hauteurmaximumquepourraprendrelafenˆtredurant
sagestion.Ils'agitdelafenˆtreelle-mˆme,passeulementlazonede
travail.Si'-1'(BLANK)esttransmis,lahauteurmaximumseraledoublede
lahauteurdubureau.
'wu'"WidthUnit".Unit‚ded‚calagehorizontaledelafenˆtre.
'hu'"HeightUnit".Unit‚ded‚calageverticaledelafenˆtre.
'flags'CeparamŠtreestunmasquedebits.Voyezdanslechapitredes
d‚finitionscequiestdit…proposde"WFARROW","WFCALAG","WFDECAL"et
"WFGROUPE".Lesautresbitsnedoivantpasˆtremodifi‚s"…lamain",BIG
lesutiliseeninterne.
'fmouse'"FlagMOUSE".C'estlenum‚rodeformequelecurseurdelasouris
prendralorsqu'ilseraamen‚danslazonedetravaildelafenˆtre(voir
fonctionGEMgraf_mouse()).0pourgarderlatraditionnelleformede
flŠche.
'ricn'"RedrawICoN".Routinededessinducontenudelafenˆtre…utiliser
sielleestic“nifi‚e.Si‚gal…0,ceseralaroutinenormale(paramŠtre
suivant)quiseratoujoursutilis‚e.
'redr'Pointeursurlafonctionaex‚cuterencasdemessagederedrawsur
cettefenˆtre.
'clos'Pointeursurlafonctionaex‚cuterencasdemessagedefermeture
delafenˆtre.
'title'PointeursurlachaŒnedutitredelafenˆtre,ouchaŒnevides'il
€n'yenapas.
'info'PointeursurlachaŒnedelaligned'infosdelafenˆtre,ouchaŒne
vides'iln'yenapas.
'wt'"WidthTotale".Largeurtotaleducontenudelafenˆtre,enpixels.
'ht'"HeightTotale".Hauteurtotaleducontenudelafenˆtre,enpixels.
'fmenu'"FlagMENU".TRUEsilafenˆtredoitcomporterunebarredemenu,
FALSEsinon.
'ftool'"FlagTOOL".TRUEsilafenˆtredoitcomporterunetoolbar,FALSE
sinon.
'bar'Num‚rodel'arbrequiestlemenuoulatoolbardelafenˆtre,-1
s'iln'yenpas.Unefenˆtrenepeutcomporter…lafoisunmenuetune
toolbar.SilesdeuxparamŠtres'fmenu'et'ftool'sontTRUE,BIGdonne
priorit‚aumenu.
'pattern'Motifdetramedelazonedetravail…l'ouverturedelafenˆtre.
'colorp'Indexdecouleurdelatramedelazonedetravail…l'ouverture
delafenˆtre.
retour:TRUEsilafenˆtrea‚t‚correctementcr‚‚eetouverte,FALSEen
casdeproblŠme(tropdefenˆtresouvertes).

`$Remarques`C'estlafonctionBIGlaplus"lourde",avecses25paramŠtres.
Silafenˆtren'ajamais‚t‚ouverte,les‚l‚mentsdesastructuresont
initialis‚savecdesvaleurspard‚fautoucontenuesdanslesparamŠtres
quisonttransmis.Siellead‚j…‚t‚ouverte,puisreferm‚e,lesvaleurs
decertains‚l‚mentssont"rafraŒchis"aveclesparamŠtrestransmis,
notammentlesdimensionsmaximalesetminimales.Sielleestd‚j…ouverte,
lerafraŒchissementestfait,puiselleestamen‚eaupremierplan.
LeparamŠtre'redr'doitˆtre0silafenˆtreestdetypeWTYP_IMAG,car
danscecaslesroutinesdeBIGsechargentduredrawautomatiquement(voir
lafonctionprint_page()).Danslecasd'unautrecontenu(texte,graphique
calcul‚,etc),leprogrammeurdoit‚crirelaroutinededessinet
l'indiquerparceparamŠtre.
LeparamŠtre'clos'indiquelafonction…ex‚cuteraumomentdefermerla
fenˆtre.Cettefonctionnepeutpastoujourssecontenterdefermeretde
d‚truirelafenˆtre,elledoitparfoisaussilib‚rerleszonesm‚moires
r‚serv‚ess'ilyena(voirlafonctionclosed()).
Lesnum‚rosdetramedelazonedetravailcorrespondent…ceuxutilis‚s
parlafonctionVDIvsf_style().Lemotifdetramen'estdoncpaslimit‚
aux7modŠlesdel'AES,maispeutprendreundes24motifspr‚vusparla
VDI.Si'colorp'estnul(couleurblanche),lavaleurde'pattern'est
ignor‚e.Acesujet,voyezlafonctionset_work().
S'ilyad‚j…tropdefenˆtresouvertes,lafonctionsecharged'afficher
laboŒted'alertecorrespondanteduressourceint‚gr‚deBIG.

!************************
`!find_index

`$Prototypage
intfind_index(intwh);

`$Description`Cettefonctioncherchel'indexBIGd'unefenˆtreapartirde
sonhandleGEM.

`$ParamŠtres
'wh'"WindowHandle".HandleGEMdelafenˆtreconcern‚e.Sic'est'-1',la
fonctioncherchelepremierindexBIGdisponible.
retour:Lafonctionretournel'indexBIGdelafenˆtre,ou-1siaucune
correspondancen'esttrouv‚e.

`$Remarques`Entransmettant'-1'(BLANK)commeparamŠtre,onobtienten
retourlepremierindexBIGlibre,c'est-…-direlapremiŠrefenˆtren'ayant
encorejamais‚t‚ouverte,ou'-1's'ilellesl'onttoutes‚t‚.Cette
fonctionnalit‚estenprincipeinutiledanslapratique.

€!************************
`!find_window

`$Prototypage
intfind_window(intmx,intmy);

`$Description`Cettefonctioncherchesilazonedetravaild'unefenˆtrese
trouve…unepositiondonn‚e.

`$ParamŠtres
'mx'"MouseX".Coordonn‚eenxdelapositiondonn‚e.
'my'"MouseY".Coordonn‚eenydelapositiondonn‚e.
retour:HandleGEMdelafenˆtredontlazonedetravailpasseparce
point,FALSEs'iln'yenapas.

`$Remarques`Attention,lafonctionretournelehandleGEM,pasl'indexBIG,
etseulementsilescoordonn‚escorrespondent…lazonedetravail.

!************************
`!zone_work

`$Prototypage
voidzone_work(intindex,int*xw,int*yw,int*ww,int*hw);

`$Description`Cettefonctionindiquelescoordonn‚esdelazonedetravail
d'unefenˆtre,quelsquesoientsesattributsetsontype.

`$ParamŠtres
'index'IndexBIGdelafenˆtre.
'xw','yw','ww','hw'Variablesderetour:coordonn‚esetdimensionsde
lazonedetravaildelafenˆtre.

`$Remarques`SilafenˆtrepossŠdeunmenud‚roulantouunetoolbar,les
coordonn‚esretourn‚esnerepr‚sententquelazonedetravailproprement
dite,sanslemenuoulatoolbar.SousBIG,ilestobligatoired'utiliser
cettefonctionsyst‚matiquement,etnonlafonctionGEM'wind_get
(WF_WORKXYWH)',quidonneraitlesmˆmesvaleursquelescoordonn‚estotales
delafenˆtre.

!************************
`!height_sliders

`$Prototypage
voidheight_sliders(intindex,intfredraw);

`$Description`Cettefonctioncalculeetfixelespositionsetlestaillesdes
slidersd'unefenˆtre.

`$ParamŠtres
'index'IndexBIGdelafenˆtre…traiter.
'fredraw'Flag.SiTRUE,lesascenseurssontredessinn‚s,siFALSE,ils
sontsimplementrecalcul‚s.

`$Remarques`Cettefonctionr‚aliseunsimpleappeldesquatrefonctions
suivantes,quipeuventtoutefoisˆtreappel‚esisol‚mentsilebesoins'en
faitsentir.
SilafenˆtredoitˆtreentiŠrementredessin‚e(parunmessagederedraw
parexemple,passeulementlazonedetravail),ilestinutilededemander
leredessindesascenseurs,quiseraientsinonr‚affich‚sdeuxfois.Sinon,
ilfautmettre…TRUEleparamŠtre'fredraw',sinonlescaculsseraient
faitsanscons‚quencepourl'affichage.

!************************
€`!posi_vert

`$Prototypage
voidposi_vert(intindex,intfredraw);

`$Description`Cettefonctioncalculeetfixelapositionduslidervertical.

`$ParamŠtres
'index'IndexBIGdelafenˆtreconcern‚e.
'fredraw'Flag.SiTRUE,l'ascenseurverticalestredessin‚,siFALSE,il
estsimplementrecalcul‚.

`$Remarques`Ilestparfoispr‚f‚rabled'appelerdirectementcettefonctionau
lieudepasserparheight_sliders(),parexemplesilafenˆtren'apas
d'ascenseurhorizontal,ousisatailleestinchang‚emaissapositionoui.
Voyez…lafonctionheight_sliders()cequiestdit…proposduparamŠtre
'fredraw'.

`!posi_hori

`$Prototypage
voidposi_hori(intindex,intfredraw);

`$Description`Cettefonctioncalculeetfixelapositionduslider
horizontal.

`$ParamŠtres
'index'IndexBIGdelafenˆtreconcern‚e.
'fredraw'Flag.SiTRUE,l'ascenseurhorizontalestredessin‚,siFALSE,il
estsimplementrecalcul‚.

`$Remarques`Ilestparfoispr‚f‚rabled'appelerdirectementcettefonctionau
lieudepasserparheight_sliders(),parexemplesilafenˆtren'apas
d'ascenseurvertical,ousisatailleestinchang‚emaissapositionoui.
Voyez…lafonctionheight_sliders()cequiestdit…proposduparamŠtre
'fredraw'.

!************************
`!height_vert

`$Prototypage
voidheight_vert(intindex,intfredraw);

`$Description`Cettefonctioncalculeetfixelatailleduslidervertical.

`$ParamŠtres
'index'IndexBIGdelafenˆtreconcern‚e.
'fredraw'Flag.SiTRUE,l'ascenseurverticalestredessin‚,siFALSE,il
estsimplementrecalcul‚.

`$Remarques`Ilestparfoispr‚f‚rabled'appelerdirectementcettefonctionau
lieudepasserparheight_sliders(),parexemplesilafenˆtren'apas
d'ascenseurhorizontal,ousisapositionestinchang‚emaissatailleoui.
Voyez…lafonctionheight_sliders()cequiestdit…proposduparamŠtre
'fredraw'.

`!height_hori

`$Prototypage
voidheight_hori(intindex,intfredraw);

`$Description`Cettefonctioncalculeetfixelatailledusliderhorizontal.

€`$ParamŠtres
'index'IndexBIGdelafenˆtreconcern‚e.
'fredraw'Flag.SiTRUE,l'ascenseurhorizontalestredessin‚,siFALSE,il
estsimplementrecalcul‚.

`$Remarques`Ilestparfoispr‚f‚rabled'appelerdirectementcettefonctionau
lieudepasserparheight_sliders(),parexemplesilafenˆtren'apas
d'ascenseurvertical,ousisapositionestinchang‚emaissatailleoui.
Voyez…lafonctionheight_sliders()cequiestdit…proposduparamŠtre
'fredraw'.

!************************
`!draw_object

`$Prototypage
voiddraw_object(intobject,intindex);

`$Description`Dessineunobjetfaisantpartied'unformulaire,d'unetoolbar
oud'unmenuenfenˆtre,ennedessinantquelapartievisible.

`$ParamŠtres
'object'Num‚rodel'objet…dessiner.
'index'IndexBIGdelafenˆtrequicontientleformulaire,latoolbarou
lemenu.

`$Remarques`Cettefonctions'utilisecommelafonctionGEMobjc_draw(),mais
uniquementpourlesformulaires,toolbarsoumenusenfenˆtre.Ellepermet
dedessinerunobjetquipourraitˆtrepartiellementhorsdelafenˆtreou
del'‚cran,ouquisontrecouvertsparuneautrefenˆtre.

!************************
`!print_page

`$Prototypage
voidprint_page(intindex);

`$Description`Cettefonctionr‚affichelecontenuentierd'unefenˆtreen
tenantcomptedespartiesrecouvertespard'autresfenˆtres,etc.

`$ParamŠtre
'index'IndexBIGdelafenˆtreconcern‚e.

`$Remarques`Silafenˆtreestdetypeformulaire,elleestredessin‚eau
moyendesfonctionsGEM.
Silecontenuestuneimage,Lafonctionvro_cpyfm()(sil'imagepossŠde
plusd'unplandecouleurs)ouvrt_cpyfm()(sil'imagenepossŠdequ'un
seulplandecouleur)estutilis‚esiuneimageesteffectivementstock‚e…
l'adresseindiqu‚eparwin[index].w_cont.w_img.w_blk.Sinon,rienn'est
fait,c'estlefonddelafenˆtrequiapparaŒt.
Danslesautrescas,lafonctionappellelaroutined'affichageindiqu‚e
parlepointeursurfonctionwin[index].w_redraw.
Cettefonctionneg‚nŠrepasdemessagederedrawartificiel,elledemande
directementlalistedesrectanglesdecettefenˆtre(quiestenpermanence
disponible,ilsuffitdelademanderauGEM).Ilnefautl'appelerquesi
unmessagederedrawn'estPASenvoy‚,sinonlafenˆtreseraitdessin‚e
deuxfois.
Cettefonctionneredessinequelazonedetravaildelafenˆtre,dupoint
devuedeBIG,c'est-…-direquelemenuoulatoolbarestignor‚(e)s'ily
ena.Sivousd‚sirezredessinerTOUTElafenˆtre,ilfaututiliserla
fonctionsend_mesag()enluidemandantd'envoyerunmessagederedraw
(WM_REDRAW)pourcettefenˆtre(win[index].w_hg),etsurlescoordonn‚es
donn‚esparwin[index].w_curr.

€!************************
`!next_wind

`$Prototypage
voidnext_wind(void);

`$Description`Cettefonctionfaitpasseraupremierplanlafenˆtresuivante
actuellementouverte.

`$Remarques`L'ordredesfenˆtresestceluideleursindexs.Cettefonction
cherchedanslemot3dubufferd'‚v‚nement(buf[3])lehandleGEMdela
fenˆtredontonacliqu‚leCYCLER.LapremiŠrefenˆtreouvertesuivant
celle-ciestamen‚eaupremierplan.Lafenˆtre"ded‚part"n'estpas
forc‚mentcelledepremierplan.

!************************
`!closed

`$Prototypage
voidclosed(void);

`$Description`Cettefonctionfermeunefenˆtreetlad‚truitdupointdevue
duGEM.

`$Remarques`L'‚l‚mentwin[index].w_hgdelastructureBigWindestmis…0
pourindiquerquelafenˆtre…d‚j…‚t‚ouverte,maisqu'elleest
actuellementferm‚e.
Silafenˆtrecontenaitunformulaire,Lazonem‚moirer‚serv‚epourla
sauvegardedeson‚tatestlib‚r‚e.Sielleposs‚daitunmenu,lazone
m‚moirer‚serv‚epourlaconstructiondecemenuestlib‚r‚e.Sielle
poss‚daitunetoolbar,lepointeurw_barestannul‚.
Cettefonctioncherchedanslemot3dubufferd'‚v‚nements(variable
globale'buf')lehandleGEMdelafenˆtre…fermer,cequiexplique
qu'aucunparamŠtreneluisoittransmis.
Toutefois,Sivousavezunefenˆtrecontenantdutexteparexemple,vous
devrezsansdoutecr‚erunefonctiondefermeturedefenˆtreetl'affecter
commepointeursurfonction…l'‚l‚mentw_closedelastructureBigWindde
cettefenˆtre,afinquevotrefonctionlibŠrelazonem‚moirer‚serv‚epour
letexte.Ilestfortementrecommand‚quevotrefonctionappelleelle-mˆme
lafonctionclosed(),maisvousdevrezavantcetappelmettrelehandleGEM
delafenˆtredanslemot3dubufferd'‚v‚nementspar:
`$buf[3]=win[index].w_hg;
`$closed();

!************************
`!iconise

`$Prototypage
voidiconise(intindex);

`$Description`Cettefonctionic“niseunefenˆtre.

`$ParamŠtre
'index'IndexBIGdelafenˆtreconcern‚e.

`$Remarques`Cettefonctionestautomatiquementappel‚eparBIGlorsd'unclic
surleSMALLER.Toutefois,ilpeutarriverqu'ond‚sireic“nifierune
fenˆtre…unautremoment.Danscecas,cettefonctiondoitˆtreappel‚e
parleprogramme.
Voyezlechapitre"L'ic“nisationdesfenˆtres"pourplusded‚tails.

!************************
`!uniconise
€
`$Prototypage
voiduniconise(intindex);

`$Description`Cettefonctiond‚sic“niseunefenˆtreetluirendsataille,sa
positionetsesattributsant‚rieurs.

`$ParamŠtre
'index'IndexBIGdelafenˆtreconcern‚e.

`$Remarques`Cettefonctionestautomatiquementappel‚eparBIGlorsqu'on
demande…d‚sic“nifierunefenˆtre(double-clicsurlafenˆtreic“nifi‚e).
Toutefois,ilpeutarriverqu'ond‚sireic“nifierunefenˆtre…unautre
moment.Danscecas,cettefonctiondoitˆtreappel‚eparleprogramme.
Voyezlechapitre"L'ic“nisationdesfenˆtres"pourplusded‚tails.

!************************
`!alliconise

`$Prototypage
voidalliconise(intindex);

`$Description`Cettefonctionic“nisetouteslesfenˆtresouvertes…cemoment
enuneseulefenˆtreic“nifi‚e.

`$ParamŠtre
'index'IndexBIGdelafenˆtre"maŒtresse",cellequidoitˆtreic“nifi‚e
etrepr‚senterenplustouteslesautres.

`$Remarques`Cettefonctionestautomatiquementappel‚eparBIGlorsd'un
Control-clicsurleSMALLER.Toutefois,ilpeutarriverqu'ond‚sire
ic“nifierunefenˆtre…unautremoment.Danscecas,cettefonctiondoit
ˆtreappel‚eparleprogramme.
Voyezlechapitre"L'ic“nisationdesfenˆtres"pourplusded‚tails.

!************************
`!set_work

`$Prototypage
voidset_work(intindex,intpattern,intcolorp);

`$Description`Cettefonctionsert…fixerlatrameetlacouleurdelazone
detravaild'unefenˆtre.

`$ParamŠtres
'index'IndexBIGdelafenˆtre.
'pattern'Num‚rodemotifdelatramechoisie.
'colorp'Indexdecouleurdelatrame.

`$Remarques`Lesnum‚rosdetramecorrespondent…ceuxutilis‚sparla
fonctionVDIvsf_style().Lemotifdetramen'estdoncpaslimit‚aux7
modŠlesdel'AES,maispeutprendreundes24motifspr‚vusparlaVDI.
Si'colorp'estnul(couleurblanche),lavaleurde'pattern'estignor‚e.
LazonedetravaildesfenˆtresBIGesttoujoursopaque.Celadispensede
devoir…chaquefoisla"vider"commeondoitlefairesyst‚matiquement
aveclesfenˆtresGEMtraditionnelles,etpermetdoncdechoisir
directementunetrameetunecouleurdanslessituationso—celaest
souhaitable(maisc'estsiraredanslapratique...).
Cettefonctionn'agitquesurunefenˆtred‚j…ouverte.Sazonedetravail
estalorsautomatiquementredessin‚e.PourfixerlesparamŠtresd'une
fenˆtreaumomentdesonouverture,voyezlafonctionopen_window().

!************************
€`!set_windows

`$Prototypage
voidset_windows (int mtxt_mover, int ctxt_mover,
     int spat_mover, int cpat_mover,
     int ctxt_info,
     int spat_velev, int cpat_velev, int spat_helev, int cpat_helev,
     int spat_vslid, int cpat_vslid, int spat_hslid, int cpat_hslid,
     int cpat_gadgt, int cicn_gadgt);

`$Description`CettefonctionpermetdemodifiercertainsparamŠtres
concernantl'aspectdesfenˆtresBIG.

`$ParamŠtres
'mtxt_mover'Moded'‚crituredelabarredetitrelorsquelafenˆtrese
trouveaupremierplan :Opaque(MD_REPLACE,1),Transparent(MD_TRANS,2),
Xor(MD_XOR,3)ouInversetransparent(MD_ERASE,4).
'ctxt_mover'Indexdecouleurdutextedelabarreded‚placement.
'spat_mover'Num‚rodetramedelabarreded‚placementlorsquelafenˆtre
estaupremierplan(jamaisdetramelorsqu'elleestenarriŠre-plan).
'cpat_mover'Indexdecouleurdelatramedelabarreded‚placement
lorsquelafenˆtreestaupremierplan(toujoursblanclorsqu'elleesten
arriŠre-plan).
'ctxt_info'Couleurdutextedelaligned'infos.
'spat_velev'Num‚rodetramedel'ascenseurvertical.
'cpat_velev'Indexdecouleurdelatramedel'ascenseurvertical.
'spat_helev'Num‚rodetramedel'ascenseurhorizontal.
'cpat_helev'Indexdecouleurdelatramedel'ascenseurhorizontal.
'spat_hslid'Num‚rodetrameduslidervertical.
'cpat_hslid'Indexdecouleurduslidervertical.
'spat_vslid'Num‚rodetramedusliderhorizontal.
'cpat_vslid'Indexdecouleurdusliderhorizontal.
'cpat_gadgt'Num‚rodetramedefonddesboutons.
'cicn_gadgt'Indexdecouleurdel'ic“nedesboutons.

`$Remarques`Si'-1'esttransmis…un‚l‚ment,ler‚glagecorrespondantest
inchang‚.Pard‚faut,etsilesystŠmedisposedemoinsde16couleurs,les
r‚glagessont :pourlabarreded‚placement,lemoded'‚critureest
"Opaque",lescouleursdetexteetdetramesontnoires,latrameestla
nø 2.Latramedesdeuxascenseursestlanø 1,sacouleurnoire.Demˆme
pourlatramedessliders,maislacouleurestblanche.Latramedefond
desboutonsestblanche,l'ic“neestnoire.
SilesystŠmedisposede16couleursouplus,lesdeuxascenseursetla
tramedesboutonssontentrame100 %etengris(couleur nø 8),afinde
donneruneimpressionderelief.
Quelquesoitlenombredecouleurs,latramedesboutonsestTOUJOURS
de 100 %.
Silacouleurd'unetrameestblanche,leparamŠtredemotifdetrameest
ignor‚lorsdudessindel'objetcorrespondant.
Lesnum‚rosdetramecorrespondent…ceuxutilis‚sparlafonctionVDI
vsf_style().Lemotifdetramen'estdoncpaslimit‚aux7modŠlesde
l'AES,maispeutprendreundes24motifspr‚vusparlaVDI.
Lesr‚glagesaffectenttouteslesfenˆtresdel'application.
Lafonctiontestes'ilyaaumomentdel'appeldesfenˆtresformulaireou
desfenˆtresavectoolbarouvertes.Sielleentrouve,cesfenˆtressont
entiŠrementredessin‚espouractualiserlesnouveauxr‚glages.Donc,cette
fonctionnedoitjamaisˆtreappel‚elorsqueleGEMest"gel‚"parun
formulairebloquantouautre.

!************************
`!bwind_calc

`$Prototypage
€voidbwind_calc(intrequest,intattr,
               inttree,OBJECT*adrb,
               intxd,intyd,intwd,inthd,
               int*x,int*y,int*w,int*h);

`$Description`Cettefonctionestl'‚quivalentdelafonctionGEMwind_calc(),
adapt‚eauxfenˆtresBIG.Ellere‡oitenparamŠtressoitlescoordonn‚es
totalesdelafenˆtre,soitlescoordon‚nesdelazonedetravail,et
fournitlesautresenretour.

`$ParamŠtres
'request'Si0(WC_BORDER),lafonctionre‡oitlescoordonn‚esdelazone
detravailetfounitcelledelazonedetravail.Si1(WC_WORK),c'est
l'inverse.
'attr'Attributsdelafenˆtre(masquedebits).
'tree'Silafenˆtrecontientunebarredemenuouunetoolbar,num‚ro
d'arbredumenuoudelatoolbar.Ilest‚galementpossibledetransmettre
directementl'adressedel'arborescence(paramŠtresuivant).Danscecas,
leparamŠtre'tree'doitˆtre‚gal…-1(BLANK).
'adrb'"ADresseBarre"Adressedelabarredemenuoudelatoolbars'ily
enaetsileparamŠtrepr‚c‚dent('tree')est‚gal…-1.Si'tree'est
significatif,'adrb'doitˆtrenul.Silafenˆtren'animenu,nitoolbar,
leparamŠtre'tree'doitimp‚rativementˆtre…-1et'adrb'imp‚rativement
…z‚ro.
'xd','yd','wd','hd'Coordonn‚esded‚parttrasmises…lafonction,
c'est-…-diresoitcellesdelazonedetravail,soitcellesdetoutela
fenˆtre.
'x','y','w','h'Variablesderetourdanslesquelleslafonctionplace
lescoordonn‚esdemand‚es.

`$Remarques`SousBIG,ilestformellementinterditd'utiliserlafonctionGEM
wind_calc().Ilfautabsolumentutilisercelle-ci.
Par"zonedetravail",ilfautcomprendre"zoned'affichage",c'est-…-dire
mis…partles‚l‚mentdelafenˆtre(ascenseurs,boutons,etc),maisaussi
mis…partlemenuoulatoolbars'ilyena.

!************************
`!draw_title

`$Prototypage
voiddraw_title(intindex);

`$Description`Cettefonctionredessinelabarredetitred'unefenˆtre,
etuniquementlabarredetitre.

`$ParamŠtre
'index'IndexBIGdelafenˆtre.

`$Remarque`Danslecaso—l'ond‚sirechangerletitred'unefenˆtre,il
fautfairepointerl'‚l‚mentw_titledelafenˆtreverslenouveautexte
(oumodifierl'ancien),puisappelercettefonctionafinquel'affichage
soitactualis‚.

!************************
`!path

`$Prototypage
char*path(char*pat);

`$Description`Cettefonctionretournelecheminpard‚fautdel'application
(lechemino—chercherleressourceetlefichierdeconfiguration,par
exemple).

€`$ParamŠtres
'pat'estunpointeursurunechaŒnequicontiendraenretourlecheminpar
d‚faut.Elledoitˆtredetaillesuffisante.
retour:UnpointeursurlachaŒne.

`$Remarques`Lafonctionplacelechemindanslavariablederetour'pat',et
retourneenplusunpointeursurcettechaŒne.Cettefonctionexistepour
desraisonsdecompatibilit‚saveclesanciennesversionsdeBIG.
D‚sormais,lechemindel'applicationsetrouvedanslavariable"pathapp".

!************************
`!exist

`$Prototypage
longexist(char*name,intatt);

`$Description`Siunfichierparticulierexiste,retournesataille,sinon
retourne'FALSE'(0).

`$ParamŠtres
'name'estunpointeursurlachaŒnedunomdufichier…chercher,avec
‚ventuellementl'indicationduchemin.Lesjockers'*'et'?'peuventˆtre
utilis‚s.
'att'estunmasquedebitsrepr‚sentantlesATTributsdufichier…
chercher,selonlarŠgleGEMDOS.
retour:Lafonctionretournelatailledufichier(enoctets)…la
premiŠreoccurencetrouv‚e,FALSEsiellen'entrouvepas(ousilefichier
…unetaillenulle,attention !).

`$Remarque`Sile"fichier"estundossier,lafonctionretourneTRUEou
FALSE.

!************************
`!set_palette

`$Prototypage
voidset_palette(intindex);

`$Description`Cettefonctionfixedenouvellesvaleurspourlapalettede
couleurs.

`$ParamŠtres
'index'estl'indexBIGdelafenˆtrequial'adressedelanouvelle
palettedanssastructure.Si'-1'esttransmiscommeindex,lapalettepar
d‚fautestrestaur‚e.

`$Remarques`Vouspouvezappelerdirectementcettefonction,parexemplepour
restaurerlapalettepard‚faut…lademandedel'utilisateur.

!************************
`!timer

`$Prototypage
longtimer(void);

`$Description`Cettefonctionretournelavaleurdutimer200Hzaumomento—
elleestappel‚e.

`$ParamŠtres
retour:Valeurdutimer.

`$Remarques`CettefonctionesttrŠsutilepourservirparexempledecompte…
reboursoupourmesurerdesintervallesdetemps.
€
!************************
`!trim

`$Prototypage
char*trim(char*str);

`$Description`Cettefonction‚liminelesespacesetlestabulationsded‚but
etdefind'unechaŒne.LachaŒnetransmiseestmodifi‚eenm‚moire,etun
pointeurlad‚signantestretourn‚parlafonction.

`$ParamŠtres
'str'PointeursurlachaŒne…traiter.
retour:PointeursurlapositiondelachaŒneenm‚moire.

!************************
`!send_mesag

`$Prototypage
voidsend_mesag(inttype,intwi,
intx,inty,intw,inth);

`$Description`Cettefonctionpermet…l'applicationdes'envoyer…elle-mˆme
unmessage,demaniŠre…simulerun‚v‚nement.

`$ParamŠtres
'type'Typedel'‚v‚nement(GEMouBIG).Ilseraplac‚danslemot0du
bufferd'‚v‚nement.
'wi'"WIndow".Seraplac‚danslemot3dubuffer.Souvent,c'estlehandle
GEMd'unefenˆtre.
'x'Seraplac‚danslemot4dubuffer.Souvent,c'estunecoordonn‚eenx.
'y'Seraplac‚danslemot5dubuffer.Souvent,c'estunecoordonn‚eeny.
'w'Seraplac‚danslemot6dubuffer.Souvent,c'estunelargeurdezone.
'h'Seraplac‚danslemot7dubuffer.Souvent,c'estunehauteurdezone.

`$Remarques`IlestparfoistrŠsutiledes'envoyer…soi-mˆmedesmessages,
pourg‚n‚rerunredrawparexemple.

!************************
`!selector

`$Prototypage
intselector(char*pat,char*ext,char*file,char*title,intfselbig);

`$Description`CettefonctionappelleetgŠreles‚lecteurd'objetsGEM.

`$ParamŠtres
'pat'"PATh".PointeursurunechaŒneindiquantlechemind'accŠs…ouvrir
dansles‚lecteur,sansl'extension…filtrer.AprŠslafonction,pointe
surlecheminchoisidansles‚lecteur(lachaŒnedoitˆtreassezlongue).
'ext'"EXTension".Extension(ounomsdefichiers)…filtrerdansle
s‚lecteur.Lesjockers'*'et'?'sontautoris‚s.Parexemple"\*.DOC"ou
"\BIG*.*".
'file'PointeursurunechaŒnecontenantlenomdufichier…
"pr‚s‚lectionner"dansles‚lecteur,ouchaŒnevides'iln'yapasde
fichierpard‚faut.AprŠslafonction,lachaŒne(quidoitˆtreassez
longue)contientlenomdufichiers‚lectionn‚.
'title'PointeursurlachaŒne…afficherdansles‚lecteurd'objet,…
partirduTOS1.4.
'fselbig' Flag.S'ilvautFALES,c'estles‚lecteurstandardquiest
utilis‚.S'ilvautTRUE,c'estles‚lecteurBIG2.Voirplusbassa
description.
retour:TRUEsiles‚lecteurestquitt‚aveclebouton'OK',FALSEs'il
€estquitt‚aveclebouton'Annuler'.

`$Remarques`S'ilfautappelerles‚lecteurstandard,lafonctiontestele
num‚rodeversionduTOSetr‚aliseunappelfsel_input()(TOSant‚rieur…
1.4)oufsel_exinput()(TOS1.4ouplus).CommelafonctionGEM,selector()
retourne0si'Annule'a‚t‚choisi.
Siles‚lecteurestappel‚pourchoisirunfichier,ilfauttester:
`$if(selector(path,ext,name,title)==TRUE&&strlen(name))
Afindev‚rifierquec'estlebouton'OK'quia‚t‚cliqu‚etqu'unnomde
fichierabien‚t‚choisi(L'utilisateurpourraitconfirmersanschoisirde
fichier).
Siles‚lecteurestappel‚seulementpourdemander…l'utilisateurun
chemin(lenomdufichiern'apasd'importancedanscecas),ilsuffitde
tester:
`$if(selector(path,"\*.*",name,title)==TRUE)
Laprincipalediff‚renceentrecettefonctionetl'appeldirectdela
fonctionGEMestquelechemind'accŠsretourn‚parcettefonctionaprŠs
l'appelestd‚pouill‚dufiltred'extension.Parexemple,pouracc‚derau
fichierchoisiparl'utilisateur,ilsuffitdeconcat‚nerlesdeuxchaŒnes
par"strcat(path,name);"pourobtenirsonchemincompletdans'path'.
Les‚lecteurBIG2a‚t‚pr‚vudansundoublebut.D'unepart,unemeilleure
ergonomie(facilit‚d'utilisation),d'autrepartpouraffichedavantage
d'objets.Ilenaffiche 25,danslapetitefonte 8x8.Certainss‚lecteurs
deremplacementutilisentlatoutepetitefonte 6x6,maisletexteest
alorspresqueillisible.
Letrieffectu‚estuntriparextension.
Latouche<Help>afficheencoursd'utilisationunr‚sum‚descommandes.
Latouche<Tab>effectueunebasculeentrelefiltredemand‚(parexemple
"*.TXT")etlefiltre"*.*".
Lelecteurderecherchepeutˆtrechang‚soitparclicsurlalettre
correspondante…droite,soitparlacombinaisaon<Alt + lettre>.
Latouche<Insert>faitremonterd'unniveau.Lacombinaison<Shift +
Insert>ramŠne…laracine.
Lestouches<flŠchehaute>et<flŠchebasse>fontmonteroudescendrela
lignedel'objets‚lectionn‚.Siaucunobjetn'estencores‚lectionn‚,
c'estlepremierouledernierdel'affichage(selonlaflŠche)quiest
alorss‚lectionn‚.
Lescombinaisons<Control +flŠchehaute>et<Control +flŠchebasse>font
monteroudescndrel'affichaged'uneligne.Avec<Shift>,unepageentiŠre
estremont‚eouredescendue.
Latouche<Clr>amŠnel'affichageaud‚butdelaliste,lacombinaison
<Shift +Clr>l'amŠne…lafin.
Undouble-clicsurlaligneduchemincourantamŠnelarechercheausous-
dossierainsid‚sign‚.
Undouble-clicsurunedesflŠchesded‚filementamŠnel'affichaaud‚but
ou…lafindelaliste,selonlaflŠche.
Undouble-clicsurundossierl'ouvre.
Undouble-clicsurleboutondefermeturedudossierramŠne…laracine.
Undouble-clicsurunfichierquittelafonction,lefichier‚tantchoisi.
Lorsqu'undossierests‚lectionn‚,unepressionsur<Return>ou<Enter>
l'ouvre.Sic'estunfichier,l'appeldelafonctionesttermin‚,le
fichier‚tants‚lectionn‚.
Sionsaisidutextedanslalignedes‚lection,lepremierobjetdela
liste(dansl'ordred'affichage)dontlespremierscaractŠrescorrespondent
…lasaisieests‚lectionn‚.Sionclique"Confirme"(ouqu'onpresse
<Return> /<Enter>),lefichierestchoisi,mˆmesisonnomn'apparaitpas
entiŠrementdanslalignedesaisie.
Danstouslescaso—undouble-clicestutilisable,onpeutluisubstituer
unclicdroit.

!************************
`!extension

€`$Prototypage
voidextension(char*filename,char*ext);

`$Description`Cettefonctionimposeuneextension…unnomdefichierou…un
chemind'accŠs.

`$ParamŠtres
'filename'Pointeursurlenomdufichierousurlechemincomplet.
'ext'"EXTension".Pointeursurl'extension…imposer.L'extensiondoit
ˆtretransmiseaveclepoint,parexemple".DOC".Ilestpossiblede
transmettreunechaŒnevide("")poursupprimerl'extension.

`$Remarques`Cettefonctionestextrˆmementpratiqueparexemplepourˆtre
certainqu'unfichierserasauv‚avecuneextensionpr‚cise.AprŠsla
saisiedunomdefichierdansuns‚lecteurparl'utilisateur,cette
fonctionpeutˆtresyst‚matiquementappel‚edemaniŠre…"forcer"
l'extensiondufichier.
Ellepeut‚galementˆtreutiledanslecasd'unprogrammeg‚rantunes‚rie
defichiersplac‚sdanslemˆmecheminettousdemˆmenom,dontseule
l'extensionchange(castypiquedesbasesdedonn‚es).AvantchaqueaccŠs…
unfichier,l'extensionvoulueestimpos‚e.

!************************
`!rc_intersect

`$Prototypage
intrc_intersect(GRECT*p1,GRECT*p2);

`$Description`Indiques'ilyaunepartiecommuneentredeuxzonedel'‚cran,
etlaquelle.

`$ParamŠtres
'p1'StructureGRECTd‚crivantlescoordonn‚esdelapremiŠredesdeux
zones.
'p2'StructureGRECTd‚crivantlescoordonn‚esdelasecondedesdeux
zones.Lesdonn‚esdecettestructureserontmodifi‚esparlafonction.
retour:Z‚ros'iln'yapasdepartiecommune,valeurnonnulles'ilyen
aune.

`$Remarques`Lapartiecommuneentrelesdeuxzonesestd‚criteaprŠsl'appel
dansleparamŠtre'p2'quiestutilis‚commevariablederetour.Les
valeursquis'ytrouvaientsontperdues.
Cettefonctionestutilis‚epourletraitementdesmessagesderedraw,o—
ilfautd‚terminersilazonedetravailunefenˆtredonn‚eestdansla
zone…redessiner.
SousLatticeC,lafonctiondevient"brc_intersect()".Leprototypageet
toutlerestesontidentiques.

!************************
`!clipp

`$Prototypage
voidclipp(intclip_flag,GRECT*area);

`$Description`Cettefonctionactiveoud‚sactiveleclippingd'unezonede
l'‚cran.

`$ParamŠtres
'clip_flag'Truesileclippingdoitˆtreactiv‚,FALSEs'ildoitˆtre
d‚sactiver.
'area'PointeursurunestructureGRECTd‚crivantlazoned'‚cran
concern‚e.

€`$Remarques`Cettefonctionestutilis‚epourletraitementdesmessagesde
redraw,pourˆtres–rqueledessinencoursned‚borderapasdelazone
surlaquelleontravaille.

!************************
`!first_cookie

`$Prototypage
COOKIE*first_cookie(void);

`$Description`CettefonctionretourneunpointeursurlepremierCookiedu
cookiejar,ouunpointeurnuls'iln'yenapas.

`$ParamŠtres
retour:Pointeursurlecookie.

!************************
`!next_cookie

`$Prototypage
COOKIE*next_cookie(COOKIE*ck);

`$Description`CettefonctionretourneunpointeursurleCookiesuivantdu
cookiejar,ouunpointeurnulquandiln'yenaplus.

`$ParamŠtres
'ck'Pointeursurlecookiepr‚c‚dent.
retour:Pointeursurlecookie.

`$Remarques`Cettefonctions'utiliseencollaborationavecfirst_cookie().

!************************
`!vq_cookie

`$Prototypage
COOKIE*vq_cookie(longid);

`$Description`CettefonctionchercheunCookied'identificateurdonn‚,et
retourneunpointeursurceCookie,ouunpointeurnuls'iln'estpas
trouv‚.

`$ParamŠtres
'id'Pointeursurlecookiepr‚c‚dent
retour:PointeursurleCookie.

`$Remarques`Cettefonctionutilisefirst_cookie()etnext_cookie().

!************************
`!vq_cookie_c

`$Prototypage
COOKIE*vq_cookie_c(char*c);

`$Description`CettefonctionchercheunCookieparlescaractŠresdeson
identificateur,etretourneunpointeursurceCookie,ouunpointeurnul
s'iln'estpastrouv‚.

`$ParamŠtres
'c'PointeursurlachaŒnedecaractŠrequid‚finielecookie.
retour:PointeursurleCookie.

`$Remarques`Cettefonctionutilisevq_cookie().

€!************************
`!     fill_tab

`$Prototypage
voidfill_tab(int*pxy,intn,...);

`$Description`Cettefonctionremplituntableaud'entiers.

`$ParamŠtres
'pxy'Adresseded‚partdutableau.
'n'Nombred'‚l‚mentsdutableau.
LesparamŠtressuivants,denombren,sontlesvaleurs…placer
successivementdansles‚l‚mentsdutableau.Ilssontimp‚rativementde
typeint.

!************************
`!empty

`$Prototypage
voidempty_kbd(intevnmt);

`$Description`Cettefonctionattendquesoitlebufferclavier,soitle
buffermessage(variableglobale'buf')soitvideetnerendlamainqu'…
cemoment-l….

`$ParamŠtre
'evnmt'CeparamŠtreestsoitMU_KEYBD(1)pourviderlebufferclavier,
soitMU_MESAG(16)pourviderlebuffermessage.Touteslesautresvaleurs
sontignor‚es.

!************************
`!LesourcedeBIGdemo

Mˆmes'iln'estpastrŠscompliqu‚ensoit,leconceptdeprogrammation
sousBIGdoitsansdouteparaŒtreunpeuconfus…celuiquil'abordepour
lapremiŠrefois.Sivousavezlulapr‚sentedocumentationjusquel…,vous
savezenprincipetoutcequ'ilya…savoirpourcommencer…travailler.
Pourtant,ilestprobablequedanslapratiquecenesoitpasaussiclair!
Nousallonsaborderl'‚tudedusourcedelad‚mo.Jevousconseillede
l'‚tudierattentivement,ilcontientsansdoutelar‚ponse…laplupartde
vosquestions.Pourcellesquiresteraientsansr‚ponse,ous'ilsubsiste
desdoutes,n'h‚sitezpas…mecontacter.
Ilseraitfastidieuxd'examinertoutesleslignesdusourceuneparune,
nousnouscontenteronsded‚taillerlespartiesrelatives…BIG.

!************************
`!Leressource

Commenousl'avonsd‚j…faitremarqu‚,unegrandepartiedesinformations
etdelastructureduprogrammesetrouvedansleressource.Jetons-lui
doncuncoupd'oeil.

* Lepremierarbreestceluidumenu.Lesoptions"BIGdemo/Infos",
"Formulaires/Formulairelibre","Fenˆtres/Petitformulaire"et
"Fenˆtres/Grandformulaire"sontdetypepointeursurfonction.Une
fonctiondoitdoncleurˆtreassoci‚e.Nousn'avonsriend'autre…faire
qued'indiquerletypeB_FNCP(51)commetype‚tendu.

L'option"Fenˆtre/Fenˆtrenormale"doitappelerunmenuhi‚rarchique.
Nouspla‡onsunepetiteflŠche…droitedel'option(BIGremplacel'avant-
derniercaractŠreparuneflŠcheversladroiteoulagauche),etsurtout
noussignalonsletypeB_HIERM(41),ainsiquelenum‚roduformulaire
associ‚dansl'octethautdel'ob_state‚tendu(lanum‚rotationdes
€formulairescommence…z‚ro).

* Leformulairebureauvientensuite.LaboŒtedefondseraredimensionn‚e
parBIGenfonctiondelatailledubureaudanslar‚solutioncourante.Il
yaunobjetcach‚(HIDETREE).Ils'agitd'uneG_BOXdetypeBIGB_PICT.
Cetobjetservira…afficherl'imagedubureau,sitoutefoislefichier
correspondantexiste.Outresontype‚tendu,l'objetpossŠdeunob_state
‚tendu,cequisignifiequel'imagedoitˆtreaffich‚eaumoyendela
fonctionVDIvrt_cpyfm,etquelespoints"mis"del'imageserontbleus
(couleurindiqu‚eparl'octethautdel'ob_state).
LesdeuxtextesdelaboŒtesontdesB_SMSTR.Ilsserontdontaffich‚sen
petitscaractŠres.CeluiduhautpossŠdeenoutreunbitBackGround(il
sera‚critentransparent)etunbitBS_RIGHT(Letexteseracal‚…
droite).LesautresobjetsnepossŠdentaucunattributparticulier.BIG
traitelebureauunpeudiff‚remmentdesautresformulaires,etinformele
programmedetoutcequis'ypasse.C'estleprogrammequidoitagiren
cons‚quence.Maislesobjetsdubureaunedoiventposs‚derAUCUNflagEXIT,
TOUCHEXIT,etc.

* Leformulaireprincipaldelad‚moestpluscomplexe.LaG_BOXquiest
l'objet-racinedeceformulairepossŠdeunfondblancsanstrame.Comme
nousleverronsdansl'‚tudedusource,cefondseraremplac‚eenmode16
couleursouplusparunetrame100 %decouleur8(grisclair),afin
d'obteniruneffetderelief.

LachaŒnegraphiqueporteletype‚tenduB_GRASTR(19)etlesattributs
graphiquesdansl'ob_state,demˆmequelesdeuxcadresB_FRAME(20).Les
radio-boutonssontdetypeB_SELEC(18)aveclesattributsobligatoires
SELECTABLEetRBUTTON.Lesboutonscoch‚ssontidentiques,sansˆtre
RBUTTON.NousindiquonspourchacundecesboutonslecaractŠre
d'‚quivalentclavierenlefaisantpr‚c‚derd'un'['.BIGsechargeradu
reste,maisnousdevonsnousassurerqu'uncaractŠren'estpasutilis‚deux
foisdanslemˆmeformulaire.Certainsdesradio-boutonsetdesboutons
s‚lectabledoiventˆtredessin‚savecletexte…gaucheetlebouton…
droite.Nousledemandonsenpositionnantle13øbitdel'ob_flags(nomm‚
BS_RIGHT).Nouspositionnons‚galementlebit 11(DcDefault)afinquele
boutonpard‚fautsoitactiv‚encasdedouble-clic.

Leboutond'alerteestunpointeursurfonction.Pla‡onsletypeB_FNCP.

Nousaffectonsaupop-uptexteletype‚tenduB_POPUPafinqu'ilsoit
dessin‚enaccordaveclefond(pourlesbesoinsdela3D),etqu'ilsoit
munid'uneic“ne"optionsuivante".Lepop-upimagen'apasdetype‚tendu,
mais(commelepop-uptexte)ilestobligatoirementSELECTABLEetSHADOWED.
LarŠglesousGEMestdedonnerl'attributSHADOWEDauxboutonspop-up,
afindelesdistinguerplusfacilement.C'estuneobligationsousBIG.Mais
commecetattributn'aaucunecons‚quencevisuellesurunobjetdetype
G_IMAGE,nouspla‡onscetobjetdansuneG_BOXSHADOWEDpourrespecterla
tradition.Jevousconseilledefairetoujoursainsidanslecasdepop-up
image.

Lepremierdesdeuxchamps‚ditablesestdetypeB_EDIT.Nouspla‡onsdonc
dansl'ob_statelalongueur(encaractŠres)dutextequ'ilvapouvoir
accueillir(50,vouspouvezlachanger).N'oublionspaslespetitesflŠches
departetd'autre,nilesespacesquilesaccompagnent(voirlechapitre
"Les‚ditables‚tendus").Lesecondchamp‚ditableestencaractŠresde
petitetaille.

Leboutonded‚placementduformulaireestplac‚danslecoinsup‚rieur
droit.C'estuneG_IBOXOUTLINED,CROSSEDetTOUCHEXITdetype‚tendu
B_MOVE(17).

Lebouton'Confirme'seraleboutonpard‚faut.Nousluidonnonsenoutre
€letypeB_UNDERafinqu'ilaitun‚quivalentclavierparcaractŠresoulign‚
etqu'ilsoitdessin‚en3D.'Annule'doitˆtreactiv‚parlatouche
<Undo>,donnons-luidoncletype‚tenduB_UNDO(31),etaffectons-lui
‚galementuncaractŠresoulign‚.Nouspla‡onsaussiunboutond'aidequi
seraactiv‚parlatouche<Help>,souslaformed'uneG_BOXTEXTOUTLINED,
SHADOWEDenpetittexte,detypeB_HELP(21),etlenum‚roduformulaire
d'aideassoci‚dansl'ob_state‚tendudubouton.

Afinquel'ensembleaitunaspect3D,nousactivonslebitBackGround(le
bit10d'ob_flags)…lachaŒnedetitre,auxdeuxB_FRAMEs,aupop-up
texte,aux‚ditablesetauxdeuxboutonsdesortie.

* Noustrouvonsensuitelesdeuxformulairespop-uptexteutilis‚sparla
d‚mo.LesoptionssontdesG_STRINGsdontcertainessontDISABLED.Nousles
faisonspr‚c‚derpardeuxespacespourr‚serverlaplacedelacheck-mark.
LasurfaceentiŠredelaboŒteracinedoitˆtrerecouverte.CetteboŒteest
SHADOWED,toujourspourrespecterlesnormes.Ilestinterditdeplacerun
B_FNCPdansunpop-up.Lepremierdecespop-upsest‚videmmenttrophaut
(avecses60options)pourˆtreaffich‚surl'‚cran.Ilseraaffich‚soit
enpop-liste(surdemande),soitenscroll-menu(automatiquement).

* LaboŒted'informationpossŠdedeuxboutonsB_HELP.Lepremierdans
l'ordredenum‚rotation('Contact')seraactiv‚parlatouche<Help>,mais
paslesecond,qu'ilfaudraimp‚rativementlecliquer…lasouris.Par
contre,ilserag‚r‚internementparBIGcommeuneaide,sansintervention
duprogrammelui-mˆme.L'imageestadapt‚e…lahauter‚solutionetsera
d‚form‚eencouleur,cequin'estpasbiengravepourlad‚mo.Jen'aipas
voulucompliquerleschoses.

* Leformulairesuivantestuneaide.NousytrouvonsunB_GRASTR,des
B_FRAMEs(cesdeuxtypesd'objetsayantlebitBackGroundindispensable…
la3D),etunboutondesortiedontlapr‚senceestobligatoireavecles
attributsEXIT,SELECTABLEetDEFAULT.

* Nousarrivonsaupetitformulaireenfenˆtre.Lesboutons'Confirme'et
'Annule'doiventfermerlafenˆtre.Nousdevonspourcelapositionnerle
bit 12del'ob_flags(nomm‚WFCLOSE).Lesboutons'Applique'et'R.A.Z.'
serontrespectivementactiv‚sparlestouches<Return>et<Undo>,maissans
fermerlafenˆtre.Vouspouvezfairel'exp‚rienced'oterlebitde
fermeturedesdeuxpremierspourlesplacerdanslesdeuxautres.Ce
formulairepossŠdeenoutredeuxpop-upsboŒtesquipermettentdechoisir
latrameetlacouleur…affecteraubureau,ainsiquequatreschamps
‚ditables,dontdeux‚tendusetdeuxdepetitetaille.
Ceformulaire‚tantdestin‚…ˆtredessin‚en3D,nouspositionnonslebit
BackGrounddesobjetslorsquecelaestn‚cessaire(les‚ditables,les
boutonsetletitre).
Nouspositionnonsaussilebit 15del'ob_flags(NOTOP)del'objet-racine
afinqueceformulairepuisseˆtremanipul‚mˆmelorsquesafenˆtren'est
pasenpremierplan.

* Legrandformulairenepr‚senteriendenouveau,certainsdesesB_RADIOs
etB_COCHEsontletexte…gauchedubouton,d'autres…l'inverse.Ils
possŠdenttouslebitDcDefault.LebitNOTOPdelaracineestpositionn‚,
pourlesmˆmesraisonsquepourlepetitformulaireenfenˆtre.

* L'arbresuivantestlemenudefenˆtre.Dansl'‚diteurderessource,nous
lecr‚onscommeunmenuordinaire.BIGsechargeradele"fenˆtriser".Nous
nouscontentonsdesupprimertouslesemplacementsr‚serv‚saux
accessoires.L'option'Infos'estunB_FNCP.L'option'Ic“nes'dumenu
'Alertes'estuneB_HIERM.

* Voiciensuitelemenuhi‚rarchiquedumenuprincipal.Ilestcr‚‚comme
unpop-upordinaire,maisonpeutyplacern'importequeltyped'objet.
€Danslecasdelad‚mo,les2premiŠresoptionssontdetypeB_FNCP,pasla
troisiŠme.

* Nousarrivonsaupop-upimage.Ilestconstitu‚deG_IMAGEs.Lesmˆmes
remarquesquepourlespop-upstextes'appliquentici.

* L'arbresuivantestlepop-uplibre,entoutpointsemblable…unpop-up
texteappel‚parunboutondeformulaire,maisilpeutposs‚derdesB_FNCPs
(c'estlecasdanslad‚mo).

* Leformulaired'aide"CONTACT"auneparticularit‚:ilnecomporte
apparemmentpasdeboutondesortie.Pourtant,nousavonsvuquec'est
obligatoire!Enfait,uneG_IBOXEXITDEFAULTSELECTABLEsanscadre
recouvretoutelasurfaceduformulaire.Ainsi,onnelavoitpasmaiselle
estbienl…etonpeutcliquern'importeo—poursortir.

* Unautreformulaired'aidevientalors.

* Leformulairesuivantestlemenuhi‚rarchiquedumenuenfenˆtre.Seules
lesdeuxpremiŠresoptionssont"normales",lesautres‚tantdesB_FNCPs.

* Ensuitenoustrouvonsleformulairederemerciements,quiestbƒtisurle
mˆmemodŠlequeceluiducontact.

* Nousd‚couvrons…pr‚sentlatoolbardelafenˆtretexte.Untel
formulaireestconstruitcommen'importequelautre,avecdes‚quivalents
claviers,despop-ups,etc.SontbannislesobjetsEXITouTOUCHEXIT,ainsi
queleschamps‚ditables.L…encore,nouspr‚voyonsl'aspectdereliefpour
letravailencouleur(bitBackGroundo—c'estn‚cessaire),etlebitNOTOP
pourl'objet-racineafinquelatoolbarsoitmanipulablelorsquelafenˆtre
estenarriŠre-plan..

* Enfin,viennentlesdeuxformulairespop-upsappel‚sparlatoolbar.Le
premierpourlestaillesdecaractŠre,lesecondpourlespolices.Celui-ci
estconstitu‚de41G_STRINGs,dontseulelapremiŠreestpourl'instant
active.C'estlapolice"SystŠme",pard‚faut.LesautreschaŒnessontpour
l'instantDISABLEDs,etcontiennentdestextesderemplissageprovisoires.
Lad‚modevralesremplacerparlesnomsdespolicescharg‚es,etles
activer.

* Noustrouvons…pr‚sentlesdeuxformulairesdespop-upsboŒtesdupetit
formulaireenfenˆtre.Ilssontconstitu‚suniquementdeG_BOXsTOUCHEXIT.
Lepremierrepr‚sentelechoixdelatrame,lesuivantdelacouleur.

* AprŠslesformulairesviennentleschaŒneslibres.LapremiŠreesten
faitunealerte.Ellepeutˆtreconstitu‚ede5lignesde31caractŠres
chacune(lepremier‚tantg‚n‚ralementunespacepourdesraisons
esth‚tiques,ilenreste30),etde3boutonsde20caractŠreschacun.9
dessinsd'ic“nessont…votredisposition(Voirladescriptiondela
fonction`$big_alert()`danslegroupedesfonctionsdegestiondes
formulaires).

* L'alertesuivanteestcellequiestaffich‚eparlemenuhi‚rarchiquede
lafenˆtreavec…chaquefoisuneic“nediff‚rente,etlatroisiŠmeest
celleappel‚eparlebouton'Alerte'duformulaireprincipal.

* LeschaŒnessuivantessontdansl'ordrelestitresdesfenˆtres'Petit
formulaire'et'Grandformulaire',lestextesdes‚lecteurd'objet'Charger
texte'et'Chargerimage',Lestitresdesdeuxfenˆtrescorrespondantes,le
titredelafenˆtreavecmenu,celuidelafenˆtred'histogrammesetsa
ligned'informations.OntrouveensuitelachaŒnequiserautilis‚elorsque
lad‚moestlanc‚eenaccessoire:cellequiapparaŒtradanslemenu,puis
cellequiserviradetitre…lafenˆtreprincipaleouverteencasde
€fonctionnementenaccessoiredebureau.Ilestrecommand‚,surtoutsous
BIG,deplacer`!tous`lestextesutilis‚sparl'applicationdansle
ressource.PremiŠreraison:c'estdupurGEM.Seconderaison:danslecas
d'unressourceexterne,celarendplusfacilelamodification(pourune
traductionouunchangementderaccourcisclavierparexemple)puisqu'il
n'estpasn‚cessairederecompilerlesource.Deplus,(surtoutsile
ressourceestint‚gr‚),celahomog‚niselafa‡ondetraiterceschaŒnes.

* LeschaŒneslibressuivantessontlestextesdesdiff‚rentesbulles
d'aideutilis‚esparlad‚mo.

* Finalement,lesdeuxderniersobjetsduressourcesontdeuximages
libres :cellesquiserontutilis‚espourledessindesfenˆtres
ic“nifi‚es.Uneimagepourlesfenˆtresdetypeformulaire,uneimagepour
lesautres.
Nousavonsfaitletourduressourcedelad‚mo.Commevousl'avezvu,
beaucoupdechosesyfigurent,nonseulementl'aspectdesformulaireset
desobjets,maisaussiunebonnepartiedelastructureduprogramme,grƒce
auxpointeurssurfonctionsetauxpop-upsetaidesassoci‚s.

!************************
`!Lesource

J'aiessay‚der‚aliseruned‚mocomplŠte,pr‚sentantlaprogrammationde
touslesaspectsimportantsdeBIG.Ainsi,certainsappelsdefonctionsse
fontparB_FNCPetd'autresnon,afindemontrercommenttraiterles
‚v‚nementsBIGetd'autrespoints.S'ils'‚taitagitd'unprogramme
"normal",certainespartiesauraient‚t‚trait‚esdemaniŠreencoreplus
simple.Cetted‚mo,commesonnoml'indique,estuned‚monstrationnon
seulementdecequeBIGpeutr‚alisercommetyped'interface,maisausside
commentprogrammertouslesd‚tailsdeBIG.Lesourceauraitpuˆtreencore
pluscourt!

Jevousrecommandeencoreunefoisdeprendreletempsdel'‚tudier…fond,
pratiquementtouteslestechniquesded‚veloppementsousBIGysont
repr‚sent‚es.

LapremiŠreligne"`$#include<big.h>`"estparticuliŠrementimportante,
c'estellequiouvrelaporte…BIG.Vousnoterezquelad‚mon'utiliseque
cinqvariablesglobales.Troissontn‚cessairespourlagestiondespolices
SpeedoGDOS,cequin'arien…voiravecl'interfaceproprementdite
(j'avoueavoirinclucettegestion…lad‚mopourmefaireunpetit
plaisir).Lesdeuxautresvariablessontutilis‚esparl'imagedebureau.
Laprogrammationd'uneinterfacesousBIGnen‚cessitenormalementaucune
autreglobalequecellesquisontd‚finiesparBIG.H.
Ensuite,noussignalonsaucompilateurquenoustravaillonsavecun
ressourceexterne,aumoyendelad‚finition'INTGR'.Suiventalorsdes
instructionsdestin‚esaupr‚processeurafinqueleprogrammesoit
correctementcompil‚.Vouspouvezfairel'exp‚riencederecompilerlad‚mo
enrempla‡ant'0'par'1'danslaligne"#defineINTGR0",elle
fonctionnerad‚sormaisavecunressourceint‚gr‚sansautremodification.
Nousd‚finissonslenombremaximumdefenˆtresaveclesquellesnousallons
travailler(7),etnousleurd‚finissons…chacuneunnom,parcommodit‚.

!************************
`!Lafonctionmain()

Lepremierappelduprogrammeestlafonction`$initial()`.SousBIG,ilfaut
`!TOUJOURS`commencerparcela.Parcettesimpleligne,nouschargeonsle
ressource(externe),nouscr‚onsetmettonsenplacelesobjetsUSERDEFs,
letableaudesstructuresdefenˆtres,celuidespointeurssurfonction,
nousimposonslebureaudel'applicationetsonmenu,etnousinitialisons
lesprincipalesvariablesglobales,ainsiquecertains‚l‚mentsdes
€structuresdefenˆtres…desvaleurspard‚faut.Sileressourceest
int‚gr‚,lescoordonn‚esetdimensionsdesobjetssontadapt‚es…la
r‚solutioncourante,s'ils'agitd'unaccessoireilestd‚clar‚auGEMet
sontitreplac‚danslemenu.Aelleseule,cettefonctionfaitgagnerde
nombreuseslignesdeprogramme(etpasmaldetempsded‚veloppement!).

Lafonction`$set_bimg()`estalorsappel‚eafinquel'imagedebureausoit
charg‚eetaffich‚e.Nousyreviendronsplusloin.

Lafonction`$ptr_fonctions()`cr‚elesliensentrelesobjetsposs‚dantun
pointeursurfonctionetlesfonctionscorrespondantes.Lad‚moutilise22
objetsB_FNCPs.Parexemple,laligne"`$fnc[0] = (void *) aff_infos;`"
reliel'optiondumenuprincipal'Infos'(quiestlepremierobjetB_FNCP
duressource)…lafonction`$aff_infos()`.Leslignessuivantesfontdemˆme
pourchaqueB_FNCP,maisvousremarquerezqu'ilfautabsolumenttraiterles
objetsdansl'ordreo—ilssontdansleressource(relisezleparagraphe
"Dessine-moiunbouton").Ilfautbienentenduquelesdiff‚rentes
fonctionsait‚t‚correctementprototyp‚es.Ilfautlesaffecterdanscet
ordre,carc'estainsiquelafonction`$initial()`placedansl'octethautde
l'ob_statedechaqueB_FNCPl'indexdetableau.Jerappellequecela
impliquequ'ilnepeutyavoirplusde256pointeurssurfonctionpar
application.Cettelimiteestassezlargeetnedevraitpasposerde
problŠmesparticuliers.

Vousnoterez‚galementqu'unemˆmefonctionpeutˆtreaffect‚e…desobjets
diff‚rents.Lafonctionaff_infos()estreli‚eaussi…l'‚l‚ment5du
tableau.

Lafonction`$set_form()`metenplacelesliensentrelesobjetsdetype
pop-up,pop-liste,menushi‚rarchiqueetHelpetlesformulairesquileurs
sontassoci‚s.Ellefaitdemˆmepourlesbullesd'aide :lesobjetsquien
possŠdentsontreli‚s…lachaŒnelibrecorrespondante.Nousaurionspu
r‚aliserlamˆmechosedirectementdansleressource,enpla‡antles
valeursvouluesdansl'octethautdel'ob_statedechacundecesobjets.
Maiscelaaurait‚t‚plusennuyeux…faire,etsurtout,l'insertion
ult‚rieured'autresarbresouchaŒnesdansleressourceauraitd‚cal‚tous
lesemplacements,etdonclesvaleurs !Toutauraitd–ˆtrerecommanc‚
(gareauxoublis,danscecas).Enproc‚dantainsi,enutilisantlesnoms
donn‚sauxobjetsdansleressource,noustravaillonsavecbeaucoupplusde
confortetdefiabilit‚.

NousrencontronsensuitelechargementdesfontesvectoriellesSpeedoGDOS.
AprŠsuntestdelapr‚sencedeSpeedo,nousluidemandonsdecharger
touteslesfontesdisponibles.Unebouclenouspermetensuiteder‚cup‚rer
lenomdechacuned'entreelleetdeleplacerdansleformulairepop-up
quiestdestin‚…lesafficher(sansoublierd'enactiverlesoptionsqui
‚taientDISABLED).Nousinitialisons‚galement…desvaleurspard‚fautles
variablesdegestiondespolices.

Normalement,ilfaudraitaussir‚aliserun"raccourcissement"duformulaire
pop-up.Eneffet,ilpossŠde40 emplacementsr‚serv‚sauxfontes
vectorielles,cequiserasansdoutetropdanslaplupartdescas.Nous
devrionsdonccacher(HIDETREE)lesoptionsensurnombre,positionnerle
bitLASTOBdu"nouveaudernierobjet",l'‚l‚mentob_nextdecetobjetainsi
quel'‚l‚mentob_taildelaracine.Commedanstoutecetted‚mo,j'ai
pr‚f‚r‚resterdanslasimplicit‚.

Sinoustravaillonsenmode16couleursouplus,nousex‚cutonslafonction
relief(),quimodifielatrameetlacouleurdesobjets-racinesdesarbres
concern‚s(nousyreviendronsend‚tail).

Nouspla‡onsdanslavariable"aide_en_ligne"lavaleurcorrespondant…la
touche<Control>,afinqu'elleactivel'affichagedesbullesd'aide.
€
NouspouvonsaprŠscelaaborderdirectementlaboucleprincipaledu
programme,toutestd‚j…prˆt!Ils'agitd'unegrandeboucle'do...while'.
Siontourneenaccessoire,etquecelui-cin'estpasactif,nousnous
tournonsdesuiteversunebouclesecondaire(danslafonction
`$acc_loop()`),quiattendquel'accessoiresoitappel‚.Nousy
reviendrons.Lalignelaplusimportantedelaboucleprincipaleest:
`$evnt=dialog(DLG_DESK,adr_desk,TRUE,
`$TRUE,PU_LIBRE,&img,FALSE);

Cetappeldelafonctiondialog()r‚aliseunequantit‚dechoses.Examinons
lesparamŠtrestransmis.
'DLG_DESK'C'estunmasquedebitsd‚finiparBIG2.H.Ilindiqueles
‚v‚nements…surveiller.Serontdoncsurveill‚s:leclavier(pourla
gestiondesraccourcisclavieretdesfenˆtresmanipulablesauclavier),
lesclicssouris(pourl'ic“neetlestextesdubureauainsiquepourles
formulaires,toolbaretmenuenfenˆtre),lazoneo—setrouvelasouris
(pourleschangementsdeformedanslesfenˆtres),lesmessages(pourle
menuetlesfenˆtres),etletimer,pourreprendrelamain…toutmomentet
pourlesmenushi‚rarchiques,letraitementdelapalettedecouleurs,la
gestionduclicdroitetdesbullesd'aide.

'adr_desk'estl'adresseduformulaire…traiter,lebureaudanscecas.

'TRUE'Ceflagsignale…lafonctionquenoustravaillonssurunbureau.La
fonctionr‚agitdemaniŠreunpeudiff‚rentedanslecasd'unbureaupar
rapport…unformulairefixe.Elleretourneauprogrammeprincipaltousles
‚v‚nementsdeclicquiseproduisentsur"lefond",afinqueleprogrammeur
puissecr‚erunbureaucorrespondantauxbesoinsdesonapplication.

'TRUE'Oui,unclicsurleboutondroitdelasourisdoitappelerun
formulaire"pop-uplibre".

'PU_LIBRE'C'estlenum‚rod'arbre(dansleressource)duformulairepop-up
libre.

'&img'Inutilis‚danslecasdubureau,ceseraitunpointeursurleMFDB
d‚crivantlefondduformulaire.

'FALSE'Egalementinutilis‚ici(doitˆtreFALSE),c'estleflagde
d‚placementduformulaire.

Lafonctiontraiteensuiteles‚v‚nementsre‡usenretour,enappelant…
chaquefoislafonctionquicorrespond.Ellecommenceparles‚v‚nements
MU_MESAG(fonction`$event_mesag()`).Lepremiertypetrait‚est
MN_SELECTED,‚v‚nementdemenu.Troisoptionsseulementsonttrait‚esici
('BigAlerte','Quitter'et'Fenˆtremenu').Lesautres‚tantdesB_FNCPs,
BIGfaitlen‚cessairepourquelafonctioncorrespondantesoitex‚cut‚e
automatiquement.Jevousconseilledenejamaistraiterl'option'Quitter'
d'uneapplicationparpointeur,maisderevenir…laboucleprincipalepour
sortir.C'estpluslisibleetpluslogique.

Ensuitesonttrait‚sles‚v‚nementsdemenuhi‚rarchiquedumenuprincipal,
quisontd'untypepropre…BIG.Etantdonn‚quedanslad‚mo,iln'ya
qu'uneoptiondecemenuhi‚rarchiquequinesoitpasunB_FNCP,iln'ya
pasbeaucoupdetests…faire.Sinon,ilfaudrait‚videmmentchercherde
quelleoptionils'agit.

Noussurveillonsensuite,pourlecaso—nousserionsenaccessoire,le
messageAC_CLOSE,quisurvientlorsquel'accessoireestferm‚parune
interventionext‚rieure,g‚n‚ralementparcequenousavonslanc‚ouquitt‚
uneautreapplicationpendantquel'accessoireestouvert(celanese
produitjamaissousMultiTOS).Danslamˆmesituation(travailen
€accessoire),nousdevons‚galementnoterquel'accessoireestferm‚si
l'utilisateurfermesafenˆtreprincipale,cequiestfaitparletest
suivant.

Revenons…`$main()`.Noustraitonsensuiteles‚v‚nementsMU_BUTTON.Mais
commeplusieurstypesd'‚v‚nementsBIGsont…basedeMU_BUTTON,ilfaut
d‚tailler.Nouscommen‡onsparles‚v‚nementsdepop-uplibre(BEV_FREEPU).
Seuleslesoptions'Bigalerte'et'Fenˆtremenu'sont…examiner,les
autres‚tantdesB_FNCPs.

NousexaminonsensuitelesMU_BUTTON/BEV_WFORM,c'est-…-direles
formulairesenfenˆtre.Siunclicaeulieudansundecesformulaires,le
messagearriveici.Noustraitonss‚paremmentlepetitetlegrand
formulaireenfenˆtre,ennenousint‚ressantqu'auxboutonsEXIT,les
autres(pop-up,s‚lectables,radio-boutons,etc)‚tantg‚r‚sparl'appelde
dialog().

Nousn'avonspasgrand-chose…faire.Sileboutonest'Confirme'ou
'Applique',nouslib‚ronslam‚moiredesauvegardedel'‚tatduformulaire,
etnousenregistronslenouvel‚tat.Danslecasde'Confirme',dialog()a
d‚j…faitlen‚cessairepourquelafenˆtresoitferm‚e(puisquecebouton
ale13øbitdesonob_flagspositionn‚).Nousdevonsaussiappelerla
fonctionded‚moobjets_desk()(pourlegrandformulaire)outrame_desk()
(pourlepetit).Sileboutonest'Annule'ou'RAZ',nousrestauronsl'‚tat
ant‚rieur,lam‚moireestautomatiquementlib‚r‚e.Mˆmeremarquepourla
fermeturedelafenˆtreetlebouton'Annule'.Pourlebouton'RAZ',nous
demandons…r‚afficherlecontenudelafenˆtrepouractualiserla
restaurationdel'‚tat.C'esttout!

Noustraitonsensuiteles‚v‚nementsMU_BUTTON/BEV_WMENU,les‚v‚nements
demenuenfenˆtre.Premiercas:ils'agitdelafenˆtreavecmenu
"normale".L'option'Infos'estunB_FNCP,nouslalaissonsdecot‚.Pour
lesautres,noustraitonsl'op‚ration.Pourl'alerte,vousremarquerezque
lacheck-markestplac‚edanscemenuaveclafonctionGEMmenu_icheck()
commes'ils'agissaitd'unmenunormal.
Secondcas:ils'agitdelafenˆtreavecmenuquiestlafenˆtre
principaledelad‚molorsd'unfonctionnementenaccessoire.Danscecas,
lemenuprincipalsetrouvedanscettefenˆtre.Nousproc‚donsdemˆme,en
nenousoccupantquedesoptionsquinesontpasdesB_FNCPs.
Nousexaminonsensuiteles‚v‚nementsMU_BUTTON/BEV_WHIER,les‚v‚nements
demenuhi‚rarchiquedemenuenfenˆtre.L…encore,ilpeuts'agirdela
fenˆtreavecmenuordinaireoudecelledel'accessoire.Danslepremier
cas,seuleslesdeuxpremiŠresoptionssont…traiter,lesautres‚tantdes
B_FNCPs.Nousnouscontentonsd'appelerlafonction`$icone()`aprŠsavoir
plac‚danslemot6dubuffercequ'elles'attend…ytrouver:lenum‚ro
del'optioncliqu‚e.Dansl'autrecas,seulel'optiond'histogrammesest…
traiter.

Ensuite,nousnousoccuponsdes‚v‚nementsdetypeBEV_TOOL,lesclicssur
desobjetsd'unetoolbar.Danslad‚mo,nousdevonsseulementagirdansle
casd'unchoixdepoliceoudetailledecaractŠre,etappelerunefonction
quimodifielesvariablesglobalescorrespondantes.Ensuite,etmˆmes'il
s'agitd'autresobjets,nousr‚affichonslecontenudelafenˆtre.
Normalement,nousnedevrionseffectuerleredrawquesiunparamŠtrea
effectivement‚t‚chang‚.Cen'estpaslecasdanslad‚mo.

Ilreste…traiterlesclicssourisdirectementsurlebureau.Jene
d‚criraispasend‚tailcettepartiequinepr‚senteaucunedifficult‚(par
pr‚caution,nousv‚rifionsqu'iln'yapasdefenˆtre…l'endroitduclic).
LamaniŠredetraiterlebureaud‚pendfortementdel'application.Dansla
d‚mojemesuiscontent‚decr‚erquelquechosedetrŠsg‚n‚ral.

Leseulimp‚ratif,c'estquelesobjetsdubureaun'aitpasunob_flags
€EXITouTOUCHEXITouautrechose(sauf‚ventuellementLASTOB).Sinon,la
fonction`$dialog()`tenteraitdelestraiter…safa‡on.Enfait,elle
travailledelafa‡onsuivante:sileclicalieudanslazonedetravail
d'unefenˆtre,ilesttrait‚par`$dialog()`.s'ilalieusurundes‚l‚ments
delafenˆtre(boutonderedimensionnementparexemple),ilestignor‚(le
GEMvag‚n‚rerunMU_MESAGquiseratrait‚s‚par‚ment).S'ilalieusurun
desobjetsduformulairedont`$dialog()`are‡ul'adresseenparamŠtre,elle
tentedeleg‚rerenfonctiondesflagsdecetobjet.Enfin,elleretourne
l'‚v‚nementauprogramme.

Pourunbureau,quin‚cessiteunegestion…chaquefoisparticuliŠre,nous
voulonsque`$dialog()`noussignalesimplementleclicsansrienfaire,afin
quenousd‚cidionsdecequidoitˆtrer‚alis‚.Danslad‚mo,sil'ic“ne
‚taitEXITetSELECTABLE,`$dialog()`las‚lectionneraitetla
d‚s‚lectionnerait…chaqueclicsurl'ic“ne,maisnepourraitnila
d‚placernilad‚s‚lectionnerlorsd'unclic"danslevide".Enproc‚dant
ainsi,nousdevonsfaireleschoses"…lamain",maisnousfaisonsceque
nousvoulons.

Lafindelaboucle'do...while'testelavariable'quit',quiestmise
'TRUE'silasortieduprogrammeestdemand‚e.SidesfontesSpeedoont‚t‚
charg‚es,ellessontlib‚r‚es.Puislafonction`$end()`estappel‚e.

CettefonctionlibŠrelesdiff‚renteszonesm‚moirequiont‚t‚r‚serv‚es
(pourlesstructuresdefenˆtre,lesuserdefs,lespointeurssurfonctions,
les‚ditables‚tendus,lebufferd'‚cran,lapalettepard‚faut,mˆmele
bufferdel'imagedubureau),ellefermetouteslesfenˆtres(dumoins,
cellesquiappartiennent…notreapplication),ellelibŠreleressource
s'ilestexterne,otelemenuetrestaurelebureauGEM.

!************************
`!L'imagesurlebureau

Lafonction`$set_bimg()`Chargel'imagedebureauetl'affiche.
L'op‚rationesteffectu‚etrŠssimplementparunappel…lafonction
`$img_attach()`appartenant…lalibrairiedetraitementd'images
BIG_IMGS.Cettefonctionsechargeded‚terminerletyped'image,de
v‚rifierl'existencedufichieretdelecharger.Lesdiff‚rents‚l‚ments
delavariablebimg(detypet_image_dial)sontaliment‚saveclesvaleurs
quiconviennent.L'imageestautomatiquementcentr‚e.

Unefoisquetoutcelaestfait,l'objet-imageestrenduvisibleetun
messagederedrawestenvoy‚…toutlebureauafinquece"nouvel"objet
soitaffich‚.

Jetezuncoupd'´ilaudescriptifdesfonctionsdeBIG_IMGSpourplusde
d‚tails.

!************************
`!Lagestiondesformulaires

Nousarrivons…lafonctionquigŠrele'formulairelibre'delad‚mo.Nous
devonsd‚clarerunMFDBquid‚criralefondduformulaire.Ilnesera
utilis‚quesinousdemandonsund‚placementduformulaireenboŒtefant“me
(ous'iln'yapasassezdem‚moirepourler‚aliserentempsr‚el).Nous
bloquonsl'AESpar`$wind_update()`,nousdemandonsl'adresseduformulaire
(desinstructionsdepr‚processeuretlad‚finition'INTGR'dud‚butdu
sourcesignalentaucompilateursinoustravaillonsavecunressource
int‚gr‚ounon),etnoussauvegardonsson‚tatdanslazoned‚sign‚eparle
pointeur'adr_bakrsc'aumoyendelafonction`$bak_rsc()`.Latrameetla
couleurdufondetdeschamps‚ditablessontmodifi‚essinousnous
trouvonsen16couleursouplus.

€Nouspouvonsenfindemanderl'affichagepar`$formm_draw()`.Nouspr‚cisons…
cettefonctionl'adresseduformulaire,lechamp‚ditableo—doitse
trouverlecurseuraud‚part,quenousd‚sironsund‚placemententemps
r‚el,etquelleestl'adresseduMFDBdesauvegardedufonds'ilfallait
proc‚der…und‚placementenboŒtefant“mefautedem‚moire.Les
diff‚rentesinitialisations,r‚servationm‚moire,sauvegardesd'images,et
calculssontr‚alis‚sparlafonction.

Nouspouvonsentreralorsdanslaboucledetraitement,bas‚eencoreune
foissur`$dialog()`.Danscecas,les‚v‚nements…surveillersontmoins
nombreuxquepourlebureau.Seulementleclavier(pourles‚ditables),les
clics(pourlesdiff‚rentsobjets)etcommetoujours,letimer,pourgarder
lamain.dialog()s'occupedetout(pop-ups,aide,d‚placement,pointeurs
surfonction,‚ditables‚tendusounon,gestionducurseur,etc.
Nousavonsjuste…nousoccuperdelasortie.Si'Confirme'a‚t‚choisi,
rien…faire.Sic'est'Annule',nousrestauronsl'‚tatant‚rieurdu
formulaire.

Ilnenousresteplusqu'…oterleformulairedel'‚cran.`$formm_undraw()`
s'encharge,etlibŠreleszonesm‚moirer‚serv‚espar`$formm_draw()`.Par
contre,c'est…nousquerevientlaresponsabilit‚delib‚rerlam‚moire
d'‚tatduformulaire.

Lafonction`$aff_infos()`estpresqueidentique.Ilyjusteuntest
suppl‚mentaireaud‚but:silesinfosont‚t‚demand‚es…partirdumenu
defenˆtre,ilfautinverserletitredemenucorrespondant.Commeiln'ya
nibouton'Annule',nidedialogueavecl'utilisateur,inutiledeg‚rer
l'‚tatduformulaire.Led‚placement‚tantdemand‚enboŒtefant“me,le
pointeursurMFDBprendicitoutesonimportance.

Lafonction`$test_alerte()`estcellequiestappel‚eparleboutonB_FNCP
'Alerte'duformulairelibre.Eller‚aliseunsimpleappel`$big_alert()`.

!************************
`!Lesformulairesenfenˆtre

L'appeldeformulairesenfenˆtreestencoreplussimplequeceluides
formulaires"bloquants"(quibloquentlemenu,lesfenˆtres,etc).
Commen‡onsparlafonction`$pform_wind()`,quipr‚sentelepetitformulaire.
Commed'habitude,nousdemandonsl'adressedel'arbre(ressourceint‚gr‚ou
non),nousadaptonssacouleuretsatramesin‚cessairepourla3D,et
nousinversonsletitredemenu.Nousaffectonsensuitelatrameetla
couleuractuellesdubureauauxpop-upsboŒtesduformulaireafinqu'ils
soientlerefletdelasituation.Nousn'avonsplusqu'aouvrirlafenˆtre
par`$formw_draw()`etar‚inverserletitredemenu.Iln'yapasplus
simple.

A`$formw_draw()`sonttransmisl'adresseduformulaire,l'indexBIGdela
fenˆtre…ouvrir(quia‚t‚d‚clar‚epar`$initial()`),lenum‚ro(dansle
ressource)delachaŒnelibrequidoitˆtreletitredelafenˆtre,le
num‚rodelachaŒnepourlaligned'infos(iln'yenapasdanscecas,
noustransmettons'BLANK',c'est-…-dire'-1'),lenum‚rodel'‚ditableo—
doitˆtrelecurseur…l'ouverturedelafenˆtre,leflagr‚clamantun
calageduformulairesurdesmultiplesde16,puisqu'ilcontientdes
trames,lesattributsquedoitposs‚derlafenˆtre(Nousutilisonsiciune
d‚finitiondeBIG:seulsNAME,CLOSER,MOVERetSMALLERsontactifs),et
enfinunpointeursurlafonctionquiserautilis‚epourredessinerle
contenudelafenˆtrelorsqu'elleseraic“nifi‚e(lorsqu'ellenel'estpas,
leformulaireestdessin‚automatiquementlorsquecelaestn‚cessaire).

L'ouverturedelafenˆtredugrandformulaireestfaŒteparlafonction
`$gform_wind()`.Elleestencoreplussimple,puisquenousn'avonspas…
testerlatrame.
€
Jened‚criraipaslesfonctions`$trame_desk()`et`$objets_desk()`quisont
appel‚espar`$main()`siunbouton'Confirme'ou'Applique'estcliqu‚,
respectivementdanslafenˆtredupetitetdugrandformulaire.Ces
fenˆtres‚tantouvertes,c'estlaboucleprincipaleduprogramme(cellede
`$main()`)quigŠretoutcequis'ypasse,grƒce…`$dialog()`.

!************************
`!Lafenˆtretexte

Lafonction`$charge_texte()`ouvrelafenˆtredetexte.Jen'entreraipas
danslesd‚tailsduchargementlui-mˆme.Cen'estpasunmodŠledugenre,
maisilestsuffisantpourlad‚mo.Cequiestimportant,c'estquele
texteestcharg‚dansunezonem‚moire,quidoitdoncˆtrelib‚r‚e…un
momentou…unautre.Dansunprogrammer‚el,j'auraichoisidelalib‚rer
seulementaumomentdequitterouparuneoption'Abandon'.Danslad‚mo,
cettezonedoitˆtrelib‚r‚e…chaquefermeturedelafenˆtre.Lastructure
BigWinddecettefenˆtredoitdoncavoircommeparamŠtre'w_close'
l'adressed'unefonctionquisechargeradecelaenplusdelafermeturede
lafenˆtre.

Ilfautaussiplacerdans'w_redraw'l'adressedelafonctionquiaffichera
letextelui-mˆme.Leplusimportantestdoncl'appel'`$open_window()`'.Les
lignesquipr‚cŠdentcetappelchargentletexte(notezl'utilisationdela
fonction`$selector()`)etcomptentlenombredelignes.Nousdemandons
‚galement…laVDIlesdimensionsdescellulesdecaractŠresdelapolice
courante(lapolicesystŠmedetaille13estutilis‚epard‚faut).

Nousappelons`$open_window()`enluipr‚cisantl'indexdelafenˆtre…
ouvrir,sontypeBIG(WTYP_NORM),cesattributsGEM(WATR_CURR:toussauf
laligned'infos),lescoordonn‚esded‚part,sesdimensionsminimum,les
unit‚sded‚calage(latailled'unecellule),unflagdefenˆtre
manipulableauclavier,pasdecalagesurlesmultiplesde16etlaforme
delasourisdanslazonedetravail.Viennentensuitelespointeurssur
lesfonctionsd'affichage(enic“neetennormale)etdefermeturedela
fenˆtre,despointeurssurleschaŒnesdetitreetd'infos(lasecondeest
vide),leslargeurethauteurtotalesdelafenˆtre(enpixels).Nous
devonsr‚aliserdes"casts"pourquelesparamŠtrestransmissoientbiende
type'long'.Enfin,sonttransmisunflagFALSEsignalantquelafenˆtre
n'apasdemenu,unautreTRUEpourindiquerlapr‚senced'unetoolbaret
lenum‚rod'arbredecettetoolbar.

CelafaitbeaucoupdeparamŠtres,maisc'esttoutcequ'ilya…faire.A
partirdemaintenant,nousn'avonsplus…nousoccuperdecettefenˆtre.
Elleserad‚plac‚e,redessin‚e,ic“nifi‚e,soncontenud‚filerasansaucune
interventiondenotrepart(mˆmedanslecasdesversionslesplusr‚centes
duGEM,quiautorisentlamanipulationdesfenˆtresd'arriŠre-plan).La
fonctiond'affichage(`$aff_texte()`danslad‚mo)seraappel‚e
automatiquementlorsquecelaseran‚cessaire(Jevouslaisseexaminercette
fonction,quin'estpasnonplusunmodŠle,etquiestimparfaitenotamment
encequiconcerneletraitementdespolicesproportionnelles),demˆmeque
winicn()silafenˆtreestic“nis‚e.S'iln'yaplusdefenˆtredisponible
danslestableauxduGEM,l'alerteduressourceint‚gr‚deBIGsera
affich‚epourlesignaler…l'utilisateur.

Quant…lafonction`$close_txt()`,elleappelle`$closed()`(quifermela
fenˆtreetmodifiel'‚l‚mentw_hg)etlibŠrelam‚moiredutexte.Comme
closed()cherchedansbuf[3]lehandleGEMdelafenˆtre,nousl'ypla‡ons
unpeuartificiellementavantl'appel.

Nousavonsd‚j…mentionn‚lafonction`$set_font()`.Elleestappel‚e
lorsqu'unefonteouunetailledecaractŠre…‚t‚choisiedanslatoolbar,
etellesecontentedemodifierlesvariablesglobalescorrespondantes,qui
€serontensuiteutilis‚esparlafonctiond'affichagedutexte.Notezquela
tailleestluedirectementdansleboutonpop-updelatoolbar.Ainsi,si
vousvoulezquelad‚mosoitenmesured'afficherd'autrestailles,il
suffitdelesajouterdansleformulairepop-upcorrespondant,sansmˆme
devoirrecompilerlad‚mo!

!************************
`!Lafenˆtreimage

Lafonction`$charge_image()`ressemble…celledutexte.Elleestunpeuplus
complexedufaitqu'ellepeutˆtreappel‚epourouvrirlafenˆtreimage
normale,ou…partirdelafenˆtreavecmenu,l'imagedevantalorsˆtre
plac‚edanscelle-ci.Ilyadoncplusieurstestspourcela.
L'imageestcharg‚edansunezonem‚moire,etl'‚l‚mentw_cont.w_imgdela
structuredefenˆtrecorrespondantedoitˆtrerempliavecles
caract‚ristiquesdel'image.Demˆmepourl'‚l‚ment.w_palaveclapalette
decouleursdecetteimage.

L'appel…`$open_window()`estpresquelemˆmequepourletexte.LetypeBIG
delafenˆtreimpliquequeBIGsechargeradetouslesaffichages
n‚cessaires.Noustransmettonsdoncun'ZERO'commefonctionderedraw.Les
variables'ftool','fmenu'et'menu'contiennentrespectivement'FALSE',
'FALSE'et'BLANK'danslecasdelafenˆtreimage,etcontiennent'FALSE',
'TRUE'etlenum‚rodumenudanslecasdelafenˆtreavecmenu.

Leredrawdel'imageestfait…partirdesinformationscontenuesdans
w_cont.w_img.w_blk.S'iln'yenapas,c'estquel'imagen'apasencore‚t‚
charg‚e.BIGtracealorsunrectangleblancdanslafenˆtrepourlavider.
Lafonctiondefermeturedefenˆtren'estpaslamˆmeselonlafenˆtre,
puisquelam‚moiredumenudoitˆtrelib‚r‚esic'estlafenˆtreavecmenu
quiestferm‚e.Lafonction`$close_img()`travaillecommesonhomologuedu
texte,maisdoitenpluslib‚rerlam‚moiredelapalettedecouleur.Quant
…`close_wmenu()`,ellefaitdemˆmeavecenpluslalib‚rationdelam‚moire
demenu.

!************************
`!Lafenˆtregraphique

Lafenˆtred'histogrammesestcr‚eetouverteparlafonction`$cree_histo()`.
Unezonem‚moirepourlesdonn‚esestr‚serv‚e,puisdesvaleursal‚atoires
sonttir‚espourleshistogrammesetplac‚esdanscettezone.L'ouverture
delafenˆtresefaitcommenousl'avonsd‚j…vu.

Lafonction`$aff_histo()`nedevraitpasn‚cessiterd'explication
particuliŠre.`$close_histo()`faitcommesesconsoeurstexteetimage,
ellelibŠrelam‚moirer‚serv‚epourlesdonn‚es.

Lafonction`$close_wmenu()`fermelafenˆtreavecmenuenlib‚rantleszones
m‚moiresr‚serv‚espourl'imageetlapalettedecouleurs.
Autrefonction,`$icones()`r‚cupŠredansbuf[6]l'optioncliqu‚e(ouappel‚e
par‚quivalentclavier)danslemenuhi‚rarchiquedumenudefenˆtre,et
choisil'ic“nedel'alerteseloncetteoption.

Lafonction`$winicn()`estcharg‚eduredrawdesfenˆtreslorsqu'ellesont
ic“nis‚es.Ellesecontentedeviderlafenˆtreetd'ycentreruneimageou
uneautre,selonqu'ils'agitd'unefenˆtreformulaireoud'unautretype.
Lesimagesproviennentduressourceetpeuventdoncais‚mentˆtre
modifi‚es.

Lafonction`$clos_acc()`estappel‚eencasdemessageAC_CLOSE,defermeture
delafenˆtreprincipaledel'accessoireousioncliquel'option'quitter'
del'accessoire(menuenfenˆtre).Ellerendleurscoordonn‚esd'origine…
touteslesfenˆtressielle‚taientic“nifi‚es,etlesfermedupointde
€vuedeBIG,maisPASdupointdevueduGEM.Voyezlechapitre
"Programmationd'accessoires"poursavoirpourquoi.

Autrefonction,`$acc_loop()`estutilis‚esiontourneenaccessoire.Elle
attendsimplementdelapartduGEMlemessageAC_OPENsignalantque
l'accessoirea‚t‚appel‚.Elleouvrealorslafenˆtreprincipalede
l'accessoireenypla‡antlemenudel'application,etretourne…laboucle
principale.

Lafonction`$red_acc()`estunefaussefonction,elleestvide !Lorsdu
fonctionnementdelad‚moenaccessoiredebureau,lafonction
`$open_window()`attendl'adressed'unefonctioncharg‚eduredessinde
cettefenˆtre.Ilfautdoncluienfournirune,maisiln'yarien…
redessiner,puisquemˆmelefondtram‚delafenˆtreesttrac‚parBIG.
Donc,nousluiindiquonsunefonctionquinefaitstrictementrien.

DerniŠrefonction,`$relief()`estappel‚eaud‚butduprogrammesionesten
16couleursouplus,afinquelestramesetcouleursdecertainsobjetset
boŒtes-racinessoientmodifi‚espourl'effetde3D.

Encoreunepetiteremarque.Lorsqu'uneoptiondemenuestcliqu‚e…la
souris,leGEMsecharged'inverserletitredemenucorrespondant.Mais
quandunefonctionestactiv‚eparraccourciclavier,cen'estpaslecas.
Nousdevonslefairenous-mˆmes.SousBIG,celan'estpasn‚cessaire.Le
titredemenuesttoujoursinvers‚,quel'optionait‚t‚choisie…la
sourisouauclavier,quelemenusoitlemenuprincipalouunmenude
fenˆtre,quecesoituneoptiondumenului-mˆmeoud'unmenuhi‚rarchique.
Leprogrammeurdoitseulementd‚s‚lectionnerletitreparlafonctionGEM
`$menu_tnormal()`…lafindutraitement.

CeprogrammeBIG2DEMO.PRGa‚t‚cr‚‚avecdesparamŠtresminimumettrŠs
simples.Pourlacompilation(dansPureC),lesseulesoptionsactiv‚es
sont"Defaultcharisunsigned"(-K)et"Useabsolutecalls"(-P).Aucune
optionn'estactiv‚edanslelinker.LalibrairieBIG2.LIBa‚t‚compil‚e
aveclesmˆmesoptions.Ainsi,BIGn'imposepratiquementpasdecontraintes
decompilation.

Ilestutileetcommodedetravailleravecdeuxlibrairies.L'une
(BIG2DEBG.LIB)estcompil‚eetlink‚eaveclesinformationsded‚buggage
(options-Ydanslecompilateur,-Y,-Let-Gdanslelinker)etserait
utilis‚ependantled‚veloppementafind'avoiraccŠsauxvariablesgobales
sousdebugger.Laseconde(BIG2.LIB)estcompil‚esanscesinformations,
pourlacompilationd‚finitivedutravailr‚alis‚.

!************************
`!BIGenmultitƒche

BIGsecomportedemaniŠrecorrectesousenvironnementmultitƒche,mais
danscertainscasdesralentissementspeuventˆtreconstat‚s(c'est
d'ailleursuneg‚n‚ralit‚danscetyped'environnement).Enparticulier,
sousMultiTOS,o—lagestiondutimerestloind'ˆtreparfaite,BIGpeut
ˆtrecapricieuxdanssagestiondesclicsdroits,lesquelsutilisent
pr‚sis‚mentl'‚v‚nementMU_TIMER.Pouruneraisonquejenecomprendpas
vraiment,lesdouble-clicssont‚galementmaltrait‚s(jegardebonespoir
der‚glertotalementceproblŠme).

Avecl'utilisationd'autressystŠmesmultitƒches,Genevaparexemple,tout
sepassebeaucoupmieux,cequisembleconfirmerquebeaucoupdechosesont
‚t‚bacl‚esdansMultiTOS.

Maisilyaunediff‚renceimportanteentrecesenvironnementsetle
monotƒchetraditionnel(quiestd'ailleursaussimultitƒche,les
accessoiresdebureauensontunepreuvenette).Elleconcernel'envoiedes
€messagesWM_TOPPED.Dansunesituation"normale"(monotƒche),lemessage
estenvoy‚…l'applicationdŠsqu'unefenˆtred'arriŠre-planestcliqu‚e,
etavantqueleboutondelasourissoitrelƒch‚.C'estenquelquesorteun
messageTOUCHEXIT,sij'osedire.

Enmultitƒche,lemessagen'estenvoy‚qu'unefoisqueleboutondela
sourisa‚t‚relƒch‚ !

C'estpourcetteraisonquedanscetenvironnement,iln'estpaspossible
(sousBIG)ded‚placerunefenˆtred'arriŠre-planenfaisantglisserla
sourisboutonenfonc‚.Eneffet,lorsqu'unmessageWM_TOPPEDluiparvient,
BIGcherchesilafenˆtreconcern‚eestdetypeBIG,etsic'estlecas,
surquelobjetduformulaire-fenˆtreleclicaeulieu.Sic'estsurun
‚l‚ment"actif"(barreded‚placement,sizer,ascenseur,etc),lafenˆtre
n'estpasmiseenpremierplan,maisunegestionestfaiteselonl'objet.

Sousmultitƒche,lorsquecemessageparvient…BIG,leboutondelasouris
estobligatoirementd‚j…relƒch‚.Lemˆmeprincipeestappliqu‚(ignorerle
messageauprofitd'unefonctiondefenˆtre),maisilesttroptardpour
r‚aliserle"cliqu‚-gliss‚-relƒch‚".Ilnerestedoncquelaseconde
solution :le"clic-gliss‚-clic".Toutcelaneconcerne‚videmmentpasla
fenˆtredepremierplan.

€!************************
`!ParamŠtresetpointeurssurfonctions

Lesfonctionsappel‚esparlesobjetsB_FNCPsontdetype
     `$'voidfonction(void)'
EllenepeuventdoncrecevoirdeparamŠtresniretournerdevaleur.Ilya
dessituationso—celaestg‚nant,carilfaudraimp‚rativementtransmettre
desinformations…lafonction,etelledevrar‚pondrequelquechose.
Commentfaire?
Ilsuffitdemettreenplaceunezonem‚moire,ouunestructureglobale,ou
untableaudeparamŠtres,selonlecontexteetlespr‚f‚rencesdu
d‚veloppeur,o—serontplac‚eslesinformations…‚changeravecla
fonction.C'estexactementcequefontl'AESetlaVDIaveclestableaux
contrl[],intin[],ptsout[],global[],etc.
Lad‚mo,volontairementsimple,nepr‚sentepasd'exempledecettem‚thode,
maisc'estunpeucequiestr‚alis‚parlafonction`$close_txt()`.Elle
appellelafonction`$closed()`quiestcharg‚edefermerunefenˆtre.Mais,
‚tantd‚clar‚e'voidclosed(void)',onnepeutluitransmettrelehandle
delafenˆtredontils'agit.`$close_txt()`placedonclehandleGEMdela
fenˆtre…fermerdanslemot3dutableaubuf[],quiestunevariable
globale,puiselleappelle`$closed()`.Celle-civachercherdansbuf[3]
l'informationdontelleabesoin:lehandleGEMdelafenˆtre…fermer.

€!************************
`!Travailavecunressourceint‚gr‚

Ilesttout…faitpossibleded‚velopperavecBIGuneapplication
utilisantunressourceint‚gr‚aulieud'unfichierRSCexterne.
Pourr‚alisercela,ilestn‚cessaired'utiliserun‚diteurderessource
capabledeg‚n‚rerunfichier"RSH"contenantsousformedesourceCla
descriptionduressource.Ilsuffitensuitedeplaceraud‚butduprogramme
laligne'`$#include"PROGNAME.RSH"`'etletourestjou‚.

Normalement,onaccŠdeauxadressesdesdiff‚rentsarbresetobjetspar
l'interm‚diairedutableau`$rs_trindex[]`(etrs_frstr[]pourleschaŒnes
libres).SousBIG,onutiliseletableau`$ir_trindex[]`.Etceci`!mˆme`
sileressourcen'estpasint‚gr‚ !

Eneffet,dŠsled‚butdel'ex‚cution,lafonction`$initial()`place
touteslesadressesdesarborescencesdanscetableau,queleressource
soitint‚gr‚ounon.Ainsi,celafaciliteletravaildansl'uneoul'autre
decessituations,etl'utilisationdelafonctionGEM`$rsrc_gaddr()`
devientinutile.

Voiciunedescriptiondelasyntaxe…utiliser.L'adressed'unarbre
(l'objet0)s'obtientparexemplepar:

`$adr=ir_trindex[TREE];
Etl'adressed'unobjetparticulierpar:
`$adr_object=ir_trindex[TREE][OBJECT];
Avec:
`$OBJECT*adr,*adr_object;

LesadressesdeschaŒnesetalerteslibress'obtiennentparl'utilisation
delafonction`$get_string()`.

Ilestn‚cessairequeBIGsachedequellemaniŠreilpeutacc‚deraux
adressesdes‚l‚mentsduressource.Lafonction`$initial()`met…TRUEla
variableglobaleintgrsileressourceestint‚gr‚,et…FALSEs'ilest
externe.

Sinoustravaillonsavecunressourceint‚gr‚,noustransmettons…BIGpar
lesparamŠtresdelafonction`$initial()`lesadressesded‚partdes
tableauxrs_trindex[]etrs_frstr[].Cesadressessontalorssimplement
copi‚esdanslestableauxdeBIGafind'ˆtreutilis‚esquandilsera
n‚cessaired'obteniruneadresse.Sinoustravaillonsavecunressource
externe(danscecas,leparamŠtrenb_treeest‚gal…0),nouspouvons
transmettredes'0'pourfairepropre,mais`$initial()`ignoresimplement
cesparamŠtres.Elleplaceratoutdemˆmelesadressesdansletableau
ir_trindex[].

Etudiezlesourcedelad‚mopourvoircommentceciesttrait‚.Ilsuffit
dechangerle'0'en'1'danslaligne'#defineINTGR0'pourrecompiler
lad‚moavecunressourceint‚gr‚.Cetted‚finitionetquelques
instructionsdestin‚esaucompilateurfontladiff‚renceentrecesdeux
situationsetleprogrammeesttoujourscompil‚commeilconvient.Sile
ressourceestint‚gr‚,nousincluonslefichier'BIG2DEMO.RSH',etnous
transmettons…`$initial()`lesadressesdestableauxpar
   `$(OBJECT *)rs_trindex'et'(char *)rs_frstr
ainsiquelenombred'arbresduressource:22(formulairesetmenus).Si
leressourceestexterne,nousincluonssimplementlefichier'BIG2DEMO.H'
(lesd‚finitions)etlesautresparamŠtressontmis…0.Danslecorpsdu
programmenousutilisonssimplementletableauir_trindex[]sansnous
pr‚occuperd'autrechose(saufdanslafonction`$winicn()` ,pourobtenir
l'adressed'uneimagelibre).

€Dernierpoint:sileressourceestint‚gr‚,lescoordonn‚esetles
dimensionsdesobjetsdoiventˆtreadapt‚es…lar‚solutioncourante,par
lafonctionGEM`$rsrc_obfix()`(cequiestfaitautomatiquementparGEMau
chargementd'unressourceexterneparlafonction`$rsrc_gaddr()`).La
fonctioninitial()s'enchargeaussiautomatiquementpourlesressources
int‚gr‚s.Unconseil:dansl'‚diteurderessource,caleztoujoursles
objetssurunoffsetdecaractŠre.

!************************
`!Programmationd'accessoires

Jerappellepourm‚moirequeleprogrammeBIG2DEMO.PRGpeutˆtrerenomm‚en
BIG2DEMO.ACCetˆtrelanc‚commeaccessoire.
Laprogrammationd'accessoiresdebureausousBIGestencoreplussimple
quedirectementsousGEM,puisquecertainesop‚rationssontautomatiquement
r‚alis‚es.RappelonsbriŠvementleprincipe:

Unaccessoiredebureauestuneapplicationcommen'importequelleautre.
Normalement,unaccessoirenepeutposs‚derdebarredemenu,maisainsi
quelad‚molemontre,ilestfaciledecontournercettelimiteenle
pla‡antdansunefenˆtreparticuliŠre(d'autresproc‚d‚s,commele
protocoleTubeGEM,permettentdeleplacercommemenunormal,mais…
conditionquel'applicationprincipaleactuellementencoursreconnaisse
‚galementceprotocole).Laprincipalecaract‚ristiqued'unaccessoireest
qu'ilnes'arrˆtejamaisdetourner.Ilestformellementinterditde
quitterunaccessoiredebureaupar`$appl_exit()`outouteautrefonction!
Ils'installeautomatiquementpendantleboot,etestinterrompuparun
resetouuneextinctiondupostedetravail.
Pourd‚clarerunaccessoireauGEM,ilfautobligatoirementavoirrecours…
lafonctionGEM`$menu_register()`,quiestdelaforme:
`$intmenu_register(intme_rapid,char*me_rpstring);
LepremierparamŠtreestlenum‚rod'identificationdel'application,celui
quiestretourn‚parl'appeldelafonction`$appl_init()`.Lesecondestla
chaŒnedecaractŠresquidoitˆtrelenomdel'accessoiredanslepremier
menu(Bureau).C'estsurcetteoptiondumenuquel'utilisateurvacliquer
pourappelerl'accessoire.Lafonctionretourneunnum‚rod'identification
del'accessoire.

SurlesanciennesversionsduGEM,iln'‚taitpaspossibled'avoirplusde
sixaccessoiressimultan‚ment.Iln'yad‚sormaisplusdelimites.D'autre
part,ilest‚galementpossiblesousMultiTOSd'utilisercettefonction
pourchangerlenomquis'affichedanslemenumˆmedanslecasd'une
applicationlanc‚eenprogramme.Maiscelanenousconcernepas.

Cequ'ilfautsavoir,c'estquecettefonctionaparfoisuncomportement
capricieux.Ilarrivequel'accessoiresoitcorrectementenregistr‚parle
GEM,maisquesonnomn'apparaŒssepasdanslemenu!Sionlanceune
applicationquelconquequir‚initialiselabarredemenueninstallantla
sienne,toutrentredansl'ordre...Enfait,celad‚penddel'ordredans
lequelsontfaiteslesdiff‚rentesinitialisations(d‚clarationde
l'application,chargementduressource,etc).C'estenmodifiantcetordre
quel'onpeutcorrigerled‚faut.Malheureusement,l'ordreestdiff‚rent
selonquel'ontravailleavecunressourceexterneouint‚gr‚!Lafonction
`$initial()`deBIGr‚soudcecasse-tˆtepournous.Merci.

Nousavonsinstall‚notreaccessoire.Quefait-il?Ilattendqu'on
l'appelle(onpeutaussiluifairer‚aliserdepetitestƒchespendantce
temps,maislaissonsceladec“t‚).Quandonappelleunaccessoireenle
cliquantdanslemenu,ilre‡oitun‚v‚nement(detypeMU_MESAGsion‚tait
dansuneboucleevnt_multi).Lebufferdemessagecontientalorsles
‚l‚mentssuivants:
`$Mot0:AC_OPEN(40)
`$Mot4:Identificateurdel'accessoire(retourn‚parmenu_register).
€Lorsquenotreaccessoirere‡oitcemessage,c'estqu'onl'aappel‚(ilpeut
v‚rifieraveclemot4quec'estbiendeluiqu'ils'agit,maissinonil
n'auraitrienre‡u).Cequisuitd‚pend‚videmmentdel'accessoirelui-
mˆme.Ilouvreunformulaire,unefenˆtre,etc.Ilfaitcequ'ilveut,
‚tantd‚sormaisl'application"depremierplan".Notezques'ilouvreun
formulaire,ildoitbloquerlemenu.Riend'autrequeluin'estactif.Mais
ilpeutaussi,c'estcequefaitBIG2DEMO.ACC,ouvriruneouplusieurs
fenˆtre(s)ettournerdansuneboucledetypeevnt_multi.Danscecas,il
sepeutquedesoptionsdemenud'uneautreapplicationsoientcliqu‚es,ou
qu'onactiveuneautrefenˆtre,etc.Heureusement,leGEMenvoielemessage
correspondant…cequic'estpass‚aubondestinataire.Iln'yadoncpas…
sepr‚occuperdecela.

MaisilfautsavoirqueleGEMenvoielescompte-rendusd'‚v‚nements
clavier…l'applicationquiaunefenˆtreenpremierplan.Celasignifie
quesivotreaccessoireestouvert,maisquesafenˆtreestenarriŠre,il
nerecevrapasdemessagesderaccourcisclavier,parexemple.
Autrepointimportant:danslamˆmesituation(lafenˆtredel'accessoire
estenarriŠre),unclicestfaitparexemplesurlabarreded‚placement
d'uneautrefenˆtre.L'application…laquellecettefenˆtreappartient
recevradoncun‚v‚nementdetypeMU_MESAG.Maisl'accessoirerecevraun
MU_BUTTON!Ildevra‚videmmentl'ignorerdanscecontexte.

Ilpeutarriverfinalementquel'accessoiresoitferm‚paruneintervention
ext‚rieure,sansactionparticuliŠredel'utilisateur.Imaginonsquenous
noustrouvonssurlebureau.Nousouvronsunefenˆtreappartenant…notre
accessoire,puisnouspassonssanslafermer…unefenˆtredudisqueduret
nouslan‡onsunprogramme!Autresituation:noussommesdansun
programme,etnousouvronsunefenˆtredel'accessoire.Sanslafermer,
nouscliquonsl'option'Quitter'duprogrammeprincipal.Quecepasse-t-il
danscescas(lesexplicationsquisuiventneconcernentpasle
fonctionnementenmultitƒche)?
L'accessoirevarecevoirunautre‚v‚nement,‚galementdetypeMU_MESAG,
constitu‚ainsi:
`$Mot0:AC_CLOSE(41)
`$Mot3:Identificateurdel'accessoire(retourn‚parmenu_register).

Cemessageestenvoy‚pourinformation,afind'avertirl'accessoirequ'il
estd‚sormaisconsid‚r‚ferm‚,etqu'ildoitretournerdanssaboucle
d'attentedumessageAC_OPEN,sansquoiilnepourraplusˆtreouvert,
puisqu'ilnetraiterapluscemessage.Maisuneautrechoseestfaitepar
leGEM :touteslesfenˆtresappartenant…cetaccessoiresont
automatiquementferm‚esetd‚truitesparleGEM,contrairement…cequiest
ditdanscertainsouvrages!Sil'accessoiretente…pr‚sentdefermerune
desesfenˆtres,alorsqu'ellen'existeplus,ilseproduitdanslaplupart
descasunblocagedusystŠmesansautrerecoursquelereset.
EtudiezcommentestfaŒtelafonction`$clos_acc()`delad‚mo.Lafenˆtre
principaledel'accessoiren'estferm‚eetd‚truite(par`$wind_close()`et
`$wind_delete()`)quesilemot0dubufferestdiff‚rentdeAC_CLOSE(la
fonction`$closed()`deBIGfaitdemˆme).

Enr‚sum‚,laprogrammationd'accessoiresdebureauestrelativement
simple.Ilyacertainespr‚cations…prendreaveclescapricesduGEM,
maisBIGestd'uneaidepr‚cieuse.Ilfaut‚galementˆtreprudentavecla
gestiondes‚v‚nements,etn'oublieraucuncasparticulier.Ladifficult‚
estlamiseaupointdel'application,puisqu'ilest‚videmmentbeaucoup
plusd‚licatdedebuggerunaccessoire(plusquestiond'en"tracer"
l'ex‚cution).N'oublionspasqu'unaccessoirequiplanteplante‚galement
toutlesystŠmeetlesautresapplications!Lemieuxestdelelaisser…
l'‚tatdePRGpourlaprogrammationproprementditedecequ'ildoit
accomplir,etde"l'accessoiriser"leplustardpossible.Pourr‚aliserune
applicationfonctionnant…lafoisenaccessoireetenprogramme,inspirez-
vousdelad‚mo.Unflag(variableglobale'_app'danslecasduPureC,
€_XMODE==GEM_DAdanslecasduLatticeC)signalesil'applicationa‚t‚
lanc‚eenaccessoireouenprogramme,etunautre(variablelocaledansla
fonction`$main()`delad‚mo)rappellesil'accessoireestactifouen
attente.

SousBIG,vousaurezjuste…transmettre…`$initial()`lenum‚rodelachaŒne
libredestin‚e…devenirletitredel'accessoire,…‚crirelaboucle
d'attentedumessageAC_OPENet…traiterlemessageAC_CLOSE.

€!************************
`!L'ic“nificationdesfenˆtres

L'ic“nisationdesfenˆtresestr‚alis‚eparBIGdemaniŠrel‚gŠrement
diff‚rentequenelefontlesversionsdel'AESquisupportentdirectement
cetteop‚ration.

BIGmodifiesimplementlesattributs,l'emplacementetlatailledela
fenˆtre.L'emplacementestcalcul‚enfonctiondelapositiondelafenˆtre
avantic“nification :lafenˆtreic“nifi‚eestplac‚eaubasdubureau,au
centredel'ancienneposition...…moinsquelafenˆtreic“nifi‚enesorte
dubureau,auquelcaselleestplac‚eauborddecelui-ci.

LorsqueBIGic“nifieuneseulefenˆtre,ilplacedansl'‚l‚mentw_iconde
lastructureBigWindl'indexdecettefenˆtre(quiest…-1tantquela
fenˆtreestnormale).Ilfautdonctestercet‚l‚mentpar
`$     if (win[index].w_icon > BLANK)
pourconnaŒtrel'‚tatd'unefenˆtre.

Danslecasd'ic“nificationmultiple,lafenˆtrequia‚t‚utilis‚epourla
demanded'ic“nificationestr‚ellementic“nifi‚ecommeexpliqu‚eci-dessus,
lesautres‚tantsimplementferm‚es.L'‚l‚mentw_icondetoutesces
fenˆtrescontientl'indexBIGdelafenˆtre"maŒtresse".Ainsi,aumoment
delad‚sic“nifier,BIGpeutd‚terminersid'autresfenˆtresdoiventˆtre
r‚ouvertesenlesparcourantetencherchantcellesdontw_iconcontient
l'indexdelafenˆtredontondemandelad‚sic“nification.

Enfin,unpointdoitˆtresoulev‚.LesancienssystŠmesnepeuventouvrir
simultan‚mentqu'unnombrelimit‚defenˆtres.Imaginonslasituation
suivante,surunposten'autorisantque7fenˆtres:Ouvrons5fenˆtres,et
ic“nifions-lesenuneseule.Ouvronsensuite4autresfenˆtres,et
demandonslad‚sic“nificationdespremiŠres.Ilya2fenˆtresentrop,qui
neserontsimplementpasrestaur‚es,sansmessaged'information.
Lorsquec'estunefenˆtreavecpalettequiestic“nifi‚e,lapalettepar
d‚fautestrestaur‚e.Lapalettedelafenˆtreestrestaur‚elorsdela
d‚sic“nification,silafenˆtreseretrouveaupremierplan.

€!************************
`!Copier,Couper,Coller

Tousleschamps‚ditables(‚tendusounon,engrandsoupetitscaractŠres)
d'uneapplicationsousBIGsontreli‚sparunsystŠmedeCopier/Couper/
Coller.

Lorsqu'un‚ditableestactif(ilestdansleformulairebloquantquiest
affich‚,oudanslafenˆtredepremierplan),ilestpossibledeCopierou
Coupersoncontenurespectivementparlescombinaisonsclavier
'Control + C'et'Control + X'.Danslecasd'unecopie,letexteestcopi‚
dansunbuffer,etrienn'estchang‚danslechamplui-mˆme.S'ils'agit
d'unCouper,letexteestaussicopi‚danslebuffer,maislechampest
vid‚desoncontenu.

Pourreplaceruntextecopi‚oucoup‚dansunautrechamp,ilsuffitdes'y
placeretdetaperlacombinaison'Control+V'.Letextedubufferest
plac‚danslechamp‚ditable.Sicelui-cicontenaitd‚j…untexte,ilest
remplac‚parlenouveau.Siletexte…collerestpluslongquelataille
duchamp(lataillecomplŠtedanslecasd'unB_EDIT),lafinesttronqu‚e.
AucuneactionparticuliŠren'estn‚cessairepouractivercette
fonctionnalit‚,elleestautomatiquementactivepourunprogrammequi
utiliseBIG.

